{"version":3,"sources":["app.min.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","_interopRequireDefault","obj","__esModule","default","_utils","_utils2","lazyLoadImgs","responsifyVideos","responsifyTables","tooltipNewsletter","addFormClasses","citationsInit","./utils",2,"$","jQuery","fn","reverse","Tooltip","Utils","touchClick","$btn","fnc","on","event","stopPropagation","preventDefault","handled","$images","lazyload","effect","$videos","fitVids","checkForIE","sAgent","window","navigator","userAgent","Idx","indexOf","match","console","log","submit","this","addClass","target","document","querySelector","content","classes","position","positionCitations","$citationContent","$citationNum","topPos","each","push","offset","top","index","value","css","moveCitationsDesktop","prepend","removeClass","detach","unbind","hoverCitationNum","bind","mouseenter","$citNum","data","$element","mouseleave","moveCitationOnMobile","citNum","after","showCitationOnClick","_this","next","slideToggle","resizeFunction","innerWidth","resizeTimer","resize","clearTimeout","setTimeout","parent","tether-tooltip",3,"root","factory","define","amd","Drop","Tether","_classCallCheck","instance","Constructor","TypeError","_inherits","subClass","superClass","prototype","Object","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","sortAttach","str","_str$split","split","_str$split2","_slicedToArray","first","second","_ref","join","removeFromArray","arr","item","undefined","results","splice","createContext","options","arguments","drop","_len","args","Array","_key","_bind","apply","DropInstance","concat","extend","drops","defaults","defaultOptions","classPrefix","openOn","beforeClose","constrainToScrollParent","constrainToWindow","remove","openDelay","closeDelay","focusDelay","blurDelay","hoverOpenDelay","hoverCloseDelay","tetherOptions","allDrops","updateBodyClasses","anyOpen","len","isOpened","body","_Evented","opts","_get","getPrototypeOf","dataPrefix","contentAttr","getAttribute","attrsOverride","override","addTargetClasses","_boundEvents","bindMethods","setupElements","setupEvents","setupTether","_createClass","key","element","handler","addEventListener","transitionEndHandler","_transitionEndHandler","createElement","generateAndSetContent","contentElementOrHTML","innerHTML","appendChild","dropAttach","MIRROR_ATTACH","constraints","to","pin","attachment","targetAttachment","targetOffset","enabled","tether","_this2","open","events","openHandler","toggle","closeHandler","contains","close","clickEvents","clickEvent","_on","inTimeout","outTimeout","inHandler","type","outHandler","hasClass","_this3","parentNode","enable","trigger","currentTarget","removeEventListener","transitionEndEvent","shouldClose","isClosing","beforeCloseHandler","disable","removeChild","destroy","_boundEvents$i","_event","Evented","Function","sliceIterator","_arr","_n","_d","_e","_s","_i","Symbol","iterator","done","err","isArray","defineProperties","props","descriptor","defineProperty","protoProps","staticProps","_x2","_x3","_x4","_again","object","property","receiver","desc","getOwnPropertyDescriptor","getter","get","_Tether$Utils","documentElement","transitionEndEvents","WebkitTransition","MozTransition","OTransition","transition","_name","hasOwnProperty","tempEl","style","left","right","bottom","middle","center",4,"_Drop","tooltipCount","contentEl","setAttribute","id","initialized","init","tooltipElements","querySelectorAll","el","autoinit","tether-drop",5,"getScrollParents","computedStyle","getComputedStyle","parents","nodeType","_style","overflow","overflowX","overflowY","test","removeUtilElements","zeroElement","getBounds","doc","ownerDocument","docEl","box","rect","getBoundingClientRect","k","origin","getOrigin","width","scrollWidth","height","scrollHeight","clientTop","clientLeft","clientWidth","clientHeight","getOffsetParent","offsetParent","getScrollBarSize","inner","outer","pointerEvents","visibility","widthContained","offsetWidth","widthScroll","out","slice","forEach","name","classList","cls","trim","regex","RegExp","className","getClassName","replace","setClassName","add","SVGAnimatedString","baseVal","updateClasses","all","within","b","diff","now","performance","Date","addOffset","offsets","parseFloat","offsetToPx","size","getBoundingRect","scrollParents","pageXOffset","pageYOffset","innerHeight","pos","BOUNDS_FORMAT","side","toUpperCase","substr","TetherBase","modules","uniqueId","zeroPosCache","node","defer","deferred","flush","pop","ctx","once","bindings","_bindings$event$i","context","_x6","_x7","_x8","_TetherBase$Utils","transformKey","transforms","tethers","lastCall","lastDuration","pendingTimeout","tick","Math","min","MIRROR_LR","MIRROR_TB","OFFSET_MAP","autoToFixedAttachment","relativeToAttachment","attachmentToOffset","parseOffset","_value$split","_value$split2","parseAttachment","TetherClass","history","setOptions","initialize","_options","targetModifier","jquery","getClass","bounds","hasBottomScroll","scrollBottom","borderTopWidth","borderBottomWidth","borderLeftWidth","fitAdj","pow","max","scrollPercentage","scrollTop","_cache","_this4","_this5","elementAttach","targetAttach","_this6","sides","_addAttachClasses","_this7","flushChanges","clearCache","updateAttachClasses","elementPos","cache","lastSize","_lastSize","targetPos","getTargetBounds","targetSize","manualOffset","manualTargetOffset","_module2","ret","scrollbarSize","page","viewport","parentElement","optimizations","moveElement","offsetPosition","offsetParentStyle","offsetParentSize","offsetBorder","toLowerCase","scrollLeft","move","unshift","_this8","same","found","point","transcribe","_same","_pos","hasOptimizations","gpu","yPos","xPos","round","moved","offsetParentIsBody","currentNode","tagName","writeCSS","write","val","elVal","targetHeight","targetWidth","allClasses","constraint","outOfBoundsClass","pinnedClass","addClasses","tAttachment","eAttachment","changeAttachX","changeAttachY","_attachment$split","_attachment$split2","map","p","pinned","oob","oobClass","abutted","targetPosSide","shift","shiftTop","shiftLeft","_shift","_shift2"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _utils = require('./utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_utils2.default.lazyLoadImgs();\n_utils2.default.responsifyVideos();\n_utils2.default.responsifyTables();\n_utils2.default.tooltipNewsletter();\n_utils2.default.addFormClasses();\n\n_utils2.default.citationsInit();\n\n},{\"./utils\":2}],2:[function(require,module,exports){\n'use strict';\n\n(function ($) {\n\n  jQuery.fn.reverse = [].reverse;\n\n  var Tooltip = require('tether-tooltip');\n\n  var Utils = function () {\n\n    var $images = $('.is-lazy'),\n        $videos = $('.content-video').parent(),\n        $tables = $('table'),\n        $body = $('body'),\n        $content = $('.entry-content');\n\n    function touchClick($btn, fnc) {\n\n      $btn.on(\"click touchstart\", function (event) {\n\n        event.stopPropagation();\n        event.preventDefault();\n\n        if (event.handled !== true) {\n          fnc(event);\n          event.handled = true;\n        } else {\n          return false;\n        }\n      });\n    }\n\n    function lazyLoadImgs() {\n      $images.lazyload({\n        effect: \"fadeIn\"\n      });\n    };\n\n    function responsifyTables() {\n      // $tables.basictable({\n      //   breakpoint: 700\n      // });\n    };\n\n    function responsifyVideos() {\n      $videos.fitVids();\n    };\n\n    function checkForIE() {\n\n      var sAgent = window.navigator.userAgent;\n      var Idx = sAgent.indexOf(\"MSIE\");\n\n      // If IE, return version number.\n      if (Idx > 0) {\n        // return parseInt(sAgent.substring(Idx+ 5, sAgent.indexOf(\".\", Idx)));\n        return true;\n      } else if (!!navigator.userAgent.match(/Trident\\/7\\./)) {\n        return true;\n      } else {\n        //It is not IE\n        return false;\n      }\n    };\n\n    function addFormClasses() {\n      console.log('inside');\n      $('#chimpy_shortcode_1').submit(function (event) {\n        console.log('ready');\n        $(this).addClass('is-submitting');\n      });\n    };\n\n    function tooltipNewsletter() {\n      new Tooltip({\n        target: document.querySelector('.tooltip-newsletter'),\n        content: \"I will never send you spam or sell your email address to any third-party\",\n        classes: 'tooltip-tether-arrows',\n        position: 'top left'\n      });\n    };\n\n    function positionCitations() {\n      console.log('hereeeeee');\n      var $citationContent = $('.citation');\n      var $citationNum = $('.citation-num');\n      var topPos = [];\n\n      $citationNum.each(function () {\n        topPos.push($(this).offset().top);\n      });\n\n      console.log('topPos: ', topPos);\n\n      $citationContent.each(function (index, value) {\n        $(this).css('top', topPos[index]);\n        $(this).addClass('animated fadeIn is-visible');\n      });\n    };\n\n    function moveCitationsDesktop() {\n\n      var $citationContent = $('.citation');\n\n      $citationContent.reverse().each(function () {\n        $('.entry-content').prepend($(this).removeClass('citation-mobile').detach().addClass('is-visible'));\n      });\n\n      $('.citation-num.citation-num-mobile').unbind('click');\n      $('.citation-num').removeClass('citation-num-mobile');\n\n      hoverCitationNum();\n      positionCitations();\n    }\n\n    function hoverCitationNum() {\n      var $citationContent = $('.citation');\n      var $citationNum = $('.citation-num');\n\n      $('.citation-num:not(.citation-num-mobile)').bind({\n        mouseenter: function mouseenter(e) {\n          console.log('in');\n          var $citNum = $(this).data('citation-num');\n          var $element = $('.citation[data-citation=' + $citNum + ']');\n\n          $element.removeClass('fadeInDown').removeClass('fadeIn').addClass('wobble');\n          // console.log(\"$element: \", $element);\n        },\n        mouseleave: function mouseleave(e) {\n          var $citNum = $(this).data('citation-num');\n          var $element = $('.citation[data-citation=' + $citNum + ']');\n\n          $element.removeClass('wobble');\n          console.log('out');\n        }\n      });\n    };\n\n    function moveCitationOnMobile() {\n\n      $('.citation').each(function () {\n        var citNum = $(this).data('citation');\n        var $citNum = $('.citation-num[data-citation-num=' + citNum + ']');\n\n        $citNum.unbind('mouseenter mouseleave').addClass('citation-num-mobile').after($(this).addClass('citation-mobile').removeClass('is-visible wobble').detach());\n      });\n    };\n\n    function showCitationOnClick() {\n      $('.citation-num.citation-num-mobile').each(function () {\n        var _this = this;\n\n        touchClick($(this), function () {\n          $(_this).next().addClass('fadeIn').slideToggle(200);\n        });\n      });\n    }\n\n    function citationsInit() {\n      var resizeTimer;\n\n      function resizeFunction() {\n        if (window.innerWidth < 1300) {\n          console.log('below 1300');\n          moveCitationOnMobile();\n          showCitationOnClick();\n        } else {\n          console.log('above 1300');\n          moveCitationsDesktop();\n        }\n      };\n\n      // On resize, run the function and reset the timeout\n      // 250 is the delay in milliseconds. Change as you see fit.\n      $(window).resize(function () {\n        clearTimeout(resizeTimer);\n        resizeTimer = setTimeout(resizeFunction, 500);\n      });\n\n      resizeFunction();\n    }\n\n    return {\n      lazyLoadImgs: lazyLoadImgs,\n      responsifyVideos: responsifyVideos,\n      responsifyTables: responsifyTables,\n      checkForIE: checkForIE,\n      addFormClasses: addFormClasses,\n      tooltipNewsletter: tooltipNewsletter,\n      positionCitations: positionCitations,\n      hoverCitationNum: hoverCitationNum,\n      moveCitationOnMobile: moveCitationOnMobile,\n      showCitationOnClick: showCitationOnClick,\n      citationsInit: citationsInit\n    };\n  }();\n\n  /* Exposing our functions to the rest of the application */\n  module.exports = Utils;\n})(jQuery);\n\n},{\"tether-tooltip\":4}],3:[function(require,module,exports){\n/*! tether-drop 1.4.1 */\n\n(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([\"tether\"], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory(require('tether'));\n  } else {\n    root.Drop = factory(root.Tether);\n  }\n}(this, function(Tether) {\n\n/* global Tether */\n'use strict';\n\nvar _bind = Function.prototype.bind;\n\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _get = function get(_x2, _x3, _x4) { var _again = true; _function: while (_again) { var object = _x2, property = _x3, receiver = _x4; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x2 = parent; _x3 = property; _x4 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _Tether$Utils = Tether.Utils;\nvar extend = _Tether$Utils.extend;\nvar addClass = _Tether$Utils.addClass;\nvar removeClass = _Tether$Utils.removeClass;\nvar hasClass = _Tether$Utils.hasClass;\nvar Evented = _Tether$Utils.Evented;\n\nfunction sortAttach(str) {\n  var _str$split = str.split(' ');\n\n  var _str$split2 = _slicedToArray(_str$split, 2);\n\n  var first = _str$split2[0];\n  var second = _str$split2[1];\n\n  if (['left', 'right'].indexOf(first) >= 0) {\n    var _ref = [second, first];\n    first = _ref[0];\n    second = _ref[1];\n  }\n  return [first, second].join(' ');\n}\n\nfunction removeFromArray(arr, item) {\n  var index = undefined;\n  var results = [];\n  while ((index = arr.indexOf(item)) !== -1) {\n    results.push(arr.splice(index, 1));\n  }\n  return results;\n}\n\nvar clickEvents = ['click'];\nif ('ontouchstart' in document.documentElement) {\n  clickEvents.push('touchstart');\n}\n\nvar transitionEndEvents = {\n  'WebkitTransition': 'webkitTransitionEnd',\n  'MozTransition': 'transitionend',\n  'OTransition': 'otransitionend',\n  'transition': 'transitionend'\n};\n\nvar transitionEndEvent = '';\nfor (var _name in transitionEndEvents) {\n  if (({}).hasOwnProperty.call(transitionEndEvents, _name)) {\n    var tempEl = document.createElement('p');\n    if (typeof tempEl.style[_name] !== 'undefined') {\n      transitionEndEvent = transitionEndEvents[_name];\n    }\n  }\n}\n\nvar MIRROR_ATTACH = {\n  left: 'right',\n  right: 'left',\n  top: 'bottom',\n  bottom: 'top',\n  middle: 'middle',\n  center: 'center'\n};\n\nvar allDrops = {};\n\n// Drop can be included in external libraries.  Calling createContext gives you a fresh\n// copy of drop which won't interact with other copies on the page (beyond calling the document events).\n\nfunction createContext() {\n  var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n  var drop = function drop() {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return new (_bind.apply(DropInstance, [null].concat(args)))();\n  };\n\n  extend(drop, {\n    createContext: createContext,\n    drops: [],\n    defaults: {}\n  });\n\n  var defaultOptions = {\n    classPrefix: 'drop',\n    defaults: {\n      position: 'bottom left',\n      openOn: 'click',\n      beforeClose: null,\n      constrainToScrollParent: true,\n      constrainToWindow: true,\n      classes: '',\n      remove: false,\n      openDelay: 0,\n      closeDelay: 50,\n      // inherited from openDelay and closeDelay if not explicitly defined\n      focusDelay: null,\n      blurDelay: null,\n      hoverOpenDelay: null,\n      hoverCloseDelay: null,\n      tetherOptions: {}\n    }\n  };\n\n  extend(drop, defaultOptions, options);\n  extend(drop.defaults, defaultOptions.defaults, options.defaults);\n\n  if (typeof allDrops[drop.classPrefix] === 'undefined') {\n    allDrops[drop.classPrefix] = [];\n  }\n\n  drop.updateBodyClasses = function () {\n    // There is only one body, so despite the context concept, we still iterate through all\n    // drops which share our classPrefix.\n\n    var anyOpen = false;\n    var drops = allDrops[drop.classPrefix];\n    var len = drops.length;\n    for (var i = 0; i < len; ++i) {\n      if (drops[i].isOpened()) {\n        anyOpen = true;\n        break;\n      }\n    }\n\n    if (anyOpen) {\n      addClass(document.body, drop.classPrefix + '-open');\n    } else {\n      removeClass(document.body, drop.classPrefix + '-open');\n    }\n  };\n\n  var DropInstance = (function (_Evented) {\n    _inherits(DropInstance, _Evented);\n\n    function DropInstance(opts) {\n      _classCallCheck(this, DropInstance);\n\n      _get(Object.getPrototypeOf(DropInstance.prototype), 'constructor', this).call(this);\n      this.options = extend({}, drop.defaults, opts);\n      this.target = this.options.target;\n\n      if (typeof this.target === 'undefined') {\n        throw new Error('Drop Error: You must provide a target.');\n      }\n\n      var dataPrefix = 'data-' + drop.classPrefix;\n\n      var contentAttr = this.target.getAttribute(dataPrefix);\n      if (contentAttr && this.options.content == null) {\n        this.options.content = contentAttr;\n      }\n\n      var attrsOverride = ['position', 'openOn'];\n      for (var i = 0; i < attrsOverride.length; ++i) {\n\n        var override = this.target.getAttribute(dataPrefix + '-' + attrsOverride[i]);\n        if (override && this.options[attrsOverride[i]] == null) {\n          this.options[attrsOverride[i]] = override;\n        }\n      }\n\n      if (this.options.classes && this.options.addTargetClasses !== false) {\n        addClass(this.target, this.options.classes);\n      }\n\n      drop.drops.push(this);\n      allDrops[drop.classPrefix].push(this);\n\n      this._boundEvents = [];\n      this.bindMethods();\n      this.setupElements();\n      this.setupEvents();\n      this.setupTether();\n    }\n\n    _createClass(DropInstance, [{\n      key: '_on',\n      value: function _on(element, event, handler) {\n        this._boundEvents.push({ element: element, event: event, handler: handler });\n        element.addEventListener(event, handler);\n      }\n    }, {\n      key: 'bindMethods',\n      value: function bindMethods() {\n        this.transitionEndHandler = this._transitionEndHandler.bind(this);\n      }\n    }, {\n      key: 'setupElements',\n      value: function setupElements() {\n        var _this = this;\n\n        this.drop = document.createElement('div');\n        addClass(this.drop, drop.classPrefix);\n\n        if (this.options.classes) {\n          addClass(this.drop, this.options.classes);\n        }\n\n        this.content = document.createElement('div');\n        addClass(this.content, drop.classPrefix + '-content');\n\n        if (typeof this.options.content === 'function') {\n          var generateAndSetContent = function generateAndSetContent() {\n            // content function might return a string or an element\n            var contentElementOrHTML = _this.options.content.call(_this, _this);\n\n            if (typeof contentElementOrHTML === 'string') {\n              _this.content.innerHTML = contentElementOrHTML;\n            } else if (typeof contentElementOrHTML === 'object') {\n              _this.content.innerHTML = '';\n              _this.content.appendChild(contentElementOrHTML);\n            } else {\n              throw new Error('Drop Error: Content function should return a string or HTMLElement.');\n            }\n          };\n\n          generateAndSetContent();\n          this.on('open', generateAndSetContent.bind(this));\n        } else if (typeof this.options.content === 'object') {\n          this.content.appendChild(this.options.content);\n        } else {\n          this.content.innerHTML = this.options.content;\n        }\n\n        this.drop.appendChild(this.content);\n      }\n    }, {\n      key: 'setupTether',\n      value: function setupTether() {\n        // Tether expects two attachment points, one in the target element, one in the\n        // drop.  We use a single one, and use the order as well, to allow us to put\n        // the drop on either side of any of the four corners.  This magic converts between\n        // the two:\n        var dropAttach = this.options.position.split(' ');\n        dropAttach[0] = MIRROR_ATTACH[dropAttach[0]];\n        dropAttach = dropAttach.join(' ');\n\n        var constraints = [];\n        if (this.options.constrainToScrollParent) {\n          constraints.push({\n            to: 'scrollParent',\n            pin: 'top, bottom',\n            attachment: 'together none'\n          });\n        } else {\n          // To get 'out of bounds' classes\n          constraints.push({\n            to: 'scrollParent'\n          });\n        }\n\n        if (this.options.constrainToWindow !== false) {\n          constraints.push({\n            to: 'window',\n            attachment: 'together'\n          });\n        } else {\n          // To get 'out of bounds' classes\n          constraints.push({\n            to: 'window'\n          });\n        }\n\n        var opts = {\n          element: this.drop,\n          target: this.target,\n          attachment: sortAttach(dropAttach),\n          targetAttachment: sortAttach(this.options.position),\n          classPrefix: drop.classPrefix,\n          offset: '0 0',\n          targetOffset: '0 0',\n          enabled: false,\n          constraints: constraints,\n          addTargetClasses: this.options.addTargetClasses\n        };\n\n        if (this.options.tetherOptions !== false) {\n          this.tether = new Tether(extend({}, opts, this.options.tetherOptions));\n        }\n      }\n    }, {\n      key: 'setupEvents',\n      value: function setupEvents() {\n        var _this2 = this;\n\n        if (!this.options.openOn) {\n          return;\n        }\n\n        if (this.options.openOn === 'always') {\n          setTimeout(this.open.bind(this));\n          return;\n        }\n\n        var events = this.options.openOn.split(' ');\n\n        if (events.indexOf('click') >= 0) {\n          var openHandler = function openHandler(event) {\n            _this2.toggle(event);\n            event.preventDefault();\n          };\n\n          var closeHandler = function closeHandler(event) {\n            if (!_this2.isOpened()) {\n              return;\n            }\n\n            // Clicking inside dropdown\n            if (event.target === _this2.drop || _this2.drop.contains(event.target)) {\n              return;\n            }\n\n            // Clicking target\n            if (event.target === _this2.target || _this2.target.contains(event.target)) {\n              return;\n            }\n\n            _this2.close(event);\n          };\n\n          for (var i = 0; i < clickEvents.length; ++i) {\n            var clickEvent = clickEvents[i];\n            this._on(this.target, clickEvent, openHandler);\n            this._on(document, clickEvent, closeHandler);\n          }\n        }\n\n        var inTimeout = null;\n        var outTimeout = null;\n\n        var inHandler = function inHandler(event) {\n          if (outTimeout !== null) {\n            clearTimeout(outTimeout);\n          } else {\n            inTimeout = setTimeout(function () {\n              _this2.open(event);\n              inTimeout = null;\n            }, (event.type === 'focus' ? _this2.options.focusDelay : _this2.options.hoverOpenDelay) || _this2.options.openDelay);\n          }\n        };\n\n        var outHandler = function outHandler(event) {\n          if (inTimeout !== null) {\n            clearTimeout(inTimeout);\n          } else {\n            outTimeout = setTimeout(function () {\n              _this2.close(event);\n              outTimeout = null;\n            }, (event.type === 'blur' ? _this2.options.blurDelay : _this2.options.hoverCloseDelay) || _this2.options.closeDelay);\n          }\n        };\n\n        if (events.indexOf('hover') >= 0) {\n          this._on(this.target, 'mouseover', inHandler);\n          this._on(this.drop, 'mouseover', inHandler);\n          this._on(this.target, 'mouseout', outHandler);\n          this._on(this.drop, 'mouseout', outHandler);\n        }\n\n        if (events.indexOf('focus') >= 0) {\n          this._on(this.target, 'focus', inHandler);\n          this._on(this.drop, 'focus', inHandler);\n          this._on(this.target, 'blur', outHandler);\n          this._on(this.drop, 'blur', outHandler);\n        }\n      }\n    }, {\n      key: 'isOpened',\n      value: function isOpened() {\n        if (this.drop) {\n          return hasClass(this.drop, drop.classPrefix + '-open');\n        }\n      }\n    }, {\n      key: 'toggle',\n      value: function toggle(event) {\n        if (this.isOpened()) {\n          this.close(event);\n        } else {\n          this.open(event);\n        }\n      }\n    }, {\n      key: 'open',\n      value: function open(event) {\n        var _this3 = this;\n\n        /* eslint no-unused-vars: 0 */\n        if (this.isOpened()) {\n          return;\n        }\n\n        if (!this.drop.parentNode) {\n          document.body.appendChild(this.drop);\n        }\n\n        if (typeof this.tether !== 'undefined') {\n          this.tether.enable();\n        }\n\n        addClass(this.drop, drop.classPrefix + '-open');\n        addClass(this.drop, drop.classPrefix + '-open-transitionend');\n\n        setTimeout(function () {\n          if (_this3.drop) {\n            addClass(_this3.drop, drop.classPrefix + '-after-open');\n          }\n        });\n\n        if (typeof this.tether !== 'undefined') {\n          this.tether.position();\n        }\n\n        this.trigger('open');\n\n        drop.updateBodyClasses();\n      }\n    }, {\n      key: '_transitionEndHandler',\n      value: function _transitionEndHandler(e) {\n        if (e.target !== e.currentTarget) {\n          return;\n        }\n\n        if (!hasClass(this.drop, drop.classPrefix + '-open')) {\n          removeClass(this.drop, drop.classPrefix + '-open-transitionend');\n        }\n        this.drop.removeEventListener(transitionEndEvent, this.transitionEndHandler);\n      }\n    }, {\n      key: 'beforeCloseHandler',\n      value: function beforeCloseHandler(event) {\n        var shouldClose = true;\n\n        if (!this.isClosing && typeof this.options.beforeClose === 'function') {\n          this.isClosing = true;\n          shouldClose = this.options.beforeClose(event, this) !== false;\n        }\n\n        this.isClosing = false;\n\n        return shouldClose;\n      }\n    }, {\n      key: 'close',\n      value: function close(event) {\n        if (!this.isOpened()) {\n          return;\n        }\n\n        if (!this.beforeCloseHandler(event)) {\n          return;\n        }\n\n        removeClass(this.drop, drop.classPrefix + '-open');\n        removeClass(this.drop, drop.classPrefix + '-after-open');\n\n        this.drop.addEventListener(transitionEndEvent, this.transitionEndHandler);\n\n        this.trigger('close');\n\n        if (typeof this.tether !== 'undefined') {\n          this.tether.disable();\n        }\n\n        drop.updateBodyClasses();\n\n        if (this.options.remove) {\n          this.remove(event);\n        }\n      }\n    }, {\n      key: 'remove',\n      value: function remove(event) {\n        this.close(event);\n        if (this.drop.parentNode) {\n          this.drop.parentNode.removeChild(this.drop);\n        }\n      }\n    }, {\n      key: 'position',\n      value: function position() {\n        if (this.isOpened() && typeof this.tether !== 'undefined') {\n          this.tether.position();\n        }\n      }\n    }, {\n      key: 'destroy',\n      value: function destroy() {\n        this.remove();\n\n        if (typeof this.tether !== 'undefined') {\n          this.tether.destroy();\n        }\n\n        for (var i = 0; i < this._boundEvents.length; ++i) {\n          var _boundEvents$i = this._boundEvents[i];\n          var element = _boundEvents$i.element;\n          var _event = _boundEvents$i.event;\n          var handler = _boundEvents$i.handler;\n\n          element.removeEventListener(_event, handler);\n        }\n\n        this._boundEvents = [];\n\n        this.tether = null;\n        this.drop = null;\n        this.content = null;\n        this.target = null;\n\n        removeFromArray(allDrops[drop.classPrefix], this);\n        removeFromArray(drop.drops, this);\n      }\n    }]);\n\n    return DropInstance;\n  })(Evented);\n\n  return drop;\n}\n\nvar Drop = createContext();\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  Drop.updateBodyClasses();\n});\nreturn Drop;\n\n}));\n\n},{\"tether\":5}],4:[function(require,module,exports){\n/*! tether-tooltip 1.1.0 */\n\n(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([\"tether-drop\",\"tether\"], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory(require('tether-drop'), require('tether'));\n  } else {\n    root.Tooltip = factory(root.Drop, root.Tether);\n  }\n}(this, function(Drop, Tether) {\n\n/* global Tether Drop */\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar extend = Tether.Utils.extend;\n\nvar _Drop = Drop.createContext({\n  classPrefix: 'tooltip'\n});\n\nvar defaults = {\n  position: 'top center',\n  openOn: 'hover',\n  classes: 'tooltip-theme-arrows',\n  constrainToWindow: true,\n  constrainToScrollParent: false\n};\n\nvar tooltipCount = 0;\n\nvar Tooltip = (function () {\n  function Tooltip(options) {\n    _classCallCheck(this, Tooltip);\n\n    this.options = options;\n\n    if (!this.options.target) {\n      throw new Error('Tooltip Error: You must provide a target for Tooltip to attach to');\n    }\n\n    var position = this.options.target.getAttribute('data-tooltip-position');\n    if (position) {\n      if (typeof this.options.position === 'undefined') {\n        this.options.position = position;\n      }\n    }\n\n    var content = this.options.target.getAttribute('data-tooltip');\n\n    if (content) {\n      if (typeof this.options.content === 'undefined') {\n        var contentEl = document.createElement('div');\n        contentEl.innerHTML = content;\n\n        // Add ARIA attributes (see #50)\n        contentEl.setAttribute('role', 'tooltip');\n        contentEl.id = 'drop-tooltip-' + tooltipCount;\n        this.options.target.setAttribute('aria-describedby', contentEl.id);\n        tooltipCount += 1;\n\n        this.options.content = contentEl;\n      }\n    }\n\n    if (!this.options.content) {\n      throw new Error('Tooltip Error: You must provide content for Tooltip to display');\n    }\n\n    this.options = extend({}, defaults, this.options);\n\n    this.drop = new _Drop(this.options);\n  }\n\n  _createClass(Tooltip, [{\n    key: 'close',\n    value: function close() {\n      this.drop.close();\n    }\n  }, {\n    key: 'open',\n    value: function open() {\n      this.drop.open();\n    }\n  }, {\n    key: 'toggle',\n    value: function toggle() {\n      this.drop.toggle();\n    }\n  }, {\n    key: 'remove',\n    value: function remove() {\n      this.drop.remove();\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this.drop.destroy();\n    }\n  }, {\n    key: 'position',\n    value: function position() {\n      this.drop.position();\n    }\n  }]);\n\n  return Tooltip;\n})();\n\nvar initialized = [];\n\nTooltip.init = function () {\n  var tooltipElements = document.querySelectorAll('[data-tooltip]');\n  var len = tooltipElements.length;\n  for (var i = 0; i < len; ++i) {\n    var el = tooltipElements[i];\n    if (initialized.indexOf(el) === -1) {\n      new Tooltip({\n        target: el\n      });\n      initialized.push(el);\n    }\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  if (Tooltip.autoinit !== false) {\n    Tooltip.init();\n  }\n});\nreturn Tooltip;\n\n}));\n\n},{\"tether\":5,\"tether-drop\":3}],5:[function(require,module,exports){\n/*! tether 1.3.1 */\n\n(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory(require, exports, module);\n  } else {\n    root.Tether = factory();\n  }\n}(this, function(require, exports, module) {\n\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar TetherBase = undefined;\nif (typeof TetherBase === 'undefined') {\n  TetherBase = { modules: [] };\n}\n\nvar zeroElement = null;\n\nfunction getScrollParents(el) {\n  // In firefox if the el is inside an iframe with display: none; window.getComputedStyle() will return null;\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n  var computedStyle = getComputedStyle(el) || {};\n  var position = computedStyle.position;\n  var parents = [];\n\n  if (position === 'fixed') {\n    return [el];\n  }\n\n  var parent = el;\n  while ((parent = parent.parentNode) && parent && parent.nodeType === 1) {\n    var style = undefined;\n    try {\n      style = getComputedStyle(parent);\n    } catch (err) {}\n\n    if (typeof style === 'undefined' || style === null) {\n      parents.push(parent);\n      return parents;\n    }\n\n    var _style = style;\n    var overflow = _style.overflow;\n    var overflowX = _style.overflowX;\n    var overflowY = _style.overflowY;\n\n    if (/(auto|scroll)/.test(overflow + overflowY + overflowX)) {\n      if (position !== 'absolute' || ['relative', 'absolute', 'fixed'].indexOf(style.position) >= 0) {\n        parents.push(parent);\n      }\n    }\n  }\n\n  parents.push(document.body);\n  return parents;\n}\n\nvar uniqueId = (function () {\n  var id = 0;\n  return function () {\n    return ++id;\n  };\n})();\n\nvar zeroPosCache = {};\nvar getOrigin = function getOrigin() {\n  // getBoundingClientRect is unfortunately too accurate.  It introduces a pixel or two of\n  // jitter as the user scrolls that messes with our ability to detect if two positions\n  // are equivilant or not.  We place an element at the top left of the page that will\n  // get the same jitter, so we can cancel the two out.\n  var node = zeroElement;\n  if (!node) {\n    node = document.createElement('div');\n    node.setAttribute('data-tether-id', uniqueId());\n    extend(node.style, {\n      top: 0,\n      left: 0,\n      position: 'absolute'\n    });\n\n    document.body.appendChild(node);\n\n    zeroElement = node;\n  }\n\n  var id = node.getAttribute('data-tether-id');\n  if (typeof zeroPosCache[id] === 'undefined') {\n    zeroPosCache[id] = {};\n\n    var rect = node.getBoundingClientRect();\n    for (var k in rect) {\n      // Can't use extend, as on IE9, elements don't resolve to be hasOwnProperty\n      zeroPosCache[id][k] = rect[k];\n    }\n\n    // Clear the cache when this position call is done\n    defer(function () {\n      delete zeroPosCache[id];\n    });\n  }\n\n  return zeroPosCache[id];\n};\n\nfunction removeUtilElements() {\n  if (zeroElement) {\n    document.body.removeChild(zeroElement);\n  }\n  zeroElement = null;\n};\n\nfunction getBounds(el) {\n  var doc = undefined;\n  if (el === document) {\n    doc = document;\n    el = document.documentElement;\n  } else {\n    doc = el.ownerDocument;\n  }\n\n  var docEl = doc.documentElement;\n\n  var box = {};\n  // The original object returned by getBoundingClientRect is immutable, so we clone it\n  // We can't use extend because the properties are not considered part of the object by hasOwnProperty in IE9\n  var rect = el.getBoundingClientRect();\n  for (var k in rect) {\n    box[k] = rect[k];\n  }\n\n  var origin = getOrigin();\n\n  box.top -= origin.top;\n  box.left -= origin.left;\n\n  if (typeof box.width === 'undefined') {\n    box.width = document.body.scrollWidth - box.left - box.right;\n  }\n  if (typeof box.height === 'undefined') {\n    box.height = document.body.scrollHeight - box.top - box.bottom;\n  }\n\n  box.top = box.top - docEl.clientTop;\n  box.left = box.left - docEl.clientLeft;\n  box.right = doc.body.clientWidth - box.width - box.left;\n  box.bottom = doc.body.clientHeight - box.height - box.top;\n\n  return box;\n}\n\nfunction getOffsetParent(el) {\n  return el.offsetParent || document.documentElement;\n}\n\nfunction getScrollBarSize() {\n  var inner = document.createElement('div');\n  inner.style.width = '100%';\n  inner.style.height = '200px';\n\n  var outer = document.createElement('div');\n  extend(outer.style, {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    pointerEvents: 'none',\n    visibility: 'hidden',\n    width: '200px',\n    height: '150px',\n    overflow: 'hidden'\n  });\n\n  outer.appendChild(inner);\n\n  document.body.appendChild(outer);\n\n  var widthContained = inner.offsetWidth;\n  outer.style.overflow = 'scroll';\n  var widthScroll = inner.offsetWidth;\n\n  if (widthContained === widthScroll) {\n    widthScroll = outer.clientWidth;\n  }\n\n  document.body.removeChild(outer);\n\n  var width = widthContained - widthScroll;\n\n  return { width: width, height: width };\n}\n\nfunction extend() {\n  var out = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n  var args = [];\n\n  Array.prototype.push.apply(args, arguments);\n\n  args.slice(1).forEach(function (obj) {\n    if (obj) {\n      for (var key in obj) {\n        if (({}).hasOwnProperty.call(obj, key)) {\n          out[key] = obj[key];\n        }\n      }\n    }\n  });\n\n  return out;\n}\n\nfunction removeClass(el, name) {\n  if (typeof el.classList !== 'undefined') {\n    name.split(' ').forEach(function (cls) {\n      if (cls.trim()) {\n        el.classList.remove(cls);\n      }\n    });\n  } else {\n    var regex = new RegExp('(^| )' + name.split(' ').join('|') + '( |$)', 'gi');\n    var className = getClassName(el).replace(regex, ' ');\n    setClassName(el, className);\n  }\n}\n\nfunction addClass(el, name) {\n  if (typeof el.classList !== 'undefined') {\n    name.split(' ').forEach(function (cls) {\n      if (cls.trim()) {\n        el.classList.add(cls);\n      }\n    });\n  } else {\n    removeClass(el, name);\n    var cls = getClassName(el) + (' ' + name);\n    setClassName(el, cls);\n  }\n}\n\nfunction hasClass(el, name) {\n  if (typeof el.classList !== 'undefined') {\n    return el.classList.contains(name);\n  }\n  var className = getClassName(el);\n  return new RegExp('(^| )' + name + '( |$)', 'gi').test(className);\n}\n\nfunction getClassName(el) {\n  if (el.className instanceof SVGAnimatedString) {\n    return el.className.baseVal;\n  }\n  return el.className;\n}\n\nfunction setClassName(el, className) {\n  el.setAttribute('class', className);\n}\n\nfunction updateClasses(el, add, all) {\n  // Of the set of 'all' classes, we need the 'add' classes, and only the\n  // 'add' classes to be set.\n  all.forEach(function (cls) {\n    if (add.indexOf(cls) === -1 && hasClass(el, cls)) {\n      removeClass(el, cls);\n    }\n  });\n\n  add.forEach(function (cls) {\n    if (!hasClass(el, cls)) {\n      addClass(el, cls);\n    }\n  });\n}\n\nvar deferred = [];\n\nvar defer = function defer(fn) {\n  deferred.push(fn);\n};\n\nvar flush = function flush() {\n  var fn = undefined;\n  while (fn = deferred.pop()) {\n    fn();\n  }\n};\n\nvar Evented = (function () {\n  function Evented() {\n    _classCallCheck(this, Evented);\n  }\n\n  _createClass(Evented, [{\n    key: 'on',\n    value: function on(event, handler, ctx) {\n      var once = arguments.length <= 3 || arguments[3] === undefined ? false : arguments[3];\n\n      if (typeof this.bindings === 'undefined') {\n        this.bindings = {};\n      }\n      if (typeof this.bindings[event] === 'undefined') {\n        this.bindings[event] = [];\n      }\n      this.bindings[event].push({ handler: handler, ctx: ctx, once: once });\n    }\n  }, {\n    key: 'once',\n    value: function once(event, handler, ctx) {\n      this.on(event, handler, ctx, true);\n    }\n  }, {\n    key: 'off',\n    value: function off(event, handler) {\n      if (typeof this.bindings !== 'undefined' && typeof this.bindings[event] !== 'undefined') {\n        return;\n      }\n\n      if (typeof handler === 'undefined') {\n        delete this.bindings[event];\n      } else {\n        var i = 0;\n        while (i < this.bindings[event].length) {\n          if (this.bindings[event][i].handler === handler) {\n            this.bindings[event].splice(i, 1);\n          } else {\n            ++i;\n          }\n        }\n      }\n    }\n  }, {\n    key: 'trigger',\n    value: function trigger(event) {\n      if (typeof this.bindings !== 'undefined' && this.bindings[event]) {\n        var i = 0;\n\n        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        while (i < this.bindings[event].length) {\n          var _bindings$event$i = this.bindings[event][i];\n          var handler = _bindings$event$i.handler;\n          var ctx = _bindings$event$i.ctx;\n          var once = _bindings$event$i.once;\n\n          var context = ctx;\n          if (typeof context === 'undefined') {\n            context = this;\n          }\n\n          handler.apply(context, args);\n\n          if (once) {\n            this.bindings[event].splice(i, 1);\n          } else {\n            ++i;\n          }\n        }\n      }\n    }\n  }]);\n\n  return Evented;\n})();\n\nTetherBase.Utils = {\n  getScrollParents: getScrollParents,\n  getBounds: getBounds,\n  getOffsetParent: getOffsetParent,\n  extend: extend,\n  addClass: addClass,\n  removeClass: removeClass,\n  hasClass: hasClass,\n  updateClasses: updateClasses,\n  defer: defer,\n  flush: flush,\n  uniqueId: uniqueId,\n  Evented: Evented,\n  getScrollBarSize: getScrollBarSize,\n  removeUtilElements: removeUtilElements\n};\n/* globals TetherBase, performance */\n\n'use strict';\n\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _get = function get(_x6, _x7, _x8) { var _again = true; _function: while (_again) { var object = _x6, property = _x7, receiver = _x8; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x6 = parent; _x7 = property; _x8 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nif (typeof TetherBase === 'undefined') {\n  throw new Error('You must include the utils.js file before tether.js');\n}\n\nvar _TetherBase$Utils = TetherBase.Utils;\nvar getScrollParents = _TetherBase$Utils.getScrollParents;\nvar getBounds = _TetherBase$Utils.getBounds;\nvar getOffsetParent = _TetherBase$Utils.getOffsetParent;\nvar extend = _TetherBase$Utils.extend;\nvar addClass = _TetherBase$Utils.addClass;\nvar removeClass = _TetherBase$Utils.removeClass;\nvar updateClasses = _TetherBase$Utils.updateClasses;\nvar defer = _TetherBase$Utils.defer;\nvar flush = _TetherBase$Utils.flush;\nvar getScrollBarSize = _TetherBase$Utils.getScrollBarSize;\nvar removeUtilElements = _TetherBase$Utils.removeUtilElements;\n\nfunction within(a, b) {\n  var diff = arguments.length <= 2 || arguments[2] === undefined ? 1 : arguments[2];\n\n  return a + diff >= b && b >= a - diff;\n}\n\nvar transformKey = (function () {\n  if (typeof document === 'undefined') {\n    return '';\n  }\n  var el = document.createElement('div');\n\n  var transforms = ['transform', 'webkitTransform', 'OTransform', 'MozTransform', 'msTransform'];\n  for (var i = 0; i < transforms.length; ++i) {\n    var key = transforms[i];\n    if (el.style[key] !== undefined) {\n      return key;\n    }\n  }\n})();\n\nvar tethers = [];\n\nvar position = function position() {\n  tethers.forEach(function (tether) {\n    tether.position(false);\n  });\n  flush();\n};\n\nfunction now() {\n  if (typeof performance !== 'undefined' && typeof performance.now !== 'undefined') {\n    return performance.now();\n  }\n  return +new Date();\n}\n\n(function () {\n  var lastCall = null;\n  var lastDuration = null;\n  var pendingTimeout = null;\n\n  var tick = function tick() {\n    if (typeof lastDuration !== 'undefined' && lastDuration > 16) {\n      // We voluntarily throttle ourselves if we can't manage 60fps\n      lastDuration = Math.min(lastDuration - 16, 250);\n\n      // Just in case this is the last event, remember to position just once more\n      pendingTimeout = setTimeout(tick, 250);\n      return;\n    }\n\n    if (typeof lastCall !== 'undefined' && now() - lastCall < 10) {\n      // Some browsers call events a little too frequently, refuse to run more than is reasonable\n      return;\n    }\n\n    if (pendingTimeout != null) {\n      clearTimeout(pendingTimeout);\n      pendingTimeout = null;\n    }\n\n    lastCall = now();\n    position();\n    lastDuration = now() - lastCall;\n  };\n\n  if (typeof window !== 'undefined' && typeof window.addEventListener !== 'undefined') {\n    ['resize', 'scroll', 'touchmove'].forEach(function (event) {\n      window.addEventListener(event, tick);\n    });\n  }\n})();\n\nvar MIRROR_LR = {\n  center: 'center',\n  left: 'right',\n  right: 'left'\n};\n\nvar MIRROR_TB = {\n  middle: 'middle',\n  top: 'bottom',\n  bottom: 'top'\n};\n\nvar OFFSET_MAP = {\n  top: 0,\n  left: 0,\n  middle: '50%',\n  center: '50%',\n  bottom: '100%',\n  right: '100%'\n};\n\nvar autoToFixedAttachment = function autoToFixedAttachment(attachment, relativeToAttachment) {\n  var left = attachment.left;\n  var top = attachment.top;\n\n  if (left === 'auto') {\n    left = MIRROR_LR[relativeToAttachment.left];\n  }\n\n  if (top === 'auto') {\n    top = MIRROR_TB[relativeToAttachment.top];\n  }\n\n  return { left: left, top: top };\n};\n\nvar attachmentToOffset = function attachmentToOffset(attachment) {\n  var left = attachment.left;\n  var top = attachment.top;\n\n  if (typeof OFFSET_MAP[attachment.left] !== 'undefined') {\n    left = OFFSET_MAP[attachment.left];\n  }\n\n  if (typeof OFFSET_MAP[attachment.top] !== 'undefined') {\n    top = OFFSET_MAP[attachment.top];\n  }\n\n  return { left: left, top: top };\n};\n\nfunction addOffset() {\n  var out = { top: 0, left: 0 };\n\n  for (var _len = arguments.length, offsets = Array(_len), _key = 0; _key < _len; _key++) {\n    offsets[_key] = arguments[_key];\n  }\n\n  offsets.forEach(function (_ref) {\n    var top = _ref.top;\n    var left = _ref.left;\n\n    if (typeof top === 'string') {\n      top = parseFloat(top, 10);\n    }\n    if (typeof left === 'string') {\n      left = parseFloat(left, 10);\n    }\n\n    out.top += top;\n    out.left += left;\n  });\n\n  return out;\n}\n\nfunction offsetToPx(offset, size) {\n  if (typeof offset.left === 'string' && offset.left.indexOf('%') !== -1) {\n    offset.left = parseFloat(offset.left, 10) / 100 * size.width;\n  }\n  if (typeof offset.top === 'string' && offset.top.indexOf('%') !== -1) {\n    offset.top = parseFloat(offset.top, 10) / 100 * size.height;\n  }\n\n  return offset;\n}\n\nvar parseOffset = function parseOffset(value) {\n  var _value$split = value.split(' ');\n\n  var _value$split2 = _slicedToArray(_value$split, 2);\n\n  var top = _value$split2[0];\n  var left = _value$split2[1];\n\n  return { top: top, left: left };\n};\nvar parseAttachment = parseOffset;\n\nvar TetherClass = (function (_Evented) {\n  _inherits(TetherClass, _Evented);\n\n  function TetherClass(options) {\n    var _this = this;\n\n    _classCallCheck(this, TetherClass);\n\n    _get(Object.getPrototypeOf(TetherClass.prototype), 'constructor', this).call(this);\n    this.position = this.position.bind(this);\n\n    tethers.push(this);\n\n    this.history = [];\n\n    this.setOptions(options, false);\n\n    TetherBase.modules.forEach(function (module) {\n      if (typeof module.initialize !== 'undefined') {\n        module.initialize.call(_this);\n      }\n    });\n\n    this.position();\n  }\n\n  _createClass(TetherClass, [{\n    key: 'getClass',\n    value: function getClass() {\n      var key = arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];\n      var classes = this.options.classes;\n\n      if (typeof classes !== 'undefined' && classes[key]) {\n        return this.options.classes[key];\n      } else if (this.options.classPrefix) {\n        return this.options.classPrefix + '-' + key;\n      } else {\n        return key;\n      }\n    }\n  }, {\n    key: 'setOptions',\n    value: function setOptions(options) {\n      var _this2 = this;\n\n      var pos = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\n      var defaults = {\n        offset: '0 0',\n        targetOffset: '0 0',\n        targetAttachment: 'auto auto',\n        classPrefix: 'tether'\n      };\n\n      this.options = extend(defaults, options);\n\n      var _options = this.options;\n      var element = _options.element;\n      var target = _options.target;\n      var targetModifier = _options.targetModifier;\n\n      this.element = element;\n      this.target = target;\n      this.targetModifier = targetModifier;\n\n      if (this.target === 'viewport') {\n        this.target = document.body;\n        this.targetModifier = 'visible';\n      } else if (this.target === 'scroll-handle') {\n        this.target = document.body;\n        this.targetModifier = 'scroll-handle';\n      }\n\n      ['element', 'target'].forEach(function (key) {\n        if (typeof _this2[key] === 'undefined') {\n          throw new Error('Tether Error: Both element and target must be defined');\n        }\n\n        if (typeof _this2[key].jquery !== 'undefined') {\n          _this2[key] = _this2[key][0];\n        } else if (typeof _this2[key] === 'string') {\n          _this2[key] = document.querySelector(_this2[key]);\n        }\n      });\n\n      addClass(this.element, this.getClass('element'));\n      if (!(this.options.addTargetClasses === false)) {\n        addClass(this.target, this.getClass('target'));\n      }\n\n      if (!this.options.attachment) {\n        throw new Error('Tether Error: You must provide an attachment');\n      }\n\n      this.targetAttachment = parseAttachment(this.options.targetAttachment);\n      this.attachment = parseAttachment(this.options.attachment);\n      this.offset = parseOffset(this.options.offset);\n      this.targetOffset = parseOffset(this.options.targetOffset);\n\n      if (typeof this.scrollParents !== 'undefined') {\n        this.disable();\n      }\n\n      if (this.targetModifier === 'scroll-handle') {\n        this.scrollParents = [this.target];\n      } else {\n        this.scrollParents = getScrollParents(this.target);\n      }\n\n      if (!(this.options.enabled === false)) {\n        this.enable(pos);\n      }\n    }\n  }, {\n    key: 'getTargetBounds',\n    value: function getTargetBounds() {\n      if (typeof this.targetModifier !== 'undefined') {\n        if (this.targetModifier === 'visible') {\n          if (this.target === document.body) {\n            return { top: pageYOffset, left: pageXOffset, height: innerHeight, width: innerWidth };\n          } else {\n            var bounds = getBounds(this.target);\n\n            var out = {\n              height: bounds.height,\n              width: bounds.width,\n              top: bounds.top,\n              left: bounds.left\n            };\n\n            out.height = Math.min(out.height, bounds.height - (pageYOffset - bounds.top));\n            out.height = Math.min(out.height, bounds.height - (bounds.top + bounds.height - (pageYOffset + innerHeight)));\n            out.height = Math.min(innerHeight, out.height);\n            out.height -= 2;\n\n            out.width = Math.min(out.width, bounds.width - (pageXOffset - bounds.left));\n            out.width = Math.min(out.width, bounds.width - (bounds.left + bounds.width - (pageXOffset + innerWidth)));\n            out.width = Math.min(innerWidth, out.width);\n            out.width -= 2;\n\n            if (out.top < pageYOffset) {\n              out.top = pageYOffset;\n            }\n            if (out.left < pageXOffset) {\n              out.left = pageXOffset;\n            }\n\n            return out;\n          }\n        } else if (this.targetModifier === 'scroll-handle') {\n          var bounds = undefined;\n          var target = this.target;\n          if (target === document.body) {\n            target = document.documentElement;\n\n            bounds = {\n              left: pageXOffset,\n              top: pageYOffset,\n              height: innerHeight,\n              width: innerWidth\n            };\n          } else {\n            bounds = getBounds(target);\n          }\n\n          var style = getComputedStyle(target);\n\n          var hasBottomScroll = target.scrollWidth > target.clientWidth || [style.overflow, style.overflowX].indexOf('scroll') >= 0 || this.target !== document.body;\n\n          var scrollBottom = 0;\n          if (hasBottomScroll) {\n            scrollBottom = 15;\n          }\n\n          var height = bounds.height - parseFloat(style.borderTopWidth) - parseFloat(style.borderBottomWidth) - scrollBottom;\n\n          var out = {\n            width: 15,\n            height: height * 0.975 * (height / target.scrollHeight),\n            left: bounds.left + bounds.width - parseFloat(style.borderLeftWidth) - 15\n          };\n\n          var fitAdj = 0;\n          if (height < 408 && this.target === document.body) {\n            fitAdj = -0.00011 * Math.pow(height, 2) - 0.00727 * height + 22.58;\n          }\n\n          if (this.target !== document.body) {\n            out.height = Math.max(out.height, 24);\n          }\n\n          var scrollPercentage = this.target.scrollTop / (target.scrollHeight - height);\n          out.top = scrollPercentage * (height - out.height - fitAdj) + bounds.top + parseFloat(style.borderTopWidth);\n\n          if (this.target === document.body) {\n            out.height = Math.max(out.height, 24);\n          }\n\n          return out;\n        }\n      } else {\n        return getBounds(this.target);\n      }\n    }\n  }, {\n    key: 'clearCache',\n    value: function clearCache() {\n      this._cache = {};\n    }\n  }, {\n    key: 'cache',\n    value: function cache(k, getter) {\n      // More than one module will often need the same DOM info, so\n      // we keep a cache which is cleared on each position call\n      if (typeof this._cache === 'undefined') {\n        this._cache = {};\n      }\n\n      if (typeof this._cache[k] === 'undefined') {\n        this._cache[k] = getter.call(this);\n      }\n\n      return this._cache[k];\n    }\n  }, {\n    key: 'enable',\n    value: function enable() {\n      var _this3 = this;\n\n      var pos = arguments.length <= 0 || arguments[0] === undefined ? true : arguments[0];\n\n      if (!(this.options.addTargetClasses === false)) {\n        addClass(this.target, this.getClass('enabled'));\n      }\n      addClass(this.element, this.getClass('enabled'));\n      this.enabled = true;\n\n      this.scrollParents.forEach(function (parent) {\n        if (parent !== document) {\n          parent.addEventListener('scroll', _this3.position);\n        }\n      });\n\n      if (pos) {\n        this.position();\n      }\n    }\n  }, {\n    key: 'disable',\n    value: function disable() {\n      var _this4 = this;\n\n      removeClass(this.target, this.getClass('enabled'));\n      removeClass(this.element, this.getClass('enabled'));\n      this.enabled = false;\n\n      if (typeof this.scrollParents !== 'undefined') {\n        this.scrollParents.forEach(function (parent) {\n          parent.removeEventListener('scroll', _this4.position);\n        });\n      }\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      var _this5 = this;\n\n      this.disable();\n\n      tethers.forEach(function (tether, i) {\n        if (tether === _this5) {\n          tethers.splice(i, 1);\n        }\n      });\n\n      // Remove any elements we were using for convenience from the DOM\n      if (tethers.length === 0) {\n        removeUtilElements();\n      }\n    }\n  }, {\n    key: 'updateAttachClasses',\n    value: function updateAttachClasses(elementAttach, targetAttach) {\n      var _this6 = this;\n\n      elementAttach = elementAttach || this.attachment;\n      targetAttach = targetAttach || this.targetAttachment;\n      var sides = ['left', 'top', 'bottom', 'right', 'middle', 'center'];\n\n      if (typeof this._addAttachClasses !== 'undefined' && this._addAttachClasses.length) {\n        // updateAttachClasses can be called more than once in a position call, so\n        // we need to clean up after ourselves such that when the last defer gets\n        // ran it doesn't add any extra classes from previous calls.\n        this._addAttachClasses.splice(0, this._addAttachClasses.length);\n      }\n\n      if (typeof this._addAttachClasses === 'undefined') {\n        this._addAttachClasses = [];\n      }\n      var add = this._addAttachClasses;\n\n      if (elementAttach.top) {\n        add.push(this.getClass('element-attached') + '-' + elementAttach.top);\n      }\n      if (elementAttach.left) {\n        add.push(this.getClass('element-attached') + '-' + elementAttach.left);\n      }\n      if (targetAttach.top) {\n        add.push(this.getClass('target-attached') + '-' + targetAttach.top);\n      }\n      if (targetAttach.left) {\n        add.push(this.getClass('target-attached') + '-' + targetAttach.left);\n      }\n\n      var all = [];\n      sides.forEach(function (side) {\n        all.push(_this6.getClass('element-attached') + '-' + side);\n        all.push(_this6.getClass('target-attached') + '-' + side);\n      });\n\n      defer(function () {\n        if (!(typeof _this6._addAttachClasses !== 'undefined')) {\n          return;\n        }\n\n        updateClasses(_this6.element, _this6._addAttachClasses, all);\n        if (!(_this6.options.addTargetClasses === false)) {\n          updateClasses(_this6.target, _this6._addAttachClasses, all);\n        }\n\n        delete _this6._addAttachClasses;\n      });\n    }\n  }, {\n    key: 'position',\n    value: function position() {\n      var _this7 = this;\n\n      var flushChanges = arguments.length <= 0 || arguments[0] === undefined ? true : arguments[0];\n\n      // flushChanges commits the changes immediately, leave true unless you are positioning multiple\n      // tethers (in which case call Tether.Utils.flush yourself when you're done)\n\n      if (!this.enabled) {\n        return;\n      }\n\n      this.clearCache();\n\n      // Turn 'auto' attachments into the appropriate corner or edge\n      var targetAttachment = autoToFixedAttachment(this.targetAttachment, this.attachment);\n\n      this.updateAttachClasses(this.attachment, targetAttachment);\n\n      var elementPos = this.cache('element-bounds', function () {\n        return getBounds(_this7.element);\n      });\n\n      var width = elementPos.width;\n      var height = elementPos.height;\n\n      if (width === 0 && height === 0 && typeof this.lastSize !== 'undefined') {\n        var _lastSize = this.lastSize;\n\n        // We cache the height and width to make it possible to position elements that are\n        // getting hidden.\n        width = _lastSize.width;\n        height = _lastSize.height;\n      } else {\n        this.lastSize = { width: width, height: height };\n      }\n\n      var targetPos = this.cache('target-bounds', function () {\n        return _this7.getTargetBounds();\n      });\n      var targetSize = targetPos;\n\n      // Get an actual px offset from the attachment\n      var offset = offsetToPx(attachmentToOffset(this.attachment), { width: width, height: height });\n      var targetOffset = offsetToPx(attachmentToOffset(targetAttachment), targetSize);\n\n      var manualOffset = offsetToPx(this.offset, { width: width, height: height });\n      var manualTargetOffset = offsetToPx(this.targetOffset, targetSize);\n\n      // Add the manually provided offset\n      offset = addOffset(offset, manualOffset);\n      targetOffset = addOffset(targetOffset, manualTargetOffset);\n\n      // It's now our goal to make (element position + offset) == (target position + target offset)\n      var left = targetPos.left + targetOffset.left - offset.left;\n      var top = targetPos.top + targetOffset.top - offset.top;\n\n      for (var i = 0; i < TetherBase.modules.length; ++i) {\n        var _module2 = TetherBase.modules[i];\n        var ret = _module2.position.call(this, {\n          left: left,\n          top: top,\n          targetAttachment: targetAttachment,\n          targetPos: targetPos,\n          elementPos: elementPos,\n          offset: offset,\n          targetOffset: targetOffset,\n          manualOffset: manualOffset,\n          manualTargetOffset: manualTargetOffset,\n          scrollbarSize: scrollbarSize,\n          attachment: this.attachment\n        });\n\n        if (ret === false) {\n          return false;\n        } else if (typeof ret === 'undefined' || typeof ret !== 'object') {\n          continue;\n        } else {\n          top = ret.top;\n          left = ret.left;\n        }\n      }\n\n      // We describe the position three different ways to give the optimizer\n      // a chance to decide the best possible way to position the element\n      // with the fewest repaints.\n      var next = {\n        // It's position relative to the page (absolute positioning when\n        // the element is a child of the body)\n        page: {\n          top: top,\n          left: left\n        },\n\n        // It's position relative to the viewport (fixed positioning)\n        viewport: {\n          top: top - pageYOffset,\n          bottom: pageYOffset - top - height + innerHeight,\n          left: left - pageXOffset,\n          right: pageXOffset - left - width + innerWidth\n        }\n      };\n\n      var scrollbarSize = undefined;\n      if (document.body.scrollWidth > window.innerWidth) {\n        scrollbarSize = this.cache('scrollbar-size', getScrollBarSize);\n        next.viewport.bottom -= scrollbarSize.height;\n      }\n\n      if (document.body.scrollHeight > window.innerHeight) {\n        scrollbarSize = this.cache('scrollbar-size', getScrollBarSize);\n        next.viewport.right -= scrollbarSize.width;\n      }\n\n      if (['', 'static'].indexOf(document.body.style.position) === -1 || ['', 'static'].indexOf(document.body.parentElement.style.position) === -1) {\n        // Absolute positioning in the body will be relative to the page, not the 'initial containing block'\n        next.page.bottom = document.body.scrollHeight - top - height;\n        next.page.right = document.body.scrollWidth - left - width;\n      }\n\n      if (typeof this.options.optimizations !== 'undefined' && this.options.optimizations.moveElement !== false && !(typeof this.targetModifier !== 'undefined')) {\n        (function () {\n          var offsetParent = _this7.cache('target-offsetparent', function () {\n            return getOffsetParent(_this7.target);\n          });\n          var offsetPosition = _this7.cache('target-offsetparent-bounds', function () {\n            return getBounds(offsetParent);\n          });\n          var offsetParentStyle = getComputedStyle(offsetParent);\n          var offsetParentSize = offsetPosition;\n\n          var offsetBorder = {};\n          ['Top', 'Left', 'Bottom', 'Right'].forEach(function (side) {\n            offsetBorder[side.toLowerCase()] = parseFloat(offsetParentStyle['border' + side + 'Width']);\n          });\n\n          offsetPosition.right = document.body.scrollWidth - offsetPosition.left - offsetParentSize.width + offsetBorder.right;\n          offsetPosition.bottom = document.body.scrollHeight - offsetPosition.top - offsetParentSize.height + offsetBorder.bottom;\n\n          if (next.page.top >= offsetPosition.top + offsetBorder.top && next.page.bottom >= offsetPosition.bottom) {\n            if (next.page.left >= offsetPosition.left + offsetBorder.left && next.page.right >= offsetPosition.right) {\n              // We're within the visible part of the target's scroll parent\n              var scrollTop = offsetParent.scrollTop;\n              var scrollLeft = offsetParent.scrollLeft;\n\n              // It's position relative to the target's offset parent (absolute positioning when\n              // the element is moved to be a child of the target's offset parent).\n              next.offset = {\n                top: next.page.top - offsetPosition.top + scrollTop - offsetBorder.top,\n                left: next.page.left - offsetPosition.left + scrollLeft - offsetBorder.left\n              };\n            }\n          }\n        })();\n      }\n\n      // We could also travel up the DOM and try each containing context, rather than only\n      // looking at the body, but we're gonna get diminishing returns.\n\n      this.move(next);\n\n      this.history.unshift(next);\n\n      if (this.history.length > 3) {\n        this.history.pop();\n      }\n\n      if (flushChanges) {\n        flush();\n      }\n\n      return true;\n    }\n\n    // THE ISSUE\n  }, {\n    key: 'move',\n    value: function move(pos) {\n      var _this8 = this;\n\n      if (!(typeof this.element.parentNode !== 'undefined')) {\n        return;\n      }\n\n      var same = {};\n\n      for (var type in pos) {\n        same[type] = {};\n\n        for (var key in pos[type]) {\n          var found = false;\n\n          for (var i = 0; i < this.history.length; ++i) {\n            var point = this.history[i];\n            if (typeof point[type] !== 'undefined' && !within(point[type][key], pos[type][key])) {\n              found = true;\n              break;\n            }\n          }\n\n          if (!found) {\n            same[type][key] = true;\n          }\n        }\n      }\n\n      var css = { top: '', left: '', right: '', bottom: '' };\n\n      var transcribe = function transcribe(_same, _pos) {\n        var hasOptimizations = typeof _this8.options.optimizations !== 'undefined';\n        var gpu = hasOptimizations ? _this8.options.optimizations.gpu : null;\n        if (gpu !== false) {\n          var yPos = undefined,\n              xPos = undefined;\n          if (_same.top) {\n            css.top = 0;\n            yPos = _pos.top;\n          } else {\n            css.bottom = 0;\n            yPos = -_pos.bottom;\n          }\n\n          if (_same.left) {\n            css.left = 0;\n            xPos = _pos.left;\n          } else {\n            css.right = 0;\n            xPos = -_pos.right;\n          }\n\n          css[transformKey] = 'translateX(' + Math.round(xPos) + 'px) translateY(' + Math.round(yPos) + 'px)';\n\n          if (transformKey !== 'msTransform') {\n            // The Z transform will keep this in the GPU (faster, and prevents artifacts),\n            // but IE9 doesn't support 3d transforms and will choke.\n            css[transformKey] += \" translateZ(0)\";\n          }\n        } else {\n          if (_same.top) {\n            css.top = _pos.top + 'px';\n          } else {\n            css.bottom = _pos.bottom + 'px';\n          }\n\n          if (_same.left) {\n            css.left = _pos.left + 'px';\n          } else {\n            css.right = _pos.right + 'px';\n          }\n        }\n      };\n\n      var moved = false;\n      if ((same.page.top || same.page.bottom) && (same.page.left || same.page.right)) {\n        css.position = 'absolute';\n        transcribe(same.page, pos.page);\n      } else if ((same.viewport.top || same.viewport.bottom) && (same.viewport.left || same.viewport.right)) {\n        css.position = 'fixed';\n        transcribe(same.viewport, pos.viewport);\n      } else if (typeof same.offset !== 'undefined' && same.offset.top && same.offset.left) {\n        (function () {\n          css.position = 'absolute';\n          var offsetParent = _this8.cache('target-offsetparent', function () {\n            return getOffsetParent(_this8.target);\n          });\n\n          if (getOffsetParent(_this8.element) !== offsetParent) {\n            defer(function () {\n              _this8.element.parentNode.removeChild(_this8.element);\n              offsetParent.appendChild(_this8.element);\n            });\n          }\n\n          transcribe(same.offset, pos.offset);\n          moved = true;\n        })();\n      } else {\n        css.position = 'absolute';\n        transcribe({ top: true, left: true }, pos.page);\n      }\n\n      if (!moved) {\n        var offsetParentIsBody = true;\n        var currentNode = this.element.parentNode;\n        while (currentNode && currentNode.nodeType === 1 && currentNode.tagName !== 'BODY') {\n          if (getComputedStyle(currentNode).position !== 'static') {\n            offsetParentIsBody = false;\n            break;\n          }\n\n          currentNode = currentNode.parentNode;\n        }\n\n        if (!offsetParentIsBody) {\n          this.element.parentNode.removeChild(this.element);\n          document.body.appendChild(this.element);\n        }\n      }\n\n      // Any css change will trigger a repaint, so let's avoid one if nothing changed\n      var writeCSS = {};\n      var write = false;\n      for (var key in css) {\n        var val = css[key];\n        var elVal = this.element.style[key];\n\n        if (elVal !== val) {\n          write = true;\n          writeCSS[key] = val;\n        }\n      }\n\n      if (write) {\n        defer(function () {\n          extend(_this8.element.style, writeCSS);\n        });\n      }\n    }\n  }]);\n\n  return TetherClass;\n})(Evented);\n\nTetherClass.modules = [];\n\nTetherBase.position = position;\n\nvar Tether = extend(TetherClass, TetherBase);\n/* globals TetherBase */\n\n'use strict';\n\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\n\nvar _TetherBase$Utils = TetherBase.Utils;\nvar getBounds = _TetherBase$Utils.getBounds;\nvar extend = _TetherBase$Utils.extend;\nvar updateClasses = _TetherBase$Utils.updateClasses;\nvar defer = _TetherBase$Utils.defer;\n\nvar BOUNDS_FORMAT = ['left', 'top', 'right', 'bottom'];\n\nfunction getBoundingRect(tether, to) {\n  if (to === 'scrollParent') {\n    to = tether.scrollParents[0];\n  } else if (to === 'window') {\n    to = [pageXOffset, pageYOffset, innerWidth + pageXOffset, innerHeight + pageYOffset];\n  }\n\n  if (to === document) {\n    to = to.documentElement;\n  }\n\n  if (typeof to.nodeType !== 'undefined') {\n    (function () {\n      var size = getBounds(to);\n      var pos = size;\n      var style = getComputedStyle(to);\n\n      to = [pos.left, pos.top, size.width + pos.left, size.height + pos.top];\n\n      BOUNDS_FORMAT.forEach(function (side, i) {\n        side = side[0].toUpperCase() + side.substr(1);\n        if (side === 'Top' || side === 'Left') {\n          to[i] += parseFloat(style['border' + side + 'Width']);\n        } else {\n          to[i] -= parseFloat(style['border' + side + 'Width']);\n        }\n      });\n    })();\n  }\n\n  return to;\n}\n\nTetherBase.modules.push({\n  position: function position(_ref) {\n    var _this = this;\n\n    var top = _ref.top;\n    var left = _ref.left;\n    var targetAttachment = _ref.targetAttachment;\n\n    if (!this.options.constraints) {\n      return true;\n    }\n\n    var _cache = this.cache('element-bounds', function () {\n      return getBounds(_this.element);\n    });\n\n    var height = _cache.height;\n    var width = _cache.width;\n\n    if (width === 0 && height === 0 && typeof this.lastSize !== 'undefined') {\n      var _lastSize = this.lastSize;\n\n      // Handle the item getting hidden as a result of our positioning without glitching\n      // the classes in and out\n      width = _lastSize.width;\n      height = _lastSize.height;\n    }\n\n    var targetSize = this.cache('target-bounds', function () {\n      return _this.getTargetBounds();\n    });\n\n    var targetHeight = targetSize.height;\n    var targetWidth = targetSize.width;\n\n    var allClasses = [this.getClass('pinned'), this.getClass('out-of-bounds')];\n\n    this.options.constraints.forEach(function (constraint) {\n      var outOfBoundsClass = constraint.outOfBoundsClass;\n      var pinnedClass = constraint.pinnedClass;\n\n      if (outOfBoundsClass) {\n        allClasses.push(outOfBoundsClass);\n      }\n      if (pinnedClass) {\n        allClasses.push(pinnedClass);\n      }\n    });\n\n    allClasses.forEach(function (cls) {\n      ['left', 'top', 'right', 'bottom'].forEach(function (side) {\n        allClasses.push(cls + '-' + side);\n      });\n    });\n\n    var addClasses = [];\n\n    var tAttachment = extend({}, targetAttachment);\n    var eAttachment = extend({}, this.attachment);\n\n    this.options.constraints.forEach(function (constraint) {\n      var to = constraint.to;\n      var attachment = constraint.attachment;\n      var pin = constraint.pin;\n\n      if (typeof attachment === 'undefined') {\n        attachment = '';\n      }\n\n      var changeAttachX = undefined,\n          changeAttachY = undefined;\n      if (attachment.indexOf(' ') >= 0) {\n        var _attachment$split = attachment.split(' ');\n\n        var _attachment$split2 = _slicedToArray(_attachment$split, 2);\n\n        changeAttachY = _attachment$split2[0];\n        changeAttachX = _attachment$split2[1];\n      } else {\n        changeAttachX = changeAttachY = attachment;\n      }\n\n      var bounds = getBoundingRect(_this, to);\n\n      if (changeAttachY === 'target' || changeAttachY === 'both') {\n        if (top < bounds[1] && tAttachment.top === 'top') {\n          top += targetHeight;\n          tAttachment.top = 'bottom';\n        }\n\n        if (top + height > bounds[3] && tAttachment.top === 'bottom') {\n          top -= targetHeight;\n          tAttachment.top = 'top';\n        }\n      }\n\n      if (changeAttachY === 'together') {\n        if (tAttachment.top === 'top') {\n          if (eAttachment.top === 'bottom' && top < bounds[1]) {\n            top += targetHeight;\n            tAttachment.top = 'bottom';\n\n            top += height;\n            eAttachment.top = 'top';\n          } else if (eAttachment.top === 'top' && top + height > bounds[3] && top - (height - targetHeight) >= bounds[1]) {\n            top -= height - targetHeight;\n            tAttachment.top = 'bottom';\n\n            eAttachment.top = 'bottom';\n          }\n        }\n\n        if (tAttachment.top === 'bottom') {\n          if (eAttachment.top === 'top' && top + height > bounds[3]) {\n            top -= targetHeight;\n            tAttachment.top = 'top';\n\n            top -= height;\n            eAttachment.top = 'bottom';\n          } else if (eAttachment.top === 'bottom' && top < bounds[1] && top + (height * 2 - targetHeight) <= bounds[3]) {\n            top += height - targetHeight;\n            tAttachment.top = 'top';\n\n            eAttachment.top = 'top';\n          }\n        }\n\n        if (tAttachment.top === 'middle') {\n          if (top + height > bounds[3] && eAttachment.top === 'top') {\n            top -= height;\n            eAttachment.top = 'bottom';\n          } else if (top < bounds[1] && eAttachment.top === 'bottom') {\n            top += height;\n            eAttachment.top = 'top';\n          }\n        }\n      }\n\n      if (changeAttachX === 'target' || changeAttachX === 'both') {\n        if (left < bounds[0] && tAttachment.left === 'left') {\n          left += targetWidth;\n          tAttachment.left = 'right';\n        }\n\n        if (left + width > bounds[2] && tAttachment.left === 'right') {\n          left -= targetWidth;\n          tAttachment.left = 'left';\n        }\n      }\n\n      if (changeAttachX === 'together') {\n        if (left < bounds[0] && tAttachment.left === 'left') {\n          if (eAttachment.left === 'right') {\n            left += targetWidth;\n            tAttachment.left = 'right';\n\n            left += width;\n            eAttachment.left = 'left';\n          } else if (eAttachment.left === 'left') {\n            left += targetWidth;\n            tAttachment.left = 'right';\n\n            left -= width;\n            eAttachment.left = 'right';\n          }\n        } else if (left + width > bounds[2] && tAttachment.left === 'right') {\n          if (eAttachment.left === 'left') {\n            left -= targetWidth;\n            tAttachment.left = 'left';\n\n            left -= width;\n            eAttachment.left = 'right';\n          } else if (eAttachment.left === 'right') {\n            left -= targetWidth;\n            tAttachment.left = 'left';\n\n            left += width;\n            eAttachment.left = 'left';\n          }\n        } else if (tAttachment.left === 'center') {\n          if (left + width > bounds[2] && eAttachment.left === 'left') {\n            left -= width;\n            eAttachment.left = 'right';\n          } else if (left < bounds[0] && eAttachment.left === 'right') {\n            left += width;\n            eAttachment.left = 'left';\n          }\n        }\n      }\n\n      if (changeAttachY === 'element' || changeAttachY === 'both') {\n        if (top < bounds[1] && eAttachment.top === 'bottom') {\n          top += height;\n          eAttachment.top = 'top';\n        }\n\n        if (top + height > bounds[3] && eAttachment.top === 'top') {\n          top -= height;\n          eAttachment.top = 'bottom';\n        }\n      }\n\n      if (changeAttachX === 'element' || changeAttachX === 'both') {\n        if (left < bounds[0]) {\n          if (eAttachment.left === 'right') {\n            left += width;\n            eAttachment.left = 'left';\n          } else if (eAttachment.left === 'center') {\n            left += width / 2;\n            eAttachment.left = 'left';\n          }\n        }\n\n        if (left + width > bounds[2]) {\n          if (eAttachment.left === 'left') {\n            left -= width;\n            eAttachment.left = 'right';\n          } else if (eAttachment.left === 'center') {\n            left -= width / 2;\n            eAttachment.left = 'right';\n          }\n        }\n      }\n\n      if (typeof pin === 'string') {\n        pin = pin.split(',').map(function (p) {\n          return p.trim();\n        });\n      } else if (pin === true) {\n        pin = ['top', 'left', 'right', 'bottom'];\n      }\n\n      pin = pin || [];\n\n      var pinned = [];\n      var oob = [];\n\n      if (top < bounds[1]) {\n        if (pin.indexOf('top') >= 0) {\n          top = bounds[1];\n          pinned.push('top');\n        } else {\n          oob.push('top');\n        }\n      }\n\n      if (top + height > bounds[3]) {\n        if (pin.indexOf('bottom') >= 0) {\n          top = bounds[3] - height;\n          pinned.push('bottom');\n        } else {\n          oob.push('bottom');\n        }\n      }\n\n      if (left < bounds[0]) {\n        if (pin.indexOf('left') >= 0) {\n          left = bounds[0];\n          pinned.push('left');\n        } else {\n          oob.push('left');\n        }\n      }\n\n      if (left + width > bounds[2]) {\n        if (pin.indexOf('right') >= 0) {\n          left = bounds[2] - width;\n          pinned.push('right');\n        } else {\n          oob.push('right');\n        }\n      }\n\n      if (pinned.length) {\n        (function () {\n          var pinnedClass = undefined;\n          if (typeof _this.options.pinnedClass !== 'undefined') {\n            pinnedClass = _this.options.pinnedClass;\n          } else {\n            pinnedClass = _this.getClass('pinned');\n          }\n\n          addClasses.push(pinnedClass);\n          pinned.forEach(function (side) {\n            addClasses.push(pinnedClass + '-' + side);\n          });\n        })();\n      }\n\n      if (oob.length) {\n        (function () {\n          var oobClass = undefined;\n          if (typeof _this.options.outOfBoundsClass !== 'undefined') {\n            oobClass = _this.options.outOfBoundsClass;\n          } else {\n            oobClass = _this.getClass('out-of-bounds');\n          }\n\n          addClasses.push(oobClass);\n          oob.forEach(function (side) {\n            addClasses.push(oobClass + '-' + side);\n          });\n        })();\n      }\n\n      if (pinned.indexOf('left') >= 0 || pinned.indexOf('right') >= 0) {\n        eAttachment.left = tAttachment.left = false;\n      }\n      if (pinned.indexOf('top') >= 0 || pinned.indexOf('bottom') >= 0) {\n        eAttachment.top = tAttachment.top = false;\n      }\n\n      if (tAttachment.top !== targetAttachment.top || tAttachment.left !== targetAttachment.left || eAttachment.top !== _this.attachment.top || eAttachment.left !== _this.attachment.left) {\n        _this.updateAttachClasses(eAttachment, tAttachment);\n        _this.trigger('update', {\n          attachment: eAttachment,\n          targetAttachment: tAttachment\n        });\n      }\n    });\n\n    defer(function () {\n      if (!(_this.options.addTargetClasses === false)) {\n        updateClasses(_this.target, addClasses, allClasses);\n      }\n      updateClasses(_this.element, addClasses, allClasses);\n    });\n\n    return { top: top, left: left };\n  }\n});\n/* globals TetherBase */\n\n'use strict';\n\nvar _TetherBase$Utils = TetherBase.Utils;\nvar getBounds = _TetherBase$Utils.getBounds;\nvar updateClasses = _TetherBase$Utils.updateClasses;\nvar defer = _TetherBase$Utils.defer;\n\nTetherBase.modules.push({\n  position: function position(_ref) {\n    var _this = this;\n\n    var top = _ref.top;\n    var left = _ref.left;\n\n    var _cache = this.cache('element-bounds', function () {\n      return getBounds(_this.element);\n    });\n\n    var height = _cache.height;\n    var width = _cache.width;\n\n    var targetPos = this.getTargetBounds();\n\n    var bottom = top + height;\n    var right = left + width;\n\n    var abutted = [];\n    if (top <= targetPos.bottom && bottom >= targetPos.top) {\n      ['left', 'right'].forEach(function (side) {\n        var targetPosSide = targetPos[side];\n        if (targetPosSide === left || targetPosSide === right) {\n          abutted.push(side);\n        }\n      });\n    }\n\n    if (left <= targetPos.right && right >= targetPos.left) {\n      ['top', 'bottom'].forEach(function (side) {\n        var targetPosSide = targetPos[side];\n        if (targetPosSide === top || targetPosSide === bottom) {\n          abutted.push(side);\n        }\n      });\n    }\n\n    var allClasses = [];\n    var addClasses = [];\n\n    var sides = ['left', 'top', 'right', 'bottom'];\n    allClasses.push(this.getClass('abutted'));\n    sides.forEach(function (side) {\n      allClasses.push(_this.getClass('abutted') + '-' + side);\n    });\n\n    if (abutted.length) {\n      addClasses.push(this.getClass('abutted'));\n    }\n\n    abutted.forEach(function (side) {\n      addClasses.push(_this.getClass('abutted') + '-' + side);\n    });\n\n    defer(function () {\n      if (!(_this.options.addTargetClasses === false)) {\n        updateClasses(_this.target, addClasses, allClasses);\n      }\n      updateClasses(_this.element, addClasses, allClasses);\n    });\n\n    return true;\n  }\n});\n/* globals TetherBase */\n\n'use strict';\n\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\n\nTetherBase.modules.push({\n  position: function position(_ref) {\n    var top = _ref.top;\n    var left = _ref.left;\n\n    if (!this.options.shift) {\n      return;\n    }\n\n    var shift = this.options.shift;\n    if (typeof this.options.shift === 'function') {\n      shift = this.options.shift.call(this, { top: top, left: left });\n    }\n\n    var shiftTop = undefined,\n        shiftLeft = undefined;\n    if (typeof shift === 'string') {\n      shift = shift.split(' ');\n      shift[1] = shift[1] || shift[0];\n\n      var _shift = shift;\n\n      var _shift2 = _slicedToArray(_shift, 2);\n\n      shiftTop = _shift2[0];\n      shiftLeft = _shift2[1];\n\n      shiftTop = parseFloat(shiftTop, 10);\n      shiftLeft = parseFloat(shiftLeft, 10);\n    } else {\n      shiftTop = shift.top;\n      shiftLeft = shift.left;\n    }\n\n    top += shiftTop;\n    left += shiftLeft;\n\n    return { top: top, left: left };\n  }\n});\nreturn Tether;\n\n}));\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvbG9jYWwvYXBwLmpzIiwiYXNzZXRzL2pzL2xvY2FsL3V0aWxzLmpzIiwibm9kZV9tb2R1bGVzL3RldGhlci1kcm9wL2Rpc3QvanMvZHJvcC5qcyIsIm5vZGVfbW9kdWxlcy90ZXRoZXItdG9vbHRpcC9kaXN0L2pzL3Rvb2x0aXAuanMiLCJub2RlX21vZHVsZXMvdGV0aGVyL2Rpc3QvanMvdGV0aGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7QUNFQSxnQkFBTSxZQUFOO0FBQ0EsZ0JBQU0sZ0JBQU47QUFDQSxnQkFBTSxnQkFBTjtBQUNBLGdCQUFNLGlCQUFOO0FBQ0EsZ0JBQU0sY0FBTjs7QUFFQSxnQkFBTSxhQUFOOzs7OztBQ1JBLENBQUMsVUFBUyxDQUFULEVBQVk7O0FBRVgsU0FBTyxFQUFQLENBQVUsT0FBVixHQUFvQixHQUFHLE9BQUgsQ0FGVDs7QUFJWCxNQUFJLFVBQVUsUUFBUSxnQkFBUixDQUFWLENBSk87O0FBTVgsTUFBSSxRQUFRLFlBQVk7O0FBRXRCLFFBQUksVUFBVSxFQUFFLFVBQUYsQ0FBVjtRQUNBLFVBQVUsRUFBRSxnQkFBRixFQUFvQixNQUFwQixFQUFWO1FBQ0EsVUFBVSxFQUFFLE9BQUYsQ0FBVjtRQUNBLFFBQVEsRUFBRSxNQUFGLENBQVI7UUFDQSxXQUFXLEVBQUUsZ0JBQUYsQ0FBWCxDQU5rQjs7QUFTdEIsYUFBUyxVQUFULENBQW9CLElBQXBCLEVBQTBCLEdBQTFCLEVBQStCOztBQUU3QixXQUFLLEVBQUwsQ0FBUSxrQkFBUixFQUE0QixVQUFTLEtBQVQsRUFBZ0I7O0FBRTFDLGNBQU0sZUFBTixHQUYwQztBQUcxQyxjQUFNLGNBQU4sR0FIMEM7O0FBSzFDLFlBQUcsTUFBTSxPQUFOLEtBQWtCLElBQWxCLEVBQXdCO0FBQ3pCLGNBQUksS0FBSixFQUR5QjtBQUV6QixnQkFBTSxPQUFOLEdBQWdCLElB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YUFBZjtLQVhGLENBbE1zQjtHQUFYLEVBQVQ7OztBQU5PLFFBeU5YLENBQU8sT0FBUCxHQUFpQixLQUFqQixDQXpOVztDQUFaLENBQUQsQ0EyTkcsTUEzTkg7OztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCBVdGlscyBmcm9tICcuL3V0aWxzJztcblxuVXRpbHMubGF6eUxvYWRJbWdzKCk7XG5VdGlscy5yZXNwb25zaWZ5VmlkZW9zKCk7XG5VdGlscy5yZXNwb25zaWZ5VGFibGVzKCk7XG5VdGlscy50b29sdGlwTmV3c2xldHRlcigpO1xuVXRpbHMuYWRkRm9ybUNsYXNzZXMoKTtcblxuVXRpbHMuY2l0YXRpb25zSW5pdCgpO1xuIiwiKGZ1bmN0aW9uKCQpIHtcblxuICBqUXVlcnkuZm4ucmV2ZXJzZSA9IFtdLnJldmVyc2U7XG5cbiAgdmFyIFRvb2x0aXAgPSByZXF1aXJlKCd0ZXRoZXItdG9vbHRpcCcpO1xuXG4gIHZhciBVdGlscyA9IChmdW5jdGlvbigpIHtcblxuICAgIHZhciAkaW1hZ2VzID0gJCgnLmlzLWxhenknKSxcbiAgICAgICAgJHZpZGVvcyA9ICQoJy5jb250ZW50LXZpZGVvJykucGFyZW50KCksXG4gICAgICAgICR0YWJsZXMgPSAkKCd0YWJsZScpLFxuICAgICAgICAkYm9keSA9ICQoJ2JvZHknKSxcbiAgICAgICAgJGNvbnRlbnQgPSAkKCcuZW50cnktY29udGVudCcpO1xuXG5cbiAgICBmdW5jdGlvbiB0b3VjaENsaWNrKCRidG4sIGZuYykge1xuXG4gICAgICAkYnRuLm9uKFwiY2xpY2sgdG91Y2hzdGFydFwiLCBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGlmKGV2ZW50LmhhbmRsZWQgIT09IHRydWUpIHtcbiAgICAgICAgICBmbmMoZXZlbnQpO1xuICAgICAgICAgIGV2ZW50LmhhbmRsZWQgPSB0cnVlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgIH0pO1xuXG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBsYXp5TG9hZEltZ3MoKSB7XG4gICAgICAkaW1hZ2VzLmxhenlsb2FkKHtcbiAgICAgICAgZWZmZWN0OiBcImZhZGVJblwiXG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcmVzcG9uc2lmeVRhYmxlcygpIHtcbiAgICAgIC8vICR0YWJsZXMuYmFzaWN0YWJsZSh7XG4gICAgICAvLyAgIGJyZWFrcG9pbnQ6IDcwMFxuICAgICAgLy8gfSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHJlc3BvbnNpZnlWaWRlb3MoKSB7XG4gICAgICAkdmlkZW9zLmZpdFZpZHMoKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gY2hlY2tGb3JJRSgpIHtcblxuICAgICAgdmFyIHNBZ2VudCA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50O1xuICAgICAgdmFyIElkeCA9IHNBZ2VudC5pbmRleE9mKFwiTVNJRVwiKTtcblxuICAgICAgLy8gSWYgSUUsIHJldHVybiB2ZXJzaW9uIG51bWJlci5cbiAgICAgIGlmIChJZHggPiAwKSB7XG4gICAgICAgIC8vIHJldHVybiBwYXJzZUludChzQWdlbnQuc3Vic3RyaW5nKElkeCsgNSwgc0FnZW50LmluZGV4T2YoXCIuXCIsIElkeCkpKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgIH0gZWxzZSBpZiAoISFuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9UcmlkZW50XFwvN1xcLi8pKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvL0l0IGlzIG5vdCBJRVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGFkZEZvcm1DbGFzc2VzKCkge1xuICAgICAgY29uc29sZS5sb2coJ2luc2lkZScpO1xuICAgICAgJCgnI2NoaW1weV9zaG9ydGNvZGVfMScpLnN1Ym1pdChmdW5jdGlvbihldmVudCkge1xuICAgICAgICBjb25zb2xlLmxvZygncmVhZHknKTtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnaXMtc3VibWl0dGluZycpO1xuICAgICAgfSk7XG5cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gdG9vbHRpcE5ld3NsZXR0ZXIoKSB7XG4gICAgICBuZXcgVG9vbHRpcCh7XG4gICAgICAgIHRhcmdldDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvb2x0aXAtbmV3c2xldHRlcicpLFxuICAgICAgICBjb250ZW50OiBcIkkgd2lsbCBuZXZlciBzZW5kIHlvdSBzcGFtIG9yIHNlbGwgeW91ciBlbWFpbCBhZGRyZXNzIHRvIGFueSB0aGlyZC1wYXJ0eVwiLFxuICAgICAgICBjbGFzc2VzOiAndG9vbHRpcC10ZXRoZXItYXJyb3dzJyxcbiAgICAgICAgcG9zaXRpb246ICd0b3AgbGVmdCdcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBwb3NpdGlvbkNpdGF0aW9ucygpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdoZXJlZWVlZWUnKTtcbiAgICAgIHZhciAkY2l0YXRpb25Db250ZW50ID0gJCgnLmNpdGF0aW9uJyk7XG4gICAgICB2YXIgJGNpdGF0aW9uTnVtID0gJCgnLmNpdGF0aW9uLW51bScpO1xuICAgICAgdmFyIHRvcFBvcyA9IFtdO1xuXG4gICAgICAkY2l0YXRpb25OdW0uZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdG9wUG9zLnB1c2goICQodGhpcykub2Zmc2V0KCkudG9wICk7XG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coJ3RvcFBvczogJywgdG9wUG9zKTtcblxuICAgICAgJGNpdGF0aW9uQ29udGVudC5lYWNoKGZ1bmN0aW9uKGluZGV4LCB2YWx1ZSkge1xuICAgICAgICAkKHRoaXMpLmNzcygndG9wJywgdG9wUG9zW2luZGV4XSk7XG4gICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FuaW1hdGVkIGZhZGVJbiBpcy12aXNpYmxlJyk7XG4gICAgICB9KTtcblxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBtb3ZlQ2l0YXRpb25zRGVza3RvcCgpIHtcblxuICAgICAgdmFyICRjaXRhdGlvbkNvbnRlbnQgPSAkKCcuY2l0YXRpb24nKTtcblxuICAgICAgJGNpdGF0aW9uQ29udGVudC5yZXZlcnNlKCkuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgJCgnLmVudHJ5LWNvbnRlbnQnKS5wcmVwZW5kKCAkKHRoaXMpLnJlbW92ZUNsYXNzKCdjaXRhdGlvbi1tb2JpbGUnKS5kZXRhY2goKS5hZGRDbGFzcygnaXMtdmlzaWJsZScpICk7XG4gICAgICB9KTtcblxuICAgICAgJCgnLmNpdGF0aW9uLW51bS5jaXRhdGlvbi1udW0tbW9iaWxlJykudW5iaW5kKCdjbGljaycpO1xuICAgICAgJCgnLmNpdGF0aW9uLW51bScpLnJlbW92ZUNsYXNzKCdjaXRhdGlvbi1udW0tbW9iaWxlJyk7XG5cbiAgICAgIGhvdmVyQ2l0YXRpb25OdW0oKTtcbiAgICAgIHBvc2l0aW9uQ2l0YXRpb25zKCk7XG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBob3ZlckNpdGF0aW9uTnVtKCkge1xuICAgICAgdmFyICRjaXRhdGlvbkNvbnRlbnQgPSAkKCcuY2l0YXRpb24nKTtcbiAgICAgIHZhciAkY2l0YXRpb25OdW0gPSAkKCcuY2l0YXRpb24tbnVtJyk7XG5cbiAgICAgICQoJy5jaXRhdGlvbi1udW06bm90KC5jaXRhdGlvbi1udW0tbW9iaWxlKScpLmJpbmQoe1xuICAgICAgICBtb3VzZWVudGVyOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ2luJylcbiAgICAgICAgICB2YXIgJGNpdE51bSA9ICQodGhpcykuZGF0YSgnY2l0YXRpb24tbnVtJyk7XG4gICAgICAgICAgdmFyICRlbGVtZW50ID0gJCgnLmNpdGF0aW9uW2RhdGEtY2l0YXRpb249JyArICRjaXROdW0gKyAnXScpO1xuXG4gICAgICAgICAgJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2ZhZGVJbkRvd24nKS5yZW1vdmVDbGFzcygnZmFkZUluJykuYWRkQ2xhc3MoJ3dvYmJsZScpO1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiJGVsZW1lbnQ6IFwiLCAkZWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICAgIG1vdXNlbGVhdmU6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICB2YXIgJGNpdE51bSA9ICQodGhpcykuZGF0YSgnY2l0YXRpb24tbnVtJyk7XG4gICAgICAgICAgdmFyICRlbGVtZW50ID0gJCgnLmNpdGF0aW9uW2RhdGEtY2l0YXRpb249JyArICRjaXROdW0gKyAnXScpO1xuXG4gICAgICAgICAgJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3dvYmJsZScpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdvdXQnKTtcbiAgICAgICAgfVxuICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBtb3ZlQ2l0YXRpb25Pbk1vYmlsZSgpIHtcblxuICAgICAgJCgnLmNpdGF0aW9uJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNpdE51bSA9ICQodGhpcykuZGF0YSgnY2l0YXRpb24nKTtcbiAgICAgICAgdmFyICRjaXROdW0gPSAkKCcuY2l0YXRpb24tbnVtW2RhdGEtY2l0YXRpb24tbnVtPScgKyBjaXROdW0gKyAnXScpO1xuXG4gICAgICAgICRjaXROdW1cbiAgICAgICAgICAudW5iaW5kKCdtb3VzZWVudGVyIG1vdXNlbGVhdmUnKVxuICAgICAgICAgIC5hZGRDbGFzcygnY2l0YXRpb24tbnVtLW1vYmlsZScpXG4gICAgICAgICAgLmFmdGVyKFxuICAgICAgICAgICAgJCh0aGlzKVxuICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2NpdGF0aW9uLW1vYmlsZScpXG4gICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaXMtdmlzaWJsZSB3b2JibGUnKVxuICAgICAgICAgICAgICAuZGV0YWNoKClcbiAgICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHNob3dDaXRhdGlvbk9uQ2xpY2soKSB7XG4gICAgICAkKCcuY2l0YXRpb24tbnVtLmNpdGF0aW9uLW51bS1tb2JpbGUnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB0b3VjaENsaWNrKCQodGhpcyksICgpID0+IHtcbiAgICAgICAgICAkKHRoaXMpLm5leHQoKS5hZGRDbGFzcygnZmFkZUluJykuc2xpZGVUb2dnbGUoMjAwKTtcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gY2l0YXRpb25zSW5pdCgpIHtcbiAgICAgIHZhciByZXNpemVUaW1lcjtcblxuICAgICAgZnVuY3Rpb24gcmVzaXplRnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDEzMDApIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnYmVsb3cgMTMwMCcpO1xuICAgICAgICAgIG1vdmVDaXRhdGlvbk9uTW9iaWxlKCk7XG4gICAgICAgICAgc2hvd0NpdGF0aW9uT25DbGljaygpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ2Fib3ZlIDEzMDAnKTtcbiAgICAgICAgICBtb3ZlQ2l0YXRpb25zRGVza3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAvLyBPbiByZXNpemUsIHJ1biB0aGUgZnVuY3Rpb24gYW5kIHJlc2V0IHRoZSB0aW1lb3V0XG4gICAgICAvLyAyNTAgaXMgdGhlIGRlbGF5IGluIG1pbGxpc2Vjb25kcy4gQ2hhbmdlIGFzIHlvdSBzZWUgZml0LlxuICAgICAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHJlc2l6ZVRpbWVyKTtcbiAgICAgICAgcmVzaXplVGltZXIgPSBzZXRUaW1lb3V0KHJlc2l6ZUZ1bmN0aW9uLCA1MDApO1xuICAgICAgfSk7XG5cbiAgICAgIHJlc2l6ZUZ1bmN0aW9uKCk7XG5cbiAgICB9XG5cblxuICAgIHJldHVybiB7XG4gICAgICBsYXp5TG9hZEltZ3M6IGxhenlMb2FkSW1ncyxcbiAgICAgIHJlc3BvbnNpZnlWaWRlb3M6IHJlc3BvbnNpZnlWaWRlb3MsXG4gICAgICByZXNwb25zaWZ5VGFibGVzOiByZXNwb25zaWZ5VGFibGVzLFxuICAgICAgY2hlY2tGb3JJRTogY2hlY2tGb3JJRSxcbiAgICAgIGFkZEZvcm1DbGFzc2VzOiBhZGRGb3JtQ2xhc3NlcyxcbiAgICAgIHRvb2x0aXBOZXdzbGV0dGVyOiB0b29sdGlwTmV3c2xldHRlcixcbiAgICAgIHBvc2l0aW9uQ2l0YXRpb25zOiBwb3NpdGlvbkNpdGF0aW9ucyxcbiAgICAgIGhvdmVyQ2l0YXRpb25OdW06IGhvdmVyQ2l0YXRpb25OdW0sXG4gICAgICBtb3ZlQ2l0YXRpb25Pbk1vYmlsZTogbW92ZUNpdGF0aW9uT25Nb2JpbGUsXG4gICAgICBzaG93Q2l0YXRpb25PbkNsaWNrOiBzaG93Q2l0YXRpb25PbkNsaWNrLFxuICAgICAgY2l0YXRpb25zSW5pdDogY2l0YXRpb25zSW5pdFxuICAgIH07XG5cbiAgfSkoKTtcblxuICAvKiBFeHBvc2luZyBvdXIgZnVuY3Rpb25zIHRvIHRoZSByZXN0IG9mIHRoZSBhcHBsaWNhdGlvbiAqL1xuICBtb2R1bGUuZXhwb3J0cyA9IFV0aWxzO1xuXG59KShqUXVlcnkpO1xuIiwiLyohIHRldGhlci1kcm9wIDEuNC4xICovXG5cbihmdW5jdGlvbihyb290LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW1widGV0aGVyXCJdLCBmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgndGV0aGVyJykpO1xuICB9IGVsc2Uge1xuICAgIHJvb3QuRHJvcCA9IGZhY3Rvcnkocm9vdC5UZXRoZXIpO1xuICB9XG59KHRoaXMsIGZ1bmN0aW9uKFRldGhlcikge1xuXG4vKiBnbG9iYWwgVGV0aGVyICovXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfYmluZCA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kO1xuXG52YXIgX3NsaWNlZFRvQXJyYXkgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBzbGljZUl0ZXJhdG9yKGFyciwgaSkgeyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsncmV0dXJuJ10pIF9pWydyZXR1cm4nXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0gcmV0dXJuIGZ1bmN0aW9uIChhcnIsIGkpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgeyByZXR1cm4gYXJyOyB9IGVsc2UgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoYXJyKSkgeyByZXR1cm4gc2xpY2VJdGVyYXRvcihhcnIsIGkpOyB9IGVsc2UgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlJyk7IH0gfTsgfSkoKTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gyLCBfeDMsIF94NCkgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeDIsIHByb3BlcnR5ID0gX3gzLCByZWNlaXZlciA9IF94NDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeDIgPSBwYXJlbnQ7IF94MyA9IHByb3BlcnR5OyBfeDQgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgZGVzYyA9IHBhcmVudCA9IHVuZGVmaW5lZDsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoJ3ZhbHVlJyBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxudmFyIF9UZXRoZXIkVXRpbHMgPSBUZXRoZXIuVXRpbHM7XG52YXIgZXh0ZW5kID0gX1RldGhlciRVdGlscy5leHRlbmQ7XG52YXIgYWRkQ2xhc3MgPSBfVGV0aGVyJFV0aWxzLmFkZENsYXNzO1xudmFyIHJlbW92ZUNsYXNzID0gX1RldGhlciRVdGlscy5yZW1vdmVDbGFzcztcbnZhciBoYXNDbGFzcyA9IF9UZXRoZXIkVXRpbHMuaGFzQ2xhc3M7XG52YXIgRXZlbnRlZCA9IF9UZXRoZXIkVXRpbHMuRXZlbnRlZDtcblxuZnVuY3Rpb24gc29ydEF0dGFjaChzdHIpIHtcbiAgdmFyIF9zdHIkc3BsaXQgPSBzdHIuc3BsaXQoJyAnKTtcblxuICB2YXIgX3N0ciRzcGxpdDIgPSBfc2xpY2VkVG9BcnJheShfc3RyJHNwbGl0LCAyKTtcblxuICB2YXIgZmlyc3QgPSBfc3RyJHNwbGl0MlswXTtcbiAgdmFyIHNlY29uZCA9IF9zdHIkc3BsaXQyWzFdO1xuXG4gIGlmIChbJ2xlZnQnLCAncmlnaHQnXS5pbmRleE9mKGZpcnN0KSA+PSAwKSB7XG4gICAgdmFyIF9yZWYgPSBbc2Vjb25kLCBmaXJzdF07XG4gICAgZmlyc3QgPSBfcmVmWzBdO1xuICAgIHNlY29uZCA9IF9yZWZbMV07XG4gIH1cbiAgcmV0dXJuIFtmaXJzdCwgc2Vjb25kXS5qb2luKCcgJyk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUZyb21BcnJheShhcnIsIGl0ZW0pIHtcbiAgdmFyIGluZGV4ID0gdW5kZWZpbmVkO1xuICB2YXIgcmVzdWx0cyA9IFtdO1xuICB3aGlsZSAoKGluZGV4ID0gYXJyLmluZGV4T2YoaXRlbSkpICE9PSAtMSkge1xuICAgIHJlc3VsdHMucHVzaChhcnIuc3BsaWNlKGluZGV4LCAxKSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59XG5cbnZhciBjbGlja0V2ZW50cyA9IFsnY2xpY2snXTtcbmlmICgnb250b3VjaHN0YXJ0JyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpIHtcbiAgY2xpY2tFdmVudHMucHVzaCgndG91Y2hzdGFydCcpO1xufVxuXG52YXIgdHJhbnNpdGlvbkVuZEV2ZW50cyA9IHtcbiAgJ1dlYmtpdFRyYW5zaXRpb24nOiAnd2Via2l0VHJhbnNpdGlvbkVuZCcsXG4gICdNb3pUcmFuc2l0aW9uJzogJ3RyYW5zaXRpb25lbmQnLFxuICAnT1RyYW5zaXRpb24nOiAnb3RyYW5zaXRpb25lbmQnLFxuICAndHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJ1xufTtcblxudmFyIHRyYW5zaXRpb25FbmRFdmVudCA9ICcnO1xuZm9yICh2YXIgX25hbWUgaW4gdHJhbnNpdGlvbkVuZEV2ZW50cykge1xuICBpZiAoKHt9KS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRyYW5zaXRpb25FbmRFdmVudHMsIF9uYW1lKSkge1xuICAgIHZhciB0ZW1wRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgaWYgKHR5cGVvZiB0ZW1wRWwuc3R5bGVbX25hbWVdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdHJhbnNpdGlvbkVuZEV2ZW50ID0gdHJhbnNpdGlvbkVuZEV2ZW50c1tfbmFtZV07XG4gICAgfVxuICB9XG59XG5cbnZhciBNSVJST1JfQVRUQUNIID0ge1xuICBsZWZ0OiAncmlnaHQnLFxuICByaWdodDogJ2xlZnQnLFxuICB0b3A6ICdib3R0b20nLFxuICBib3R0b206ICd0b3AnLFxuICBtaWRkbGU6ICdtaWRkbGUnLFxuICBjZW50ZXI6ICdjZW50ZXInXG59O1xuXG52YXIgYWxsRHJvcHMgPSB7fTtcblxuLy8gRHJvcCBjYW4gYmUgaW5jbHVkZWQgaW4gZXh0ZXJuYWwgbGlicmFyaWVzLiAgQ2FsbGluZyBjcmVhdGVDb250ZXh0IGdpdmVzIHlvdSBhIGZyZXNoXG4vLyBjb3B5IG9mIGRyb3Agd2hpY2ggd29uJ3QgaW50ZXJhY3Qgd2l0aCBvdGhlciBjb3BpZXMgb24gdGhlIHBhZ2UgKGJleW9uZCBjYWxsaW5nIHRoZSBkb2N1bWVudCBldmVudHMpLlxuXG5mdW5jdGlvbiBjcmVhdGVDb250ZXh0KCkge1xuICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzBdO1xuXG4gIHZhciBkcm9wID0gZnVuY3Rpb24gZHJvcCgpIHtcbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IChfYmluZC5hcHBseShEcm9wSW5zdGFuY2UsIFtudWxsXS5jb25jYXQoYXJncykpKSgpO1xuICB9O1xuXG4gIGV4dGVuZChkcm9wLCB7XG4gICAgY3JlYXRlQ29udGV4dDogY3JlYXRlQ29udGV4dCxcbiAgICBkcm9wczogW10sXG4gICAgZGVmYXVsdHM6IHt9XG4gIH0pO1xuXG4gIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICBjbGFzc1ByZWZpeDogJ2Ryb3AnLFxuICAgIGRlZmF1bHRzOiB7XG4gICAgICBwb3NpdGlvbjogJ2JvdHRvbSBsZWZ0JyxcbiAgICAgIG9wZW5PbjogJ2NsaWNrJyxcbiAgICAgIGJlZm9yZUNsb3NlOiBudWxsLFxuICAgICAgY29uc3RyYWluVG9TY3JvbGxQYXJlbnQ6IHRydWUsXG4gICAgICBjb25zdHJhaW5Ub1dpbmRvdzogdHJ1ZSxcbiAgICAgIGNsYXNzZXM6ICcnLFxuICAgICAgcmVtb3ZlOiBmYWxzZSxcbiAgICAgIG9wZW5EZWxheTogMCxcbiAgICAgIGNsb3NlRGVsYXk6IDUwLFxuICAgICAgLy8gaW5oZXJpdGVkIGZyb20gb3BlbkRlbGF5IGFuZCBjbG9zZURlbGF5IGlmIG5vdCBleHBsaWNpdGx5IGRlZmluZWRcbiAgICAgIGZvY3VzRGVsYXk6IG51bGwsXG4gICAgICBibHVyRGVsYXk6IG51bGwsXG4gICAgICBob3Zlck9wZW5EZWxheTogbnVsbCxcbiAgICAgIGhvdmVyQ2xvc2VEZWxheTogbnVsbCxcbiAgICAgIHRldGhlck9wdGlvbnM6IHt9XG4gICAgfVxuICB9O1xuXG4gIGV4dGVuZChkcm9wLCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG4gIGV4dGVuZChkcm9wLmRlZmF1bHRzLCBkZWZhdWx0T3B0aW9ucy5kZWZhdWx0cywgb3B0aW9ucy5kZWZhdWx0cyk7XG5cbiAgaWYgKHR5cGVvZiBhbGxEcm9wc1tkcm9wLmNsYXNzUHJlZml4XSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBhbGxEcm9wc1tkcm9wLmNsYXNzUHJlZml4XSA9IFtdO1xuICB9XG5cbiAgZHJvcC51cGRhdGVCb2R5Q2xhc3NlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBUaGVyZSBpcyBvbmx5IG9uZSBib2R5LCBzbyBkZXNwaXRlIHRoZSBjb250ZXh0IGNvbmNlcHQsIHdlIHN0aWxsIGl0ZXJhdGUgdGhyb3VnaCBhbGxcbiAgICAvLyBkcm9wcyB3aGljaCBzaGFyZSBvdXIgY2xhc3NQcmVmaXguXG5cbiAgICB2YXIgYW55T3BlbiA9IGZhbHNlO1xuICAgIHZhciBkcm9wcyA9IGFsbERyb3BzW2Ryb3AuY2xhc3NQcmVmaXhdO1xuICAgIHZhciBsZW4gPSBkcm9wcy5sZW5ndGg7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgaWYgKGRyb3BzW2ldLmlzT3BlbmVkKCkpIHtcbiAgICAgICAgYW55T3BlbiA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChhbnlPcGVuKSB7XG4gICAgICBhZGRDbGFzcyhkb2N1bWVudC5ib2R5LCBkcm9wLmNsYXNzUHJlZml4ICsgJy1vcGVuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlbW92ZUNsYXNzKGRvY3VtZW50LmJvZHksIGRyb3AuY2xhc3NQcmVmaXggKyAnLW9wZW4nKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIERyb3BJbnN0YW5jZSA9IChmdW5jdGlvbiAoX0V2ZW50ZWQpIHtcbiAgICBfaW5oZXJpdHMoRHJvcEluc3RhbmNlLCBfRXZlbnRlZCk7XG5cbiAgICBmdW5jdGlvbiBEcm9wSW5zdGFuY2Uob3B0cykge1xuICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERyb3BJbnN0YW5jZSk7XG5cbiAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKERyb3BJbnN0YW5jZS5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKHt9LCBkcm9wLmRlZmF1bHRzLCBvcHRzKTtcbiAgICAgIHRoaXMudGFyZ2V0ID0gdGhpcy5vcHRpb25zLnRhcmdldDtcblxuICAgICAgaWYgKHR5cGVvZiB0aGlzLnRhcmdldCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEcm9wIEVycm9yOiBZb3UgbXVzdCBwcm92aWRlIGEgdGFyZ2V0LicpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGF0YVByZWZpeCA9ICdkYXRhLScgKyBkcm9wLmNsYXNzUHJlZml4O1xuXG4gICAgICB2YXIgY29udGVudEF0dHIgPSB0aGlzLnRhcmdldC5nZXRBdHRyaWJ1dGUoZGF0YVByZWZpeCk7XG4gICAgICBpZiAoY29udGVudEF0dHIgJiYgdGhpcy5vcHRpb25zLmNvbnRlbnQgPT0gbnVsbCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuY29udGVudCA9IGNvbnRlbnRBdHRyO1xuICAgICAgfVxuXG4gICAgICB2YXIgYXR0cnNPdmVycmlkZSA9IFsncG9zaXRpb24nLCAnb3Blbk9uJ107XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGF0dHJzT3ZlcnJpZGUubGVuZ3RoOyArK2kpIHtcblxuICAgICAgICB2YXIgb3ZlcnJpZGUgPSB0aGlzLnRhcmdldC5nZXRBdHRyaWJ1dGUoZGF0YVByZWZpeCArICctJyArIGF0dHJzT3ZlcnJpZGVbaV0pO1xuICAgICAgICBpZiAob3ZlcnJpZGUgJiYgdGhpcy5vcHRpb25zW2F0dHJzT3ZlcnJpZGVbaV1dID09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLm9wdGlvbnNbYXR0cnNPdmVycmlkZVtpXV0gPSBvdmVycmlkZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmNsYXNzZXMgJiYgdGhpcy5vcHRpb25zLmFkZFRhcmdldENsYXNzZXMgIT09IGZhbHNlKSB7XG4gICAgICAgIGFkZENsYXNzKHRoaXMudGFyZ2V0LCB0aGlzLm9wdGlvbnMuY2xhc3Nlcyk7XG4gICAgICB9XG5cbiAgICAgIGRyb3AuZHJvcHMucHVzaCh0aGlzKTtcbiAgICAgIGFsbERyb3BzW2Ryb3AuY2xhc3NQcmVmaXhdLnB1c2godGhpcyk7XG5cbiAgICAgIHRoaXMuX2JvdW5kRXZlbnRzID0gW107XG4gICAgICB0aGlzLmJpbmRNZXRob2RzKCk7XG4gICAgICB0aGlzLnNldHVwRWxlbWVudHMoKTtcbiAgICAgIHRoaXMuc2V0dXBFdmVudHMoKTtcbiAgICAgIHRoaXMuc2V0dXBUZXRoZXIoKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRHJvcEluc3RhbmNlLCBbe1xuICAgICAga2V5OiAnX29uJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb24oZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fYm91bmRFdmVudHMucHVzaCh7IGVsZW1lbnQ6IGVsZW1lbnQsIGV2ZW50OiBldmVudCwgaGFuZGxlcjogaGFuZGxlciB9KTtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICdiaW5kTWV0aG9kcycsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gYmluZE1ldGhvZHMoKSB7XG4gICAgICAgIHRoaXMudHJhbnNpdGlvbkVuZEhhbmRsZXIgPSB0aGlzLl90cmFuc2l0aW9uRW5kSGFuZGxlci5iaW5kKHRoaXMpO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ3NldHVwRWxlbWVudHMnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldHVwRWxlbWVudHMoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5kcm9wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGFkZENsYXNzKHRoaXMuZHJvcCwgZHJvcC5jbGFzc1ByZWZpeCk7XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jbGFzc2VzKSB7XG4gICAgICAgICAgYWRkQ2xhc3ModGhpcy5kcm9wLCB0aGlzLm9wdGlvbnMuY2xhc3Nlcyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgYWRkQ2xhc3ModGhpcy5jb250ZW50LCBkcm9wLmNsYXNzUHJlZml4ICsgJy1jb250ZW50Jyk7XG5cbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMuY29udGVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHZhciBnZW5lcmF0ZUFuZFNldENvbnRlbnQgPSBmdW5jdGlvbiBnZW5lcmF0ZUFuZFNldENvbnRlbnQoKSB7XG4gICAgICAgICAgICAvLyBjb250ZW50IGZ1bmN0aW9uIG1pZ2h0IHJldHVybiBhIHN0cmluZyBvciBhbiBlbGVtZW50XG4gICAgICAgICAgICB2YXIgY29udGVudEVsZW1lbnRPckhUTUwgPSBfdGhpcy5vcHRpb25zLmNvbnRlbnQuY2FsbChfdGhpcywgX3RoaXMpO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnRFbGVtZW50T3JIVE1MID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICBfdGhpcy5jb250ZW50LmlubmVySFRNTCA9IGNvbnRlbnRFbGVtZW50T3JIVE1MO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY29udGVudEVsZW1lbnRPckhUTUwgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgIF90aGlzLmNvbnRlbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgIF90aGlzLmNvbnRlbnQuYXBwZW5kQ2hpbGQoY29udGVudEVsZW1lbnRPckhUTUwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEcm9wIEVycm9yOiBDb250ZW50IGZ1bmN0aW9uIHNob3VsZCByZXR1cm4gYSBzdHJpbmcgb3IgSFRNTEVsZW1lbnQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGdlbmVyYXRlQW5kU2V0Q29udGVudCgpO1xuICAgICAgICAgIHRoaXMub24oJ29wZW4nLCBnZW5lcmF0ZUFuZFNldENvbnRlbnQuYmluZCh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5jb250ZW50ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIHRoaXMuY29udGVudC5hcHBlbmRDaGlsZCh0aGlzLm9wdGlvbnMuY29udGVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5jb250ZW50LmlubmVySFRNTCA9IHRoaXMub3B0aW9ucy5jb250ZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kcm9wLmFwcGVuZENoaWxkKHRoaXMuY29udGVudCk7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnc2V0dXBUZXRoZXInLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldHVwVGV0aGVyKCkge1xuICAgICAgICAvLyBUZXRoZXIgZXhwZWN0cyB0d28gYXR0YWNobWVudCBwb2ludHMsIG9uZSBpbiB0aGUgdGFyZ2V0IGVsZW1lbnQsIG9uZSBpbiB0aGVcbiAgICAgICAgLy8gZHJvcC4gIFdlIHVzZSBhIHNpbmdsZSBvbmUsIGFuZCB1c2UgdGhlIG9yZGVyIGFzIHdlbGwsIHRvIGFsbG93IHVzIHRvIHB1dFxuICAgICAgICAvLyB0aGUgZHJvcCBvbiBlaXRoZXIgc2lkZSBvZiBhbnkgb2YgdGhlIGZvdXIgY29ybmVycy4gIFRoaXMgbWFnaWMgY29udmVydHMgYmV0d2VlblxuICAgICAgICAvLyB0aGUgdHdvOlxuICAgICAgICB2YXIgZHJvcEF0dGFjaCA9IHRoaXMub3B0aW9ucy5wb3NpdGlvbi5zcGxpdCgnICcpO1xuICAgICAgICBkcm9wQXR0YWNoWzBdID0gTUlSUk9SX0FUVEFDSFtkcm9wQXR0YWNoWzBdXTtcbiAgICAgICAgZHJvcEF0dGFjaCA9IGRyb3BBdHRhY2guam9pbignICcpO1xuXG4gICAgICAgIHZhciBjb25zdHJhaW50cyA9IFtdO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNvbnN0cmFpblRvU2Nyb2xsUGFyZW50KSB7XG4gICAgICAgICAgY29uc3RyYWludHMucHVzaCh7XG4gICAgICAgICAgICB0bzogJ3Njcm9sbFBhcmVudCcsXG4gICAgICAgICAgICBwaW46ICd0b3AsIGJvdHRvbScsXG4gICAgICAgICAgICBhdHRhY2htZW50OiAndG9nZXRoZXIgbm9uZSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBUbyBnZXQgJ291dCBvZiBib3VuZHMnIGNsYXNzZXNcbiAgICAgICAgICBjb25zdHJhaW50cy5wdXNoKHtcbiAgICAgICAgICAgIHRvOiAnc2Nyb2xsUGFyZW50J1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jb25zdHJhaW5Ub1dpbmRvdyAhPT0gZmFsc2UpIHtcbiAgICAgICAgICBjb25zdHJhaW50cy5wdXNoKHtcbiAgICAgICAgICAgIHRvOiAnd2luZG93JyxcbiAgICAgICAgICAgIGF0dGFjaG1lbnQ6ICd0b2dldGhlcidcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBUbyBnZXQgJ291dCBvZiBib3VuZHMnIGNsYXNzZXNcbiAgICAgICAgICBjb25zdHJhaW50cy5wdXNoKHtcbiAgICAgICAgICAgIHRvOiAnd2luZG93J1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG9wdHMgPSB7XG4gICAgICAgICAgZWxlbWVudDogdGhpcy5kcm9wLFxuICAgICAgICAgIHRhcmdldDogdGhpcy50YXJnZXQsXG4gICAgICAgICAgYXR0YWNobWVudDogc29ydEF0dGFjaChkcm9wQXR0YWNoKSxcbiAgICAgICAgICB0YXJnZXRBdHRhY2htZW50OiBzb3J0QXR0YWNoKHRoaXMub3B0aW9ucy5wb3NpdGlvbiksXG4gICAgICAgICAgY2xhc3NQcmVmaXg6IGRyb3AuY2xhc3NQcmVmaXgsXG4gICAgICAgICAgb2Zmc2V0OiAnMCAwJyxcbiAgICAgICAgICB0YXJnZXRPZmZzZXQ6ICcwIDAnLFxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgIGNvbnN0cmFpbnRzOiBjb25zdHJhaW50cyxcbiAgICAgICAgICBhZGRUYXJnZXRDbGFzc2VzOiB0aGlzLm9wdGlvbnMuYWRkVGFyZ2V0Q2xhc3Nlc1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMudGV0aGVyT3B0aW9ucyAhPT0gZmFsc2UpIHtcbiAgICAgICAgICB0aGlzLnRldGhlciA9IG5ldyBUZXRoZXIoZXh0ZW5kKHt9LCBvcHRzLCB0aGlzLm9wdGlvbnMudGV0aGVyT3B0aW9ucykpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnc2V0dXBFdmVudHMnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldHVwRXZlbnRzKCkge1xuICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5vcGVuT24pIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLm9wZW5PbiA9PT0gJ2Fsd2F5cycpIHtcbiAgICAgICAgICBzZXRUaW1lb3V0KHRoaXMub3Blbi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZXZlbnRzID0gdGhpcy5vcHRpb25zLm9wZW5Pbi5zcGxpdCgnICcpO1xuXG4gICAgICAgIGlmIChldmVudHMuaW5kZXhPZignY2xpY2snKSA+PSAwKSB7XG4gICAgICAgICAgdmFyIG9wZW5IYW5kbGVyID0gZnVuY3Rpb24gb3BlbkhhbmRsZXIoZXZlbnQpIHtcbiAgICAgICAgICAgIF90aGlzMi50b2dnbGUoZXZlbnQpO1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdmFyIGNsb3NlSGFuZGxlciA9IGZ1bmN0aW9uIGNsb3NlSGFuZGxlcihldmVudCkge1xuICAgICAgICAgICAgaWYgKCFfdGhpczIuaXNPcGVuZWQoKSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENsaWNraW5nIGluc2lkZSBkcm9wZG93blxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gX3RoaXMyLmRyb3AgfHwgX3RoaXMyLmRyb3AuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENsaWNraW5nIHRhcmdldFxuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gX3RoaXMyLnRhcmdldCB8fCBfdGhpczIudGFyZ2V0LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfdGhpczIuY2xvc2UoZXZlbnQpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNsaWNrRXZlbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgY2xpY2tFdmVudCA9IGNsaWNrRXZlbnRzW2ldO1xuICAgICAgICAgICAgdGhpcy5fb24odGhpcy50YXJnZXQsIGNsaWNrRXZlbnQsIG9wZW5IYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMuX29uKGRvY3VtZW50LCBjbGlja0V2ZW50LCBjbG9zZUhhbmRsZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpblRpbWVvdXQgPSBudWxsO1xuICAgICAgICB2YXIgb3V0VGltZW91dCA9IG51bGw7XG5cbiAgICAgICAgdmFyIGluSGFuZGxlciA9IGZ1bmN0aW9uIGluSGFuZGxlcihldmVudCkge1xuICAgICAgICAgIGlmIChvdXRUaW1lb3V0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQob3V0VGltZW91dCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGluVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBfdGhpczIub3BlbihldmVudCk7XG4gICAgICAgICAgICAgIGluVGltZW91dCA9IG51bGw7XG4gICAgICAgICAgICB9LCAoZXZlbnQudHlwZSA9PT0gJ2ZvY3VzJyA/IF90aGlzMi5vcHRpb25zLmZvY3VzRGVsYXkgOiBfdGhpczIub3B0aW9ucy5ob3Zlck9wZW5EZWxheSkgfHwgX3RoaXMyLm9wdGlvbnMub3BlbkRlbGF5KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIG91dEhhbmRsZXIgPSBmdW5jdGlvbiBvdXRIYW5kbGVyKGV2ZW50KSB7XG4gICAgICAgICAgaWYgKGluVGltZW91dCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGluVGltZW91dCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG91dFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgX3RoaXMyLmNsb3NlKGV2ZW50KTtcbiAgICAgICAgICAgICAgb3V0VGltZW91dCA9IG51bGw7XG4gICAgICAgICAgICB9LCAoZXZlbnQudHlwZSA9PT0gJ2JsdXInID8gX3RoaXMyLm9wdGlvbnMuYmx1ckRlbGF5IDogX3RoaXMyLm9wdGlvbnMuaG92ZXJDbG9zZURlbGF5KSB8fCBfdGhpczIub3B0aW9ucy5jbG9zZURlbGF5KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdob3ZlcicpID49IDApIHtcbiAgICAgICAgICB0aGlzLl9vbih0aGlzLnRhcmdldCwgJ21vdXNlb3ZlcicsIGluSGFuZGxlcik7XG4gICAgICAgICAgdGhpcy5fb24odGhpcy5kcm9wLCAnbW91c2VvdmVyJywgaW5IYW5kbGVyKTtcbiAgICAgICAgICB0aGlzLl9vbih0aGlzLnRhcmdldCwgJ21vdXNlb3V0Jywgb3V0SGFuZGxlcik7XG4gICAgICAgICAgdGhpcy5fb24odGhpcy5kcm9wLCAnbW91c2VvdXQnLCBvdXRIYW5kbGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChldmVudHMuaW5kZXhPZignZm9jdXMnKSA+PSAwKSB7XG4gICAgICAgICAgdGhpcy5fb24odGhpcy50YXJnZXQsICdmb2N1cycsIGluSGFuZGxlcik7XG4gICAgICAgICAgdGhpcy5fb24odGhpcy5kcm9wLCAnZm9jdXMnLCBpbkhhbmRsZXIpO1xuICAgICAgICAgIHRoaXMuX29uKHRoaXMudGFyZ2V0LCAnYmx1cicsIG91dEhhbmRsZXIpO1xuICAgICAgICAgIHRoaXMuX29uKHRoaXMuZHJvcCwgJ2JsdXInLCBvdXRIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2lzT3BlbmVkJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc09wZW5lZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZHJvcCkge1xuICAgICAgICAgIHJldHVybiBoYXNDbGFzcyh0aGlzLmRyb3AsIGRyb3AuY2xhc3NQcmVmaXggKyAnLW9wZW4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ3RvZ2dsZScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gdG9nZ2xlKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmlzT3BlbmVkKCkpIHtcbiAgICAgICAgICB0aGlzLmNsb3NlKGV2ZW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm9wZW4oZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnb3BlbicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbihldmVudCkge1xuICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgICAvKiBlc2xpbnQgbm8tdW51c2VkLXZhcnM6IDAgKi9cbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuZWQoKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5kcm9wLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZHJvcCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIHRoaXMudGV0aGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIHRoaXMudGV0aGVyLmVuYWJsZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgYWRkQ2xhc3ModGhpcy5kcm9wLCBkcm9wLmNsYXNzUHJlZml4ICsgJy1vcGVuJyk7XG4gICAgICAgIGFkZENsYXNzKHRoaXMuZHJvcCwgZHJvcC5jbGFzc1ByZWZpeCArICctb3Blbi10cmFuc2l0aW9uZW5kJyk7XG5cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKF90aGlzMy5kcm9wKSB7XG4gICAgICAgICAgICBhZGRDbGFzcyhfdGhpczMuZHJvcCwgZHJvcC5jbGFzc1ByZWZpeCArICctYWZ0ZXItb3BlbicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnRldGhlciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICB0aGlzLnRldGhlci5wb3NpdGlvbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50cmlnZ2VyKCdvcGVuJyk7XG5cbiAgICAgICAgZHJvcC51cGRhdGVCb2R5Q2xhc3NlcygpO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ190cmFuc2l0aW9uRW5kSGFuZGxlcicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gX3RyYW5zaXRpb25FbmRIYW5kbGVyKGUpIHtcbiAgICAgICAgaWYgKGUudGFyZ2V0ICE9PSBlLmN1cnJlbnRUYXJnZXQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWhhc0NsYXNzKHRoaXMuZHJvcCwgZHJvcC5jbGFzc1ByZWZpeCArICctb3BlbicpKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3ModGhpcy5kcm9wLCBkcm9wLmNsYXNzUHJlZml4ICsgJy1vcGVuLXRyYW5zaXRpb25lbmQnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRyb3AucmVtb3ZlRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kRXZlbnQsIHRoaXMudHJhbnNpdGlvbkVuZEhhbmRsZXIpO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2JlZm9yZUNsb3NlSGFuZGxlcicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gYmVmb3JlQ2xvc2VIYW5kbGVyKGV2ZW50KSB7XG4gICAgICAgIHZhciBzaG91bGRDbG9zZSA9IHRydWU7XG5cbiAgICAgICAgaWYgKCF0aGlzLmlzQ2xvc2luZyAmJiB0eXBlb2YgdGhpcy5vcHRpb25zLmJlZm9yZUNsb3NlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgdGhpcy5pc0Nsb3NpbmcgPSB0cnVlO1xuICAgICAgICAgIHNob3VsZENsb3NlID0gdGhpcy5vcHRpb25zLmJlZm9yZUNsb3NlKGV2ZW50LCB0aGlzKSAhPT0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmlzQ2xvc2luZyA9IGZhbHNlO1xuXG4gICAgICAgIHJldHVybiBzaG91bGRDbG9zZTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICdjbG9zZScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvc2UoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzT3BlbmVkKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuYmVmb3JlQ2xvc2VIYW5kbGVyKGV2ZW50KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlbW92ZUNsYXNzKHRoaXMuZHJvcCwgZHJvcC5jbGFzc1ByZWZpeCArICctb3BlbicpO1xuICAgICAgICByZW1vdmVDbGFzcyh0aGlzLmRyb3AsIGRyb3AuY2xhc3NQcmVmaXggKyAnLWFmdGVyLW9wZW4nKTtcblxuICAgICAgICB0aGlzLmRyb3AuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kRXZlbnQsIHRoaXMudHJhbnNpdGlvbkVuZEhhbmRsZXIpO1xuXG4gICAgICAgIHRoaXMudHJpZ2dlcignY2xvc2UnKTtcblxuICAgICAgICBpZiAodHlwZW9mIHRoaXMudGV0aGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIHRoaXMudGV0aGVyLmRpc2FibGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRyb3AudXBkYXRlQm9keUNsYXNzZXMoKTtcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnJlbW92ZSkge1xuICAgICAgICAgIHRoaXMucmVtb3ZlKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ3JlbW92ZScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuY2xvc2UoZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy5kcm9wLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICB0aGlzLmRyb3AucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmRyb3ApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAncG9zaXRpb24nLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBvc2l0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5pc09wZW5lZCgpICYmIHR5cGVvZiB0aGlzLnRldGhlciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICB0aGlzLnRldGhlci5wb3NpdGlvbigpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5yZW1vdmUoKTtcblxuICAgICAgICBpZiAodHlwZW9mIHRoaXMudGV0aGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIHRoaXMudGV0aGVyLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fYm91bmRFdmVudHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICB2YXIgX2JvdW5kRXZlbnRzJGkgPSB0aGlzLl9ib3VuZEV2ZW50c1tpXTtcbiAgICAgICAgICB2YXIgZWxlbWVudCA9IF9ib3VuZEV2ZW50cyRpLmVsZW1lbnQ7XG4gICAgICAgICAgdmFyIF9ldmVudCA9IF9ib3VuZEV2ZW50cyRpLmV2ZW50O1xuICAgICAgICAgIHZhciBoYW5kbGVyID0gX2JvdW5kRXZlbnRzJGkuaGFuZGxlcjtcblxuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihfZXZlbnQsIGhhbmRsZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fYm91bmRFdmVudHMgPSBbXTtcblxuICAgICAgICB0aGlzLnRldGhlciA9IG51bGw7XG4gICAgICAgIHRoaXMuZHJvcCA9IG51bGw7XG4gICAgICAgIHRoaXMuY29udGVudCA9IG51bGw7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcblxuICAgICAgICByZW1vdmVGcm9tQXJyYXkoYWxsRHJvcHNbZHJvcC5jbGFzc1ByZWZpeF0sIHRoaXMpO1xuICAgICAgICByZW1vdmVGcm9tQXJyYXkoZHJvcC5kcm9wcywgdGhpcyk7XG4gICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIERyb3BJbnN0YW5jZTtcbiAgfSkoRXZlbnRlZCk7XG5cbiAgcmV0dXJuIGRyb3A7XG59XG5cbnZhciBEcm9wID0gY3JlYXRlQ29udGV4dCgpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBEcm9wLnVwZGF0ZUJvZHlDbGFzc2VzKCk7XG59KTtcbnJldHVybiBEcm9wO1xuXG59KSk7XG4iLCIvKiEgdGV0aGVyLXRvb2x0aXAgMS4xLjAgKi9cblxuKGZ1bmN0aW9uKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbXCJ0ZXRoZXItZHJvcFwiLFwidGV0aGVyXCJdLCBmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSgndGV0aGVyLWRyb3AnKSwgcmVxdWlyZSgndGV0aGVyJykpO1xuICB9IGVsc2Uge1xuICAgIHJvb3QuVG9vbHRpcCA9IGZhY3Rvcnkocm9vdC5Ecm9wLCByb290LlRldGhlcik7XG4gIH1cbn0odGhpcywgZnVuY3Rpb24oRHJvcCwgVGV0aGVyKSB7XG5cbi8qIGdsb2JhbCBUZXRoZXIgRHJvcCAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXG52YXIgZXh0ZW5kID0gVGV0aGVyLlV0aWxzLmV4dGVuZDtcblxudmFyIF9Ecm9wID0gRHJvcC5jcmVhdGVDb250ZXh0KHtcbiAgY2xhc3NQcmVmaXg6ICd0b29sdGlwJ1xufSk7XG5cbnZhciBkZWZhdWx0cyA9IHtcbiAgcG9zaXRpb246ICd0b3AgY2VudGVyJyxcbiAgb3Blbk9uOiAnaG92ZXInLFxuICBjbGFzc2VzOiAndG9vbHRpcC10aGVtZS1hcnJvd3MnLFxuICBjb25zdHJhaW5Ub1dpbmRvdzogdHJ1ZSxcbiAgY29uc3RyYWluVG9TY3JvbGxQYXJlbnQ6IGZhbHNlXG59O1xuXG52YXIgdG9vbHRpcENvdW50ID0gMDtcblxudmFyIFRvb2x0aXAgPSAoZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBUb29sdGlwKG9wdGlvbnMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVG9vbHRpcCk7XG5cbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMudGFyZ2V0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rvb2x0aXAgRXJyb3I6IFlvdSBtdXN0IHByb3ZpZGUgYSB0YXJnZXQgZm9yIFRvb2x0aXAgdG8gYXR0YWNoIHRvJyk7XG4gICAgfVxuXG4gICAgdmFyIHBvc2l0aW9uID0gdGhpcy5vcHRpb25zLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9vbHRpcC1wb3NpdGlvbicpO1xuICAgIGlmIChwb3NpdGlvbikge1xuICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMucG9zaXRpb24gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBjb250ZW50ID0gdGhpcy5vcHRpb25zLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9vbHRpcCcpO1xuXG4gICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLmNvbnRlbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHZhciBjb250ZW50RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY29udGVudEVsLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cbiAgICAgICAgLy8gQWRkIEFSSUEgYXR0cmlidXRlcyAoc2VlICM1MClcbiAgICAgICAgY29udGVudEVsLnNldEF0dHJpYnV0ZSgncm9sZScsICd0b29sdGlwJyk7XG4gICAgICAgIGNvbnRlbnRFbC5pZCA9ICdkcm9wLXRvb2x0aXAtJyArIHRvb2x0aXBDb3VudDtcbiAgICAgICAgdGhpcy5vcHRpb25zLnRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGVzY3JpYmVkYnknLCBjb250ZW50RWwuaWQpO1xuICAgICAgICB0b29sdGlwQ291bnQgKz0gMTtcblxuICAgICAgICB0aGlzLm9wdGlvbnMuY29udGVudCA9IGNvbnRlbnRFbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXRoaXMub3B0aW9ucy5jb250ZW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rvb2x0aXAgRXJyb3I6IFlvdSBtdXN0IHByb3ZpZGUgY29udGVudCBmb3IgVG9vbHRpcCB0byBkaXNwbGF5Jyk7XG4gICAgfVxuXG4gICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKHt9LCBkZWZhdWx0cywgdGhpcy5vcHRpb25zKTtcblxuICAgIHRoaXMuZHJvcCA9IG5ldyBfRHJvcCh0aGlzLm9wdGlvbnMpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFRvb2x0aXAsIFt7XG4gICAga2V5OiAnY2xvc2UnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgIHRoaXMuZHJvcC5jbG9zZSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ29wZW4nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKCkge1xuICAgICAgdGhpcy5kcm9wLm9wZW4oKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd0b2dnbGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0b2dnbGUoKSB7XG4gICAgICB0aGlzLmRyb3AudG9nZ2xlKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAncmVtb3ZlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgdGhpcy5kcm9wLnJlbW92ZSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgdGhpcy5kcm9wLmRlc3Ryb3koKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdwb3NpdGlvbicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHBvc2l0aW9uKCkge1xuICAgICAgdGhpcy5kcm9wLnBvc2l0aW9uKCk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFRvb2x0aXA7XG59KSgpO1xuXG52YXIgaW5pdGlhbGl6ZWQgPSBbXTtcblxuVG9vbHRpcC5pbml0ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdG9vbHRpcEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdG9vbHRpcF0nKTtcbiAgdmFyIGxlbiA9IHRvb2x0aXBFbGVtZW50cy5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICB2YXIgZWwgPSB0b29sdGlwRWxlbWVudHNbaV07XG4gICAgaWYgKGluaXRpYWxpemVkLmluZGV4T2YoZWwpID09PSAtMSkge1xuICAgICAgbmV3IFRvb2x0aXAoe1xuICAgICAgICB0YXJnZXQ6IGVsXG4gICAgICB9KTtcbiAgICAgIGluaXRpYWxpemVkLnB1c2goZWwpO1xuICAgIH1cbiAgfVxufTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKFRvb2x0aXAuYXV0b2luaXQgIT09IGZhbHNlKSB7XG4gICAgVG9vbHRpcC5pbml0KCk7XG4gIH1cbn0pO1xucmV0dXJuIFRvb2x0aXA7XG5cbn0pKTtcbiIsIi8qISB0ZXRoZXIgMS4zLjEgKi9cblxuKGZ1bmN0aW9uKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlKTtcbiAgfSBlbHNlIHtcbiAgICByb290LlRldGhlciA9IGZhY3RvcnkoKTtcbiAgfVxufSh0aGlzLCBmdW5jdGlvbihyZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUpIHtcblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblxudmFyIFRldGhlckJhc2UgPSB1bmRlZmluZWQ7XG5pZiAodHlwZW9mIFRldGhlckJhc2UgPT09ICd1bmRlZmluZWQnKSB7XG4gIFRldGhlckJhc2UgPSB7IG1vZHVsZXM6IFtdIH07XG59XG5cbnZhciB6ZXJvRWxlbWVudCA9IG51bGw7XG5cbmZ1bmN0aW9uIGdldFNjcm9sbFBhcmVudHMoZWwpIHtcbiAgLy8gSW4gZmlyZWZveCBpZiB0aGUgZWwgaXMgaW5zaWRlIGFuIGlmcmFtZSB3aXRoIGRpc3BsYXk6IG5vbmU7IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCkgd2lsbCByZXR1cm4gbnVsbDtcbiAgLy8gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NTQ4Mzk3XG4gIHZhciBjb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShlbCkgfHwge307XG4gIHZhciBwb3NpdGlvbiA9IGNvbXB1dGVkU3R5bGUucG9zaXRpb247XG4gIHZhciBwYXJlbnRzID0gW107XG5cbiAgaWYgKHBvc2l0aW9uID09PSAnZml4ZWQnKSB7XG4gICAgcmV0dXJuIFtlbF07XG4gIH1cblxuICB2YXIgcGFyZW50ID0gZWw7XG4gIHdoaWxlICgocGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGUpICYmIHBhcmVudCAmJiBwYXJlbnQubm9kZVR5cGUgPT09IDEpIHtcbiAgICB2YXIgc3R5bGUgPSB1bmRlZmluZWQ7XG4gICAgdHJ5IHtcbiAgICAgIHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShwYXJlbnQpO1xuICAgIH0gY2F0Y2ggKGVycikge31cblxuICAgIGlmICh0eXBlb2Ygc3R5bGUgPT09ICd1bmRlZmluZWQnIHx8IHN0eWxlID09PSBudWxsKSB7XG4gICAgICBwYXJlbnRzLnB1c2gocGFyZW50KTtcbiAgICAgIHJldHVybiBwYXJlbnRzO1xuICAgIH1cblxuICAgIHZhciBfc3R5bGUgPSBzdHlsZTtcbiAgICB2YXIgb3ZlcmZsb3cgPSBfc3R5bGUub3ZlcmZsb3c7XG4gICAgdmFyIG92ZXJmbG93WCA9IF9zdHlsZS5vdmVyZmxvd1g7XG4gICAgdmFyIG92ZXJmbG93WSA9IF9zdHlsZS5vdmVyZmxvd1k7XG5cbiAgICBpZiAoLyhhdXRvfHNjcm9sbCkvLnRlc3Qob3ZlcmZsb3cgKyBvdmVyZmxvd1kgKyBvdmVyZmxvd1gpKSB7XG4gICAgICBpZiAocG9zaXRpb24gIT09ICdhYnNvbHV0ZScgfHwgWydyZWxhdGl2ZScsICdhYnNvbHV0ZScsICdmaXhlZCddLmluZGV4T2Yoc3R5bGUucG9zaXRpb24pID49IDApIHtcbiAgICAgICAgcGFyZW50cy5wdXNoKHBhcmVudCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcGFyZW50cy5wdXNoKGRvY3VtZW50LmJvZHkpO1xuICByZXR1cm4gcGFyZW50cztcbn1cblxudmFyIHVuaXF1ZUlkID0gKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGlkID0gMDtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gKytpZDtcbiAgfTtcbn0pKCk7XG5cbnZhciB6ZXJvUG9zQ2FjaGUgPSB7fTtcbnZhciBnZXRPcmlnaW4gPSBmdW5jdGlvbiBnZXRPcmlnaW4oKSB7XG4gIC8vIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBpcyB1bmZvcnR1bmF0ZWx5IHRvbyBhY2N1cmF0ZS4gIEl0IGludHJvZHVjZXMgYSBwaXhlbCBvciB0d28gb2ZcbiAgLy8gaml0dGVyIGFzIHRoZSB1c2VyIHNjcm9sbHMgdGhhdCBtZXNzZXMgd2l0aCBvdXIgYWJpbGl0eSB0byBkZXRlY3QgaWYgdHdvIHBvc2l0aW9uc1xuICAvLyBhcmUgZXF1aXZpbGFudCBvciBub3QuICBXZSBwbGFjZSBhbiBlbGVtZW50IGF0IHRoZSB0b3AgbGVmdCBvZiB0aGUgcGFnZSB0aGF0IHdpbGxcbiAgLy8gZ2V0IHRoZSBzYW1lIGppdHRlciwgc28gd2UgY2FuIGNhbmNlbCB0aGUgdHdvIG91dC5cbiAgdmFyIG5vZGUgPSB6ZXJvRWxlbWVudDtcbiAgaWYgKCFub2RlKSB7XG4gICAgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG5vZGUuc2V0QXR0cmlidXRlKCdkYXRhLXRldGhlci1pZCcsIHVuaXF1ZUlkKCkpO1xuICAgIGV4dGVuZChub2RlLnN0eWxlLCB7XG4gICAgICB0b3A6IDAsXG4gICAgICBsZWZ0OiAwLFxuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZSdcbiAgICB9KTtcblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobm9kZSk7XG5cbiAgICB6ZXJvRWxlbWVudCA9IG5vZGU7XG4gIH1cblxuICB2YXIgaWQgPSBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS10ZXRoZXItaWQnKTtcbiAgaWYgKHR5cGVvZiB6ZXJvUG9zQ2FjaGVbaWRdID09PSAndW5kZWZpbmVkJykge1xuICAgIHplcm9Qb3NDYWNoZVtpZF0gPSB7fTtcblxuICAgIHZhciByZWN0ID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBmb3IgKHZhciBrIGluIHJlY3QpIHtcbiAgICAgIC8vIENhbid0IHVzZSBleHRlbmQsIGFzIG9uIElFOSwgZWxlbWVudHMgZG9uJ3QgcmVzb2x2ZSB0byBiZSBoYXNPd25Qcm9wZXJ0eVxuICAgICAgemVyb1Bvc0NhY2hlW2lkXVtrXSA9IHJlY3Rba107XG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgdGhlIGNhY2hlIHdoZW4gdGhpcyBwb3NpdGlvbiBjYWxsIGlzIGRvbmVcbiAgICBkZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICBkZWxldGUgemVyb1Bvc0NhY2hlW2lkXTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB6ZXJvUG9zQ2FjaGVbaWRdO1xufTtcblxuZnVuY3Rpb24gcmVtb3ZlVXRpbEVsZW1lbnRzKCkge1xuICBpZiAoemVyb0VsZW1lbnQpIHtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHplcm9FbGVtZW50KTtcbiAgfVxuICB6ZXJvRWxlbWVudCA9IG51bGw7XG59O1xuXG5mdW5jdGlvbiBnZXRCb3VuZHMoZWwpIHtcbiAgdmFyIGRvYyA9IHVuZGVmaW5lZDtcbiAgaWYgKGVsID09PSBkb2N1bWVudCkge1xuICAgIGRvYyA9IGRvY3VtZW50O1xuICAgIGVsID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICB9IGVsc2Uge1xuICAgIGRvYyA9IGVsLm93bmVyRG9jdW1lbnQ7XG4gIH1cblxuICB2YXIgZG9jRWwgPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xuXG4gIHZhciBib3ggPSB7fTtcbiAgLy8gVGhlIG9yaWdpbmFsIG9iamVjdCByZXR1cm5lZCBieSBnZXRCb3VuZGluZ0NsaWVudFJlY3QgaXMgaW1tdXRhYmxlLCBzbyB3ZSBjbG9uZSBpdFxuICAvLyBXZSBjYW4ndCB1c2UgZXh0ZW5kIGJlY2F1c2UgdGhlIHByb3BlcnRpZXMgYXJlIG5vdCBjb25zaWRlcmVkIHBhcnQgb2YgdGhlIG9iamVjdCBieSBoYXNPd25Qcm9wZXJ0eSBpbiBJRTlcbiAgdmFyIHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgZm9yICh2YXIgayBpbiByZWN0KSB7XG4gICAgYm94W2tdID0gcmVjdFtrXTtcbiAgfVxuXG4gIHZhciBvcmlnaW4gPSBnZXRPcmlnaW4oKTtcblxuICBib3gudG9wIC09IG9yaWdpbi50b3A7XG4gIGJveC5sZWZ0IC09IG9yaWdpbi5sZWZ0O1xuXG4gIGlmICh0eXBlb2YgYm94LndpZHRoID09PSAndW5kZWZpbmVkJykge1xuICAgIGJveC53aWR0aCA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsV2lkdGggLSBib3gubGVmdCAtIGJveC5yaWdodDtcbiAgfVxuICBpZiAodHlwZW9mIGJveC5oZWlnaHQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgYm94LmhlaWdodCA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0IC0gYm94LnRvcCAtIGJveC5ib3R0b207XG4gIH1cblxuICBib3gudG9wID0gYm94LnRvcCAtIGRvY0VsLmNsaWVudFRvcDtcbiAgYm94LmxlZnQgPSBib3gubGVmdCAtIGRvY0VsLmNsaWVudExlZnQ7XG4gIGJveC5yaWdodCA9IGRvYy5ib2R5LmNsaWVudFdpZHRoIC0gYm94LndpZHRoIC0gYm94LmxlZnQ7XG4gIGJveC5ib3R0b20gPSBkb2MuYm9keS5jbGllbnRIZWlnaHQgLSBib3guaGVpZ2h0IC0gYm94LnRvcDtcblxuICByZXR1cm4gYm94O1xufVxuXG5mdW5jdGlvbiBnZXRPZmZzZXRQYXJlbnQoZWwpIHtcbiAgcmV0dXJuIGVsLm9mZnNldFBhcmVudCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGdldFNjcm9sbEJhclNpemUoKSB7XG4gIHZhciBpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBpbm5lci5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgaW5uZXIuc3R5bGUuaGVpZ2h0ID0gJzIwMHB4JztcblxuICB2YXIgb3V0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgZXh0ZW5kKG91dGVyLnN0eWxlLCB7XG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgdG9wOiAwLFxuICAgIGxlZnQ6IDAsXG4gICAgcG9pbnRlckV2ZW50czogJ25vbmUnLFxuICAgIHZpc2liaWxpdHk6ICdoaWRkZW4nLFxuICAgIHdpZHRoOiAnMjAwcHgnLFxuICAgIGhlaWdodDogJzE1MHB4JyxcbiAgICBvdmVyZmxvdzogJ2hpZGRlbidcbiAgfSk7XG5cbiAgb3V0ZXIuYXBwZW5kQ2hpbGQoaW5uZXIpO1xuXG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3V0ZXIpO1xuXG4gIHZhciB3aWR0aENvbnRhaW5lZCA9IGlubmVyLm9mZnNldFdpZHRoO1xuICBvdXRlci5zdHlsZS5vdmVyZmxvdyA9ICdzY3JvbGwnO1xuICB2YXIgd2lkdGhTY3JvbGwgPSBpbm5lci5vZmZzZXRXaWR0aDtcblxuICBpZiAod2lkdGhDb250YWluZWQgPT09IHdpZHRoU2Nyb2xsKSB7XG4gICAgd2lkdGhTY3JvbGwgPSBvdXRlci5jbGllbnRXaWR0aDtcbiAgfVxuXG4gIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQob3V0ZXIpO1xuXG4gIHZhciB3aWR0aCA9IHdpZHRoQ29udGFpbmVkIC0gd2lkdGhTY3JvbGw7XG5cbiAgcmV0dXJuIHsgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IHdpZHRoIH07XG59XG5cbmZ1bmN0aW9uIGV4dGVuZCgpIHtcbiAgdmFyIG91dCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzBdO1xuXG4gIHZhciBhcmdzID0gW107XG5cbiAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoYXJncywgYXJndW1lbnRzKTtcblxuICBhcmdzLnNsaWNlKDEpLmZvckVhY2goZnVuY3Rpb24gKG9iaikge1xuICAgIGlmIChvYmopIHtcbiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgaWYgKCh7fSkuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgICAgICBvdXRba2V5XSA9IG9ialtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gb3V0O1xufVxuXG5mdW5jdGlvbiByZW1vdmVDbGFzcyhlbCwgbmFtZSkge1xuICBpZiAodHlwZW9mIGVsLmNsYXNzTGlzdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBuYW1lLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbiAoY2xzKSB7XG4gICAgICBpZiAoY2xzLnRyaW0oKSkge1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKGNscyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCgnKF58ICknICsgbmFtZS5zcGxpdCgnICcpLmpvaW4oJ3wnKSArICcoIHwkKScsICdnaScpO1xuICAgIHZhciBjbGFzc05hbWUgPSBnZXRDbGFzc05hbWUoZWwpLnJlcGxhY2UocmVnZXgsICcgJyk7XG4gICAgc2V0Q2xhc3NOYW1lKGVsLCBjbGFzc05hbWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGFkZENsYXNzKGVsLCBuYW1lKSB7XG4gIGlmICh0eXBlb2YgZWwuY2xhc3NMaXN0ICE9PSAndW5kZWZpbmVkJykge1xuICAgIG5hbWUuc3BsaXQoJyAnKS5mb3JFYWNoKGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgIGlmIChjbHMudHJpbSgpKSB7XG4gICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoY2xzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICByZW1vdmVDbGFzcyhlbCwgbmFtZSk7XG4gICAgdmFyIGNscyA9IGdldENsYXNzTmFtZShlbCkgKyAoJyAnICsgbmFtZSk7XG4gICAgc2V0Q2xhc3NOYW1lKGVsLCBjbHMpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhc0NsYXNzKGVsLCBuYW1lKSB7XG4gIGlmICh0eXBlb2YgZWwuY2xhc3NMaXN0ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBlbC5jbGFzc0xpc3QuY29udGFpbnMobmFtZSk7XG4gIH1cbiAgdmFyIGNsYXNzTmFtZSA9IGdldENsYXNzTmFtZShlbCk7XG4gIHJldHVybiBuZXcgUmVnRXhwKCcoXnwgKScgKyBuYW1lICsgJyggfCQpJywgJ2dpJykudGVzdChjbGFzc05hbWUpO1xufVxuXG5mdW5jdGlvbiBnZXRDbGFzc05hbWUoZWwpIHtcbiAgaWYgKGVsLmNsYXNzTmFtZSBpbnN0YW5jZW9mIFNWR0FuaW1hdGVkU3RyaW5nKSB7XG4gICAgcmV0dXJuIGVsLmNsYXNzTmFtZS5iYXNlVmFsO1xuICB9XG4gIHJldHVybiBlbC5jbGFzc05hbWU7XG59XG5cbmZ1bmN0aW9uIHNldENsYXNzTmFtZShlbCwgY2xhc3NOYW1lKSB7XG4gIGVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBjbGFzc05hbWUpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVDbGFzc2VzKGVsLCBhZGQsIGFsbCkge1xuICAvLyBPZiB0aGUgc2V0IG9mICdhbGwnIGNsYXNzZXMsIHdlIG5lZWQgdGhlICdhZGQnIGNsYXNzZXMsIGFuZCBvbmx5IHRoZVxuICAvLyAnYWRkJyBjbGFzc2VzIHRvIGJlIHNldC5cbiAgYWxsLmZvckVhY2goZnVuY3Rpb24gKGNscykge1xuICAgIGlmIChhZGQuaW5kZXhPZihjbHMpID09PSAtMSAmJiBoYXNDbGFzcyhlbCwgY2xzKSkge1xuICAgICAgcmVtb3ZlQ2xhc3MoZWwsIGNscyk7XG4gICAgfVxuICB9KTtcblxuICBhZGQuZm9yRWFjaChmdW5jdGlvbiAoY2xzKSB7XG4gICAgaWYgKCFoYXNDbGFzcyhlbCwgY2xzKSkge1xuICAgICAgYWRkQ2xhc3MoZWwsIGNscyk7XG4gICAgfVxuICB9KTtcbn1cblxudmFyIGRlZmVycmVkID0gW107XG5cbnZhciBkZWZlciA9IGZ1bmN0aW9uIGRlZmVyKGZuKSB7XG4gIGRlZmVycmVkLnB1c2goZm4pO1xufTtcblxudmFyIGZsdXNoID0gZnVuY3Rpb24gZmx1c2goKSB7XG4gIHZhciBmbiA9IHVuZGVmaW5lZDtcbiAgd2hpbGUgKGZuID0gZGVmZXJyZWQucG9wKCkpIHtcbiAgICBmbigpO1xuICB9XG59O1xuXG52YXIgRXZlbnRlZCA9IChmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEV2ZW50ZWQoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEV2ZW50ZWQpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEV2ZW50ZWQsIFt7XG4gICAga2V5OiAnb24nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudCwgaGFuZGxlciwgY3R4KSB7XG4gICAgICB2YXIgb25jZSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMyB8fCBhcmd1bWVudHNbM10gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzNdO1xuXG4gICAgICBpZiAodHlwZW9mIHRoaXMuYmluZGluZ3MgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHRoaXMuYmluZGluZ3MgPSB7fTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5iaW5kaW5nc1tldmVudF0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHRoaXMuYmluZGluZ3NbZXZlbnRdID0gW107XG4gICAgICB9XG4gICAgICB0aGlzLmJpbmRpbmdzW2V2ZW50XS5wdXNoKHsgaGFuZGxlcjogaGFuZGxlciwgY3R4OiBjdHgsIG9uY2U6IG9uY2UgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnb25jZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9uY2UoZXZlbnQsIGhhbmRsZXIsIGN0eCkge1xuICAgICAgdGhpcy5vbihldmVudCwgaGFuZGxlciwgY3R4LCB0cnVlKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdvZmYnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnQsIGhhbmRsZXIpIHtcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5iaW5kaW5ncyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHRoaXMuYmluZGluZ3NbZXZlbnRdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuYmluZGluZ3NbZXZlbnRdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB3aGlsZSAoaSA8IHRoaXMuYmluZGluZ3NbZXZlbnRdLmxlbmd0aCkge1xuICAgICAgICAgIGlmICh0aGlzLmJpbmRpbmdzW2V2ZW50XVtpXS5oYW5kbGVyID09PSBoYW5kbGVyKSB7XG4gICAgICAgICAgICB0aGlzLmJpbmRpbmdzW2V2ZW50XS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICsraTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd0cmlnZ2VyJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdHJpZ2dlcihldmVudCkge1xuICAgICAgaWYgKHR5cGVvZiB0aGlzLmJpbmRpbmdzICE9PSAndW5kZWZpbmVkJyAmJiB0aGlzLmJpbmRpbmdzW2V2ZW50XSkge1xuICAgICAgICB2YXIgaSA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICAgIH1cblxuICAgICAgICB3aGlsZSAoaSA8IHRoaXMuYmluZGluZ3NbZXZlbnRdLmxlbmd0aCkge1xuICAgICAgICAgIHZhciBfYmluZGluZ3MkZXZlbnQkaSA9IHRoaXMuYmluZGluZ3NbZXZlbnRdW2ldO1xuICAgICAgICAgIHZhciBoYW5kbGVyID0gX2JpbmRpbmdzJGV2ZW50JGkuaGFuZGxlcjtcbiAgICAgICAgICB2YXIgY3R4ID0gX2JpbmRpbmdzJGV2ZW50JGkuY3R4O1xuICAgICAgICAgIHZhciBvbmNlID0gX2JpbmRpbmdzJGV2ZW50JGkub25jZTtcblxuICAgICAgICAgIHZhciBjb250ZXh0ID0gY3R4O1xuICAgICAgICAgIGlmICh0eXBlb2YgY29udGV4dCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGNvbnRleHQgPSB0aGlzO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGhhbmRsZXIuYXBwbHkoY29udGV4dCwgYXJncyk7XG5cbiAgICAgICAgICBpZiAob25jZSkge1xuICAgICAgICAgICAgdGhpcy5iaW5kaW5nc1tldmVudF0uc3BsaWNlKGksIDEpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICArK2k7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEV2ZW50ZWQ7XG59KSgpO1xuXG5UZXRoZXJCYXNlLlV0aWxzID0ge1xuICBnZXRTY3JvbGxQYXJlbnRzOiBnZXRTY3JvbGxQYXJlbnRzLFxuICBnZXRCb3VuZHM6IGdldEJvdW5kcyxcbiAgZ2V0T2Zmc2V0UGFyZW50OiBnZXRPZmZzZXRQYXJlbnQsXG4gIGV4dGVuZDogZXh0ZW5kLFxuICBhZGRDbGFzczogYWRkQ2xhc3MsXG4gIHJlbW92ZUNsYXNzOiByZW1vdmVDbGFzcyxcbiAgaGFzQ2xhc3M6IGhhc0NsYXNzLFxuICB1cGRhdGVDbGFzc2VzOiB1cGRhdGVDbGFzc2VzLFxuICBkZWZlcjogZGVmZXIsXG4gIGZsdXNoOiBmbHVzaCxcbiAgdW5pcXVlSWQ6IHVuaXF1ZUlkLFxuICBFdmVudGVkOiBFdmVudGVkLFxuICBnZXRTY3JvbGxCYXJTaXplOiBnZXRTY3JvbGxCYXJTaXplLFxuICByZW1vdmVVdGlsRWxlbWVudHM6IHJlbW92ZVV0aWxFbGVtZW50c1xufTtcbi8qIGdsb2JhbHMgVGV0aGVyQmFzZSwgcGVyZm9ybWFuY2UgKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX3NsaWNlZFRvQXJyYXkgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBzbGljZUl0ZXJhdG9yKGFyciwgaSkgeyB2YXIgX2FyciA9IFtdOyB2YXIgX24gPSB0cnVlOyB2YXIgX2QgPSBmYWxzZTsgdmFyIF9lID0gdW5kZWZpbmVkOyB0cnkgeyBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVsncmV0dXJuJ10pIF9pWydyZXR1cm4nXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH0gcmV0dXJuIGZ1bmN0aW9uIChhcnIsIGkpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgeyByZXR1cm4gYXJyOyB9IGVsc2UgaWYgKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoYXJyKSkgeyByZXR1cm4gc2xpY2VJdGVyYXRvcihhcnIsIGkpOyB9IGVsc2UgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlJyk7IH0gfTsgfSkoKTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3g2LCBfeDcsIF94OCkgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeDYsIHByb3BlcnR5ID0gX3g3LCByZWNlaXZlciA9IF94ODsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeDYgPSBwYXJlbnQ7IF94NyA9IHByb3BlcnR5OyBfeDggPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgZGVzYyA9IHBhcmVudCA9IHVuZGVmaW5lZDsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoJ3ZhbHVlJyBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuaWYgKHR5cGVvZiBUZXRoZXJCYXNlID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IGluY2x1ZGUgdGhlIHV0aWxzLmpzIGZpbGUgYmVmb3JlIHRldGhlci5qcycpO1xufVxuXG52YXIgX1RldGhlckJhc2UkVXRpbHMgPSBUZXRoZXJCYXNlLlV0aWxzO1xudmFyIGdldFNjcm9sbFBhcmVudHMgPSBfVGV0aGVyQmFzZSRVdGlscy5nZXRTY3JvbGxQYXJlbnRzO1xudmFyIGdldEJvdW5kcyA9IF9UZXRoZXJCYXNlJFV0aWxzLmdldEJvdW5kcztcbnZhciBnZXRPZmZzZXRQYXJlbnQgPSBfVGV0aGVyQmFzZSRVdGlscy5nZXRPZmZzZXRQYXJlbnQ7XG52YXIgZXh0ZW5kID0gX1RldGhlckJhc2UkVXRpbHMuZXh0ZW5kO1xudmFyIGFkZENsYXNzID0gX1RldGhlckJhc2UkVXRpbHMuYWRkQ2xhc3M7XG52YXIgcmVtb3ZlQ2xhc3MgPSBfVGV0aGVyQmFzZSRVdGlscy5yZW1vdmVDbGFzcztcbnZhciB1cGRhdGVDbGFzc2VzID0gX1RldGhlckJhc2UkVXRpbHMudXBkYXRlQ2xhc3NlcztcbnZhciBkZWZlciA9IF9UZXRoZXJCYXNlJFV0aWxzLmRlZmVyO1xudmFyIGZsdXNoID0gX1RldGhlckJhc2UkVXRpbHMuZmx1c2g7XG52YXIgZ2V0U2Nyb2xsQmFyU2l6ZSA9IF9UZXRoZXJCYXNlJFV0aWxzLmdldFNjcm9sbEJhclNpemU7XG52YXIgcmVtb3ZlVXRpbEVsZW1lbnRzID0gX1RldGhlckJhc2UkVXRpbHMucmVtb3ZlVXRpbEVsZW1lbnRzO1xuXG5mdW5jdGlvbiB3aXRoaW4oYSwgYikge1xuICB2YXIgZGlmZiA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IDEgOiBhcmd1bWVudHNbMl07XG5cbiAgcmV0dXJuIGEgKyBkaWZmID49IGIgJiYgYiA+PSBhIC0gZGlmZjtcbn1cblxudmFyIHRyYW5zZm9ybUtleSA9IChmdW5jdGlvbiAoKSB7XG4gIGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gIHZhciB0cmFuc2Zvcm1zID0gWyd0cmFuc2Zvcm0nLCAnd2Via2l0VHJhbnNmb3JtJywgJ09UcmFuc2Zvcm0nLCAnTW96VHJhbnNmb3JtJywgJ21zVHJhbnNmb3JtJ107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdHJhbnNmb3Jtcy5sZW5ndGg7ICsraSkge1xuICAgIHZhciBrZXkgPSB0cmFuc2Zvcm1zW2ldO1xuICAgIGlmIChlbC5zdHlsZVtrZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBrZXk7XG4gICAgfVxuICB9XG59KSgpO1xuXG52YXIgdGV0aGVycyA9IFtdO1xuXG52YXIgcG9zaXRpb24gPSBmdW5jdGlvbiBwb3NpdGlvbigpIHtcbiAgdGV0aGVycy5mb3JFYWNoKGZ1bmN0aW9uICh0ZXRoZXIpIHtcbiAgICB0ZXRoZXIucG9zaXRpb24oZmFsc2UpO1xuICB9KTtcbiAgZmx1c2goKTtcbn07XG5cbmZ1bmN0aW9uIG5vdygpIHtcbiAgaWYgKHR5cGVvZiBwZXJmb3JtYW5jZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHBlcmZvcm1hbmNlLm5vdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gcGVyZm9ybWFuY2Uubm93KCk7XG4gIH1cbiAgcmV0dXJuICtuZXcgRGF0ZSgpO1xufVxuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgbGFzdENhbGwgPSBudWxsO1xuICB2YXIgbGFzdER1cmF0aW9uID0gbnVsbDtcbiAgdmFyIHBlbmRpbmdUaW1lb3V0ID0gbnVsbDtcblxuICB2YXIgdGljayA9IGZ1bmN0aW9uIHRpY2soKSB7XG4gICAgaWYgKHR5cGVvZiBsYXN0RHVyYXRpb24gIT09ICd1bmRlZmluZWQnICYmIGxhc3REdXJhdGlvbiA+IDE2KSB7XG4gICAgICAvLyBXZSB2b2x1bnRhcmlseSB0aHJvdHRsZSBvdXJzZWx2ZXMgaWYgd2UgY2FuJ3QgbWFuYWdlIDYwZnBzXG4gICAgICBsYXN0RHVyYXRpb24gPSBNYXRoLm1pbihsYXN0RHVyYXRpb24gLSAxNiwgMjUwKTtcblxuICAgICAgLy8gSnVzdCBpbiBjYXNlIHRoaXMgaXMgdGhlIGxhc3QgZXZlbnQsIHJlbWVtYmVyIHRvIHBvc2l0aW9uIGp1c3Qgb25jZSBtb3JlXG4gICAgICBwZW5kaW5nVGltZW91dCA9IHNldFRpbWVvdXQodGljaywgMjUwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGxhc3RDYWxsICE9PSAndW5kZWZpbmVkJyAmJiBub3coKSAtIGxhc3RDYWxsIDwgMTApIHtcbiAgICAgIC8vIFNvbWUgYnJvd3NlcnMgY2FsbCBldmVudHMgYSBsaXR0bGUgdG9vIGZyZXF1ZW50bHksIHJlZnVzZSB0byBydW4gbW9yZSB0aGFuIGlzIHJlYXNvbmFibGVcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAocGVuZGluZ1RpbWVvdXQgIT0gbnVsbCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHBlbmRpbmdUaW1lb3V0KTtcbiAgICAgIHBlbmRpbmdUaW1lb3V0ID0gbnVsbDtcbiAgICB9XG5cbiAgICBsYXN0Q2FsbCA9IG5vdygpO1xuICAgIHBvc2l0aW9uKCk7XG4gICAgbGFzdER1cmF0aW9uID0gbm93KCkgLSBsYXN0Q2FsbDtcbiAgfTtcblxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIFsncmVzaXplJywgJ3Njcm9sbCcsICd0b3VjaG1vdmUnXS5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIHRpY2spO1xuICAgIH0pO1xuICB9XG59KSgpO1xuXG52YXIgTUlSUk9SX0xSID0ge1xuICBjZW50ZXI6ICdjZW50ZXInLFxuICBsZWZ0OiAncmlnaHQnLFxuICByaWdodDogJ2xlZnQnXG59O1xuXG52YXIgTUlSUk9SX1RCID0ge1xuICBtaWRkbGU6ICdtaWRkbGUnLFxuICB0b3A6ICdib3R0b20nLFxuICBib3R0b206ICd0b3AnXG59O1xuXG52YXIgT0ZGU0VUX01BUCA9IHtcbiAgdG9wOiAwLFxuICBsZWZ0OiAwLFxuICBtaWRkbGU6ICc1MCUnLFxuICBjZW50ZXI6ICc1MCUnLFxuICBib3R0b206ICcxMDAlJyxcbiAgcmlnaHQ6ICcxMDAlJ1xufTtcblxudmFyIGF1dG9Ub0ZpeGVkQXR0YWNobWVudCA9IGZ1bmN0aW9uIGF1dG9Ub0ZpeGVkQXR0YWNobWVudChhdHRhY2htZW50LCByZWxhdGl2ZVRvQXR0YWNobWVudCkge1xuICB2YXIgbGVmdCA9IGF0dGFjaG1lbnQubGVmdDtcbiAgdmFyIHRvcCA9IGF0dGFjaG1lbnQudG9wO1xuXG4gIGlmIChsZWZ0ID09PSAnYXV0bycpIHtcbiAgICBsZWZ0ID0gTUlSUk9SX0xSW3JlbGF0aXZlVG9BdHRhY2htZW50LmxlZnRdO1xuICB9XG5cbiAgaWYgKHRvcCA9PT0gJ2F1dG8nKSB7XG4gICAgdG9wID0gTUlSUk9SX1RCW3JlbGF0aXZlVG9BdHRhY2htZW50LnRvcF07XG4gIH1cblxuICByZXR1cm4geyBsZWZ0OiBsZWZ0LCB0b3A6IHRvcCB9O1xufTtcblxudmFyIGF0dGFjaG1lbnRUb09mZnNldCA9IGZ1bmN0aW9uIGF0dGFjaG1lbnRUb09mZnNldChhdHRhY2htZW50KSB7XG4gIHZhciBsZWZ0ID0gYXR0YWNobWVudC5sZWZ0O1xuICB2YXIgdG9wID0gYXR0YWNobWVudC50b3A7XG5cbiAgaWYgKHR5cGVvZiBPRkZTRVRfTUFQW2F0dGFjaG1lbnQubGVmdF0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbGVmdCA9IE9GRlNFVF9NQVBbYXR0YWNobWVudC5sZWZ0XTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgT0ZGU0VUX01BUFthdHRhY2htZW50LnRvcF0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdG9wID0gT0ZGU0VUX01BUFthdHRhY2htZW50LnRvcF07XG4gIH1cblxuICByZXR1cm4geyBsZWZ0OiBsZWZ0LCB0b3A6IHRvcCB9O1xufTtcblxuZnVuY3Rpb24gYWRkT2Zmc2V0KCkge1xuICB2YXIgb3V0ID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcblxuICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgb2Zmc2V0cyA9IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIG9mZnNldHNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICBvZmZzZXRzLmZvckVhY2goZnVuY3Rpb24gKF9yZWYpIHtcbiAgICB2YXIgdG9wID0gX3JlZi50b3A7XG4gICAgdmFyIGxlZnQgPSBfcmVmLmxlZnQ7XG5cbiAgICBpZiAodHlwZW9mIHRvcCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRvcCA9IHBhcnNlRmxvYXQodG9wLCAxMCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgbGVmdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGxlZnQgPSBwYXJzZUZsb2F0KGxlZnQsIDEwKTtcbiAgICB9XG5cbiAgICBvdXQudG9wICs9IHRvcDtcbiAgICBvdXQubGVmdCArPSBsZWZ0O1xuICB9KTtcblxuICByZXR1cm4gb3V0O1xufVxuXG5mdW5jdGlvbiBvZmZzZXRUb1B4KG9mZnNldCwgc2l6ZSkge1xuICBpZiAodHlwZW9mIG9mZnNldC5sZWZ0ID09PSAnc3RyaW5nJyAmJiBvZmZzZXQubGVmdC5pbmRleE9mKCclJykgIT09IC0xKSB7XG4gICAgb2Zmc2V0LmxlZnQgPSBwYXJzZUZsb2F0KG9mZnNldC5sZWZ0LCAxMCkgLyAxMDAgKiBzaXplLndpZHRoO1xuICB9XG4gIGlmICh0eXBlb2Ygb2Zmc2V0LnRvcCA9PT0gJ3N0cmluZycgJiYgb2Zmc2V0LnRvcC5pbmRleE9mKCclJykgIT09IC0xKSB7XG4gICAgb2Zmc2V0LnRvcCA9IHBhcnNlRmxvYXQob2Zmc2V0LnRvcCwgMTApIC8gMTAwICogc2l6ZS5oZWlnaHQ7XG4gIH1cblxuICByZXR1cm4gb2Zmc2V0O1xufVxuXG52YXIgcGFyc2VPZmZzZXQgPSBmdW5jdGlvbiBwYXJzZU9mZnNldCh2YWx1ZSkge1xuICB2YXIgX3ZhbHVlJHNwbGl0ID0gdmFsdWUuc3BsaXQoJyAnKTtcblxuICB2YXIgX3ZhbHVlJHNwbGl0MiA9IF9zbGljZWRUb0FycmF5KF92YWx1ZSRzcGxpdCwgMik7XG5cbiAgdmFyIHRvcCA9IF92YWx1ZSRzcGxpdDJbMF07XG4gIHZhciBsZWZ0ID0gX3ZhbHVlJHNwbGl0MlsxXTtcblxuICByZXR1cm4geyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9O1xufTtcbnZhciBwYXJzZUF0dGFjaG1lbnQgPSBwYXJzZU9mZnNldDtcblxudmFyIFRldGhlckNsYXNzID0gKGZ1bmN0aW9uIChfRXZlbnRlZCkge1xuICBfaW5oZXJpdHMoVGV0aGVyQ2xhc3MsIF9FdmVudGVkKTtcblxuICBmdW5jdGlvbiBUZXRoZXJDbGFzcyhvcHRpb25zKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUZXRoZXJDbGFzcyk7XG5cbiAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihUZXRoZXJDbGFzcy5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgIHRoaXMucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uLmJpbmQodGhpcyk7XG5cbiAgICB0ZXRoZXJzLnB1c2godGhpcyk7XG5cbiAgICB0aGlzLmhpc3RvcnkgPSBbXTtcblxuICAgIHRoaXMuc2V0T3B0aW9ucyhvcHRpb25zLCBmYWxzZSk7XG5cbiAgICBUZXRoZXJCYXNlLm1vZHVsZXMuZm9yRWFjaChmdW5jdGlvbiAobW9kdWxlKSB7XG4gICAgICBpZiAodHlwZW9mIG1vZHVsZS5pbml0aWFsaXplICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBtb2R1bGUuaW5pdGlhbGl6ZS5jYWxsKF90aGlzKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMucG9zaXRpb24oKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhUZXRoZXJDbGFzcywgW3tcbiAgICBrZXk6ICdnZXRDbGFzcycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldENsYXNzKCkge1xuICAgICAgdmFyIGtleSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/ICcnIDogYXJndW1lbnRzWzBdO1xuICAgICAgdmFyIGNsYXNzZXMgPSB0aGlzLm9wdGlvbnMuY2xhc3NlcztcblxuICAgICAgaWYgKHR5cGVvZiBjbGFzc2VzICE9PSAndW5kZWZpbmVkJyAmJiBjbGFzc2VzW2tleV0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5jbGFzc2VzW2tleV07XG4gICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5jbGFzc1ByZWZpeCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmNsYXNzUHJlZml4ICsgJy0nICsga2V5O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdzZXRPcHRpb25zJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0T3B0aW9ucyhvcHRpb25zKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIHBvcyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHRydWUgOiBhcmd1bWVudHNbMV07XG5cbiAgICAgIHZhciBkZWZhdWx0cyA9IHtcbiAgICAgICAgb2Zmc2V0OiAnMCAwJyxcbiAgICAgICAgdGFyZ2V0T2Zmc2V0OiAnMCAwJyxcbiAgICAgICAgdGFyZ2V0QXR0YWNobWVudDogJ2F1dG8gYXV0bycsXG4gICAgICAgIGNsYXNzUHJlZml4OiAndGV0aGVyJ1xuICAgICAgfTtcblxuICAgICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKGRlZmF1bHRzLCBvcHRpb25zKTtcblxuICAgICAgdmFyIF9vcHRpb25zID0gdGhpcy5vcHRpb25zO1xuICAgICAgdmFyIGVsZW1lbnQgPSBfb3B0aW9ucy5lbGVtZW50O1xuICAgICAgdmFyIHRhcmdldCA9IF9vcHRpb25zLnRhcmdldDtcbiAgICAgIHZhciB0YXJnZXRNb2RpZmllciA9IF9vcHRpb25zLnRhcmdldE1vZGlmaWVyO1xuXG4gICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICB0aGlzLnRhcmdldE1vZGlmaWVyID0gdGFyZ2V0TW9kaWZpZXI7XG5cbiAgICAgIGlmICh0aGlzLnRhcmdldCA9PT0gJ3ZpZXdwb3J0Jykge1xuICAgICAgICB0aGlzLnRhcmdldCA9IGRvY3VtZW50LmJvZHk7XG4gICAgICAgIHRoaXMudGFyZ2V0TW9kaWZpZXIgPSAndmlzaWJsZSc7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudGFyZ2V0ID09PSAnc2Nyb2xsLWhhbmRsZScpIHtcbiAgICAgICAgdGhpcy50YXJnZXQgPSBkb2N1bWVudC5ib2R5O1xuICAgICAgICB0aGlzLnRhcmdldE1vZGlmaWVyID0gJ3Njcm9sbC1oYW5kbGUnO1xuICAgICAgfVxuXG4gICAgICBbJ2VsZW1lbnQnLCAndGFyZ2V0J10uZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIGlmICh0eXBlb2YgX3RoaXMyW2tleV0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUZXRoZXIgRXJyb3I6IEJvdGggZWxlbWVudCBhbmQgdGFyZ2V0IG11c3QgYmUgZGVmaW5lZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZiBfdGhpczJba2V5XS5qcXVlcnkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgX3RoaXMyW2tleV0gPSBfdGhpczJba2V5XVswXTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgX3RoaXMyW2tleV0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgX3RoaXMyW2tleV0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKF90aGlzMltrZXldKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGFkZENsYXNzKHRoaXMuZWxlbWVudCwgdGhpcy5nZXRDbGFzcygnZWxlbWVudCcpKTtcbiAgICAgIGlmICghKHRoaXMub3B0aW9ucy5hZGRUYXJnZXRDbGFzc2VzID09PSBmYWxzZSkpIHtcbiAgICAgICAgYWRkQ2xhc3ModGhpcy50YXJnZXQsIHRoaXMuZ2V0Q2xhc3MoJ3RhcmdldCcpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuYXR0YWNobWVudCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RldGhlciBFcnJvcjogWW91IG11c3QgcHJvdmlkZSBhbiBhdHRhY2htZW50Jyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMudGFyZ2V0QXR0YWNobWVudCA9IHBhcnNlQXR0YWNobWVudCh0aGlzLm9wdGlvbnMudGFyZ2V0QXR0YWNobWVudCk7XG4gICAgICB0aGlzLmF0dGFjaG1lbnQgPSBwYXJzZUF0dGFjaG1lbnQodGhpcy5vcHRpb25zLmF0dGFjaG1lbnQpO1xuICAgICAgdGhpcy5vZmZzZXQgPSBwYXJzZU9mZnNldCh0aGlzLm9wdGlvbnMub2Zmc2V0KTtcbiAgICAgIHRoaXMudGFyZ2V0T2Zmc2V0ID0gcGFyc2VPZmZzZXQodGhpcy5vcHRpb25zLnRhcmdldE9mZnNldCk7XG5cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5zY3JvbGxQYXJlbnRzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aGlzLmRpc2FibGUoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMudGFyZ2V0TW9kaWZpZXIgPT09ICdzY3JvbGwtaGFuZGxlJykge1xuICAgICAgICB0aGlzLnNjcm9sbFBhcmVudHMgPSBbdGhpcy50YXJnZXRdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zY3JvbGxQYXJlbnRzID0gZ2V0U2Nyb2xsUGFyZW50cyh0aGlzLnRhcmdldCk7XG4gICAgICB9XG5cbiAgICAgIGlmICghKHRoaXMub3B0aW9ucy5lbmFibGVkID09PSBmYWxzZSkpIHtcbiAgICAgICAgdGhpcy5lbmFibGUocG9zKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdnZXRUYXJnZXRCb3VuZHMnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUYXJnZXRCb3VuZHMoKSB7XG4gICAgICBpZiAodHlwZW9mIHRoaXMudGFyZ2V0TW9kaWZpZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldE1vZGlmaWVyID09PSAndmlzaWJsZScpIHtcbiAgICAgICAgICBpZiAodGhpcy50YXJnZXQgPT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHRvcDogcGFnZVlPZmZzZXQsIGxlZnQ6IHBhZ2VYT2Zmc2V0LCBoZWlnaHQ6IGlubmVySGVpZ2h0LCB3aWR0aDogaW5uZXJXaWR0aCB9O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgYm91bmRzID0gZ2V0Qm91bmRzKHRoaXMudGFyZ2V0KTtcblxuICAgICAgICAgICAgdmFyIG91dCA9IHtcbiAgICAgICAgICAgICAgaGVpZ2h0OiBib3VuZHMuaGVpZ2h0LFxuICAgICAgICAgICAgICB3aWR0aDogYm91bmRzLndpZHRoLFxuICAgICAgICAgICAgICB0b3A6IGJvdW5kcy50b3AsXG4gICAgICAgICAgICAgIGxlZnQ6IGJvdW5kcy5sZWZ0XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBvdXQuaGVpZ2h0ID0gTWF0aC5taW4ob3V0LmhlaWdodCwgYm91bmRzLmhlaWdodCAtIChwYWdlWU9mZnNldCAtIGJvdW5kcy50b3ApKTtcbiAgICAgICAgICAgIG91dC5oZWlnaHQgPSBNYXRoLm1pbihvdXQuaGVpZ2h0LCBib3VuZHMuaGVpZ2h0IC0gKGJvdW5kcy50b3AgKyBib3VuZHMuaGVpZ2h0IC0gKHBhZ2VZT2Zmc2V0ICsgaW5uZXJIZWlnaHQpKSk7XG4gICAgICAgICAgICBvdXQuaGVpZ2h0ID0gTWF0aC5taW4oaW5uZXJIZWlnaHQsIG91dC5oZWlnaHQpO1xuICAgICAgICAgICAgb3V0LmhlaWdodCAtPSAyO1xuXG4gICAgICAgICAgICBvdXQud2lkdGggPSBNYXRoLm1pbihvdXQud2lkdGgsIGJvdW5kcy53aWR0aCAtIChwYWdlWE9mZnNldCAtIGJvdW5kcy5sZWZ0KSk7XG4gICAgICAgICAgICBvdXQud2lkdGggPSBNYXRoLm1pbihvdXQud2lkdGgsIGJvdW5kcy53aWR0aCAtIChib3VuZHMubGVmdCArIGJvdW5kcy53aWR0aCAtIChwYWdlWE9mZnNldCArIGlubmVyV2lkdGgpKSk7XG4gICAgICAgICAgICBvdXQud2lkdGggPSBNYXRoLm1pbihpbm5lcldpZHRoLCBvdXQud2lkdGgpO1xuICAgICAgICAgICAgb3V0LndpZHRoIC09IDI7XG5cbiAgICAgICAgICAgIGlmIChvdXQudG9wIDwgcGFnZVlPZmZzZXQpIHtcbiAgICAgICAgICAgICAgb3V0LnRvcCA9IHBhZ2VZT2Zmc2V0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG91dC5sZWZ0IDwgcGFnZVhPZmZzZXQpIHtcbiAgICAgICAgICAgICAgb3V0LmxlZnQgPSBwYWdlWE9mZnNldDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy50YXJnZXRNb2RpZmllciA9PT0gJ3Njcm9sbC1oYW5kbGUnKSB7XG4gICAgICAgICAgdmFyIGJvdW5kcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXQ7XG4gICAgICAgICAgaWYgKHRhcmdldCA9PT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgdGFyZ2V0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgICAgICAgICBib3VuZHMgPSB7XG4gICAgICAgICAgICAgIGxlZnQ6IHBhZ2VYT2Zmc2V0LFxuICAgICAgICAgICAgICB0b3A6IHBhZ2VZT2Zmc2V0LFxuICAgICAgICAgICAgICBoZWlnaHQ6IGlubmVySGVpZ2h0LFxuICAgICAgICAgICAgICB3aWR0aDogaW5uZXJXaWR0aFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYm91bmRzID0gZ2V0Qm91bmRzKHRhcmdldCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YXJnZXQpO1xuXG4gICAgICAgICAgdmFyIGhhc0JvdHRvbVNjcm9sbCA9IHRhcmdldC5zY3JvbGxXaWR0aCA+IHRhcmdldC5jbGllbnRXaWR0aCB8fCBbc3R5bGUub3ZlcmZsb3csIHN0eWxlLm92ZXJmbG93WF0uaW5kZXhPZignc2Nyb2xsJykgPj0gMCB8fCB0aGlzLnRhcmdldCAhPT0gZG9jdW1lbnQuYm9keTtcblxuICAgICAgICAgIHZhciBzY3JvbGxCb3R0b20gPSAwO1xuICAgICAgICAgIGlmIChoYXNCb3R0b21TY3JvbGwpIHtcbiAgICAgICAgICAgIHNjcm9sbEJvdHRvbSA9IDE1O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBoZWlnaHQgPSBib3VuZHMuaGVpZ2h0IC0gcGFyc2VGbG9hdChzdHlsZS5ib3JkZXJUb3BXaWR0aCkgLSBwYXJzZUZsb2F0KHN0eWxlLmJvcmRlckJvdHRvbVdpZHRoKSAtIHNjcm9sbEJvdHRvbTtcblxuICAgICAgICAgIHZhciBvdXQgPSB7XG4gICAgICAgICAgICB3aWR0aDogMTUsXG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCAqIDAuOTc1ICogKGhlaWdodCAvIHRhcmdldC5zY3JvbGxIZWlnaHQpLFxuICAgICAgICAgICAgbGVmdDogYm91bmRzLmxlZnQgKyBib3VuZHMud2lkdGggLSBwYXJzZUZsb2F0KHN0eWxlLmJvcmRlckxlZnRXaWR0aCkgLSAxNVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICB2YXIgZml0QWRqID0gMDtcbiAgICAgICAgICBpZiAoaGVpZ2h0IDwgNDA4ICYmIHRoaXMudGFyZ2V0ID09PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICBmaXRBZGogPSAtMC4wMDAxMSAqIE1hdGgucG93KGhlaWdodCwgMikgLSAwLjAwNzI3ICogaGVpZ2h0ICsgMjIuNTg7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMudGFyZ2V0ICE9PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICBvdXQuaGVpZ2h0ID0gTWF0aC5tYXgob3V0LmhlaWdodCwgMjQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBzY3JvbGxQZXJjZW50YWdlID0gdGhpcy50YXJnZXQuc2Nyb2xsVG9wIC8gKHRhcmdldC5zY3JvbGxIZWlnaHQgLSBoZWlnaHQpO1xuICAgICAgICAgIG91dC50b3AgPSBzY3JvbGxQZXJjZW50YWdlICogKGhlaWdodCAtIG91dC5oZWlnaHQgLSBmaXRBZGopICsgYm91bmRzLnRvcCArIHBhcnNlRmxvYXQoc3R5bGUuYm9yZGVyVG9wV2lkdGgpO1xuXG4gICAgICAgICAgaWYgKHRoaXMudGFyZ2V0ID09PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICBvdXQuaGVpZ2h0ID0gTWF0aC5tYXgob3V0LmhlaWdodCwgMjQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBnZXRCb3VuZHModGhpcy50YXJnZXQpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2NsZWFyQ2FjaGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckNhY2hlKCkge1xuICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdjYWNoZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNhY2hlKGssIGdldHRlcikge1xuICAgICAgLy8gTW9yZSB0aGFuIG9uZSBtb2R1bGUgd2lsbCBvZnRlbiBuZWVkIHRoZSBzYW1lIERPTSBpbmZvLCBzb1xuICAgICAgLy8gd2Uga2VlcCBhIGNhY2hlIHdoaWNoIGlzIGNsZWFyZWQgb24gZWFjaCBwb3NpdGlvbiBjYWxsXG4gICAgICBpZiAodHlwZW9mIHRoaXMuX2NhY2hlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aGlzLl9jYWNoZSA9IHt9O1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIHRoaXMuX2NhY2hlW2tdID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aGlzLl9jYWNoZVtrXSA9IGdldHRlci5jYWxsKHRoaXMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5fY2FjaGVba107XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnZW5hYmxlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZW5hYmxlKCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHZhciBwb3MgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB0cnVlIDogYXJndW1lbnRzWzBdO1xuXG4gICAgICBpZiAoISh0aGlzLm9wdGlvbnMuYWRkVGFyZ2V0Q2xhc3NlcyA9PT0gZmFsc2UpKSB7XG4gICAgICAgIGFkZENsYXNzKHRoaXMudGFyZ2V0LCB0aGlzLmdldENsYXNzKCdlbmFibGVkJykpO1xuICAgICAgfVxuICAgICAgYWRkQ2xhc3ModGhpcy5lbGVtZW50LCB0aGlzLmdldENsYXNzKCdlbmFibGVkJykpO1xuICAgICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcblxuICAgICAgdGhpcy5zY3JvbGxQYXJlbnRzLmZvckVhY2goZnVuY3Rpb24gKHBhcmVudCkge1xuICAgICAgICBpZiAocGFyZW50ICE9PSBkb2N1bWVudCkge1xuICAgICAgICAgIHBhcmVudC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBfdGhpczMucG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKHBvcykge1xuICAgICAgICB0aGlzLnBvc2l0aW9uKCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnZGlzYWJsZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgcmVtb3ZlQ2xhc3ModGhpcy50YXJnZXQsIHRoaXMuZ2V0Q2xhc3MoJ2VuYWJsZWQnKSk7XG4gICAgICByZW1vdmVDbGFzcyh0aGlzLmVsZW1lbnQsIHRoaXMuZ2V0Q2xhc3MoJ2VuYWJsZWQnKSk7XG4gICAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcblxuICAgICAgaWYgKHR5cGVvZiB0aGlzLnNjcm9sbFBhcmVudHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHRoaXMuc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJlbnQpIHtcbiAgICAgICAgICBwYXJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgX3RoaXM0LnBvc2l0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnZGVzdHJveScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgdGhpcy5kaXNhYmxlKCk7XG5cbiAgICAgIHRldGhlcnMuZm9yRWFjaChmdW5jdGlvbiAodGV0aGVyLCBpKSB7XG4gICAgICAgIGlmICh0ZXRoZXIgPT09IF90aGlzNSkge1xuICAgICAgICAgIHRldGhlcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gUmVtb3ZlIGFueSBlbGVtZW50cyB3ZSB3ZXJlIHVzaW5nIGZvciBjb252ZW5pZW5jZSBmcm9tIHRoZSBET01cbiAgICAgIGlmICh0ZXRoZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZW1vdmVVdGlsRWxlbWVudHMoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd1cGRhdGVBdHRhY2hDbGFzc2VzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXR0YWNoQ2xhc3NlcyhlbGVtZW50QXR0YWNoLCB0YXJnZXRBdHRhY2gpIHtcbiAgICAgIHZhciBfdGhpczYgPSB0aGlzO1xuXG4gICAgICBlbGVtZW50QXR0YWNoID0gZWxlbWVudEF0dGFjaCB8fCB0aGlzLmF0dGFjaG1lbnQ7XG4gICAgICB0YXJnZXRBdHRhY2ggPSB0YXJnZXRBdHRhY2ggfHwgdGhpcy50YXJnZXRBdHRhY2htZW50O1xuICAgICAgdmFyIHNpZGVzID0gWydsZWZ0JywgJ3RvcCcsICdib3R0b20nLCAncmlnaHQnLCAnbWlkZGxlJywgJ2NlbnRlciddO1xuXG4gICAgICBpZiAodHlwZW9mIHRoaXMuX2FkZEF0dGFjaENsYXNzZXMgIT09ICd1bmRlZmluZWQnICYmIHRoaXMuX2FkZEF0dGFjaENsYXNzZXMubGVuZ3RoKSB7XG4gICAgICAgIC8vIHVwZGF0ZUF0dGFjaENsYXNzZXMgY2FuIGJlIGNhbGxlZCBtb3JlIHRoYW4gb25jZSBpbiBhIHBvc2l0aW9uIGNhbGwsIHNvXG4gICAgICAgIC8vIHdlIG5lZWQgdG8gY2xlYW4gdXAgYWZ0ZXIgb3Vyc2VsdmVzIHN1Y2ggdGhhdCB3aGVuIHRoZSBsYXN0IGRlZmVyIGdldHNcbiAgICAgICAgLy8gcmFuIGl0IGRvZXNuJ3QgYWRkIGFueSBleHRyYSBjbGFzc2VzIGZyb20gcHJldmlvdXMgY2FsbHMuXG4gICAgICAgIHRoaXMuX2FkZEF0dGFjaENsYXNzZXMuc3BsaWNlKDAsIHRoaXMuX2FkZEF0dGFjaENsYXNzZXMubGVuZ3RoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiB0aGlzLl9hZGRBdHRhY2hDbGFzc2VzID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aGlzLl9hZGRBdHRhY2hDbGFzc2VzID0gW107XG4gICAgICB9XG4gICAgICB2YXIgYWRkID0gdGhpcy5fYWRkQXR0YWNoQ2xhc3NlcztcblxuICAgICAgaWYgKGVsZW1lbnRBdHRhY2gudG9wKSB7XG4gICAgICAgIGFkZC5wdXNoKHRoaXMuZ2V0Q2xhc3MoJ2VsZW1lbnQtYXR0YWNoZWQnKSArICctJyArIGVsZW1lbnRBdHRhY2gudG9wKTtcbiAgICAgIH1cbiAgICAgIGlmIChlbGVtZW50QXR0YWNoLmxlZnQpIHtcbiAgICAgICAgYWRkLnB1c2godGhpcy5nZXRDbGFzcygnZWxlbWVudC1hdHRhY2hlZCcpICsgJy0nICsgZWxlbWVudEF0dGFjaC5sZWZ0KTtcbiAgICAgIH1cbiAgICAgIGlmICh0YXJnZXRBdHRhY2gudG9wKSB7XG4gICAgICAgIGFkZC5wdXNoKHRoaXMuZ2V0Q2xhc3MoJ3RhcmdldC1hdHRhY2hlZCcpICsgJy0nICsgdGFyZ2V0QXR0YWNoLnRvcCk7XG4gICAgICB9XG4gICAgICBpZiAodGFyZ2V0QXR0YWNoLmxlZnQpIHtcbiAgICAgICAgYWRkLnB1c2godGhpcy5nZXRDbGFzcygndGFyZ2V0LWF0dGFjaGVkJykgKyAnLScgKyB0YXJnZXRBdHRhY2gubGVmdCk7XG4gICAgICB9XG5cbiAgICAgIHZhciBhbGwgPSBbXTtcbiAgICAgIHNpZGVzLmZvckVhY2goZnVuY3Rpb24gKHNpZGUpIHtcbiAgICAgICAgYWxsLnB1c2goX3RoaXM2LmdldENsYXNzKCdlbGVtZW50LWF0dGFjaGVkJykgKyAnLScgKyBzaWRlKTtcbiAgICAgICAgYWxsLnB1c2goX3RoaXM2LmdldENsYXNzKCd0YXJnZXQtYXR0YWNoZWQnKSArICctJyArIHNpZGUpO1xuICAgICAgfSk7XG5cbiAgICAgIGRlZmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEodHlwZW9mIF90aGlzNi5fYWRkQXR0YWNoQ2xhc3NlcyAhPT0gJ3VuZGVmaW5lZCcpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdXBkYXRlQ2xhc3NlcyhfdGhpczYuZWxlbWVudCwgX3RoaXM2Ll9hZGRBdHRhY2hDbGFzc2VzLCBhbGwpO1xuICAgICAgICBpZiAoIShfdGhpczYub3B0aW9ucy5hZGRUYXJnZXRDbGFzc2VzID09PSBmYWxzZSkpIHtcbiAgICAgICAgICB1cGRhdGVDbGFzc2VzKF90aGlzNi50YXJnZXQsIF90aGlzNi5fYWRkQXR0YWNoQ2xhc3NlcywgYWxsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlbGV0ZSBfdGhpczYuX2FkZEF0dGFjaENsYXNzZXM7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdwb3NpdGlvbicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHBvc2l0aW9uKCkge1xuICAgICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICAgIHZhciBmbHVzaENoYW5nZXMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB0cnVlIDogYXJndW1lbnRzWzBdO1xuXG4gICAgICAvLyBmbHVzaENoYW5nZXMgY29tbWl0cyB0aGUgY2hhbmdlcyBpbW1lZGlhdGVseSwgbGVhdmUgdHJ1ZSB1bmxlc3MgeW91IGFyZSBwb3NpdGlvbmluZyBtdWx0aXBsZVxuICAgICAgLy8gdGV0aGVycyAoaW4gd2hpY2ggY2FzZSBjYWxsIFRldGhlci5VdGlscy5mbHVzaCB5b3Vyc2VsZiB3aGVuIHlvdSdyZSBkb25lKVxuXG4gICAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY2xlYXJDYWNoZSgpO1xuXG4gICAgICAvLyBUdXJuICdhdXRvJyBhdHRhY2htZW50cyBpbnRvIHRoZSBhcHByb3ByaWF0ZSBjb3JuZXIgb3IgZWRnZVxuICAgICAgdmFyIHRhcmdldEF0dGFjaG1lbnQgPSBhdXRvVG9GaXhlZEF0dGFjaG1lbnQodGhpcy50YXJnZXRBdHRhY2htZW50LCB0aGlzLmF0dGFjaG1lbnQpO1xuXG4gICAgICB0aGlzLnVwZGF0ZUF0dGFjaENsYXNzZXModGhpcy5hdHRhY2htZW50LCB0YXJnZXRBdHRhY2htZW50KTtcblxuICAgICAgdmFyIGVsZW1lbnRQb3MgPSB0aGlzLmNhY2hlKCdlbGVtZW50LWJvdW5kcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGdldEJvdW5kcyhfdGhpczcuZWxlbWVudCk7XG4gICAgICB9KTtcblxuICAgICAgdmFyIHdpZHRoID0gZWxlbWVudFBvcy53aWR0aDtcbiAgICAgIHZhciBoZWlnaHQgPSBlbGVtZW50UG9zLmhlaWdodDtcblxuICAgICAgaWYgKHdpZHRoID09PSAwICYmIGhlaWdodCA9PT0gMCAmJiB0eXBlb2YgdGhpcy5sYXN0U2l6ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdmFyIF9sYXN0U2l6ZSA9IHRoaXMubGFzdFNpemU7XG5cbiAgICAgICAgLy8gV2UgY2FjaGUgdGhlIGhlaWdodCBhbmQgd2lkdGggdG8gbWFrZSBpdCBwb3NzaWJsZSB0byBwb3NpdGlvbiBlbGVtZW50cyB0aGF0IGFyZVxuICAgICAgICAvLyBnZXR0aW5nIGhpZGRlbi5cbiAgICAgICAgd2lkdGggPSBfbGFzdFNpemUud2lkdGg7XG4gICAgICAgIGhlaWdodCA9IF9sYXN0U2l6ZS5oZWlnaHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxhc3RTaXplID0geyB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0IH07XG4gICAgICB9XG5cbiAgICAgIHZhciB0YXJnZXRQb3MgPSB0aGlzLmNhY2hlKCd0YXJnZXQtYm91bmRzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX3RoaXM3LmdldFRhcmdldEJvdW5kcygpO1xuICAgICAgfSk7XG4gICAgICB2YXIgdGFyZ2V0U2l6ZSA9IHRhcmdldFBvcztcblxuICAgICAgLy8gR2V0IGFuIGFjdHVhbCBweCBvZmZzZXQgZnJvbSB0aGUgYXR0YWNobWVudFxuICAgICAgdmFyIG9mZnNldCA9IG9mZnNldFRvUHgoYXR0YWNobWVudFRvT2Zmc2V0KHRoaXMuYXR0YWNobWVudCksIHsgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCB9KTtcbiAgICAgIHZhciB0YXJnZXRPZmZzZXQgPSBvZmZzZXRUb1B4KGF0dGFjaG1lbnRUb09mZnNldCh0YXJnZXRBdHRhY2htZW50KSwgdGFyZ2V0U2l6ZSk7XG5cbiAgICAgIHZhciBtYW51YWxPZmZzZXQgPSBvZmZzZXRUb1B4KHRoaXMub2Zmc2V0LCB7IHdpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQgfSk7XG4gICAgICB2YXIgbWFudWFsVGFyZ2V0T2Zmc2V0ID0gb2Zmc2V0VG9QeCh0aGlzLnRhcmdldE9mZnNldCwgdGFyZ2V0U2l6ZSk7XG5cbiAgICAgIC8vIEFkZCB0aGUgbWFudWFsbHkgcHJvdmlkZWQgb2Zmc2V0XG4gICAgICBvZmZzZXQgPSBhZGRPZmZzZXQob2Zmc2V0LCBtYW51YWxPZmZzZXQpO1xuICAgICAgdGFyZ2V0T2Zmc2V0ID0gYWRkT2Zmc2V0KHRhcmdldE9mZnNldCwgbWFudWFsVGFyZ2V0T2Zmc2V0KTtcblxuICAgICAgLy8gSXQncyBub3cgb3VyIGdvYWwgdG8gbWFrZSAoZWxlbWVudCBwb3NpdGlvbiArIG9mZnNldCkgPT0gKHRhcmdldCBwb3NpdGlvbiArIHRhcmdldCBvZmZzZXQpXG4gICAgICB2YXIgbGVmdCA9IHRhcmdldFBvcy5sZWZ0ICsgdGFyZ2V0T2Zmc2V0LmxlZnQgLSBvZmZzZXQubGVmdDtcbiAgICAgIHZhciB0b3AgPSB0YXJnZXRQb3MudG9wICsgdGFyZ2V0T2Zmc2V0LnRvcCAtIG9mZnNldC50b3A7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVGV0aGVyQmFzZS5tb2R1bGVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBfbW9kdWxlMiA9IFRldGhlckJhc2UubW9kdWxlc1tpXTtcbiAgICAgICAgdmFyIHJldCA9IF9tb2R1bGUyLnBvc2l0aW9uLmNhbGwodGhpcywge1xuICAgICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgICAgdG9wOiB0b3AsXG4gICAgICAgICAgdGFyZ2V0QXR0YWNobWVudDogdGFyZ2V0QXR0YWNobWVudCxcbiAgICAgICAgICB0YXJnZXRQb3M6IHRhcmdldFBvcyxcbiAgICAgICAgICBlbGVtZW50UG9zOiBlbGVtZW50UG9zLFxuICAgICAgICAgIG9mZnNldDogb2Zmc2V0LFxuICAgICAgICAgIHRhcmdldE9mZnNldDogdGFyZ2V0T2Zmc2V0LFxuICAgICAgICAgIG1hbnVhbE9mZnNldDogbWFudWFsT2Zmc2V0LFxuICAgICAgICAgIG1hbnVhbFRhcmdldE9mZnNldDogbWFudWFsVGFyZ2V0T2Zmc2V0LFxuICAgICAgICAgIHNjcm9sbGJhclNpemU6IHNjcm9sbGJhclNpemUsXG4gICAgICAgICAgYXR0YWNobWVudDogdGhpcy5hdHRhY2htZW50XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChyZXQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiByZXQgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiByZXQgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9wID0gcmV0LnRvcDtcbiAgICAgICAgICBsZWZ0ID0gcmV0LmxlZnQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gV2UgZGVzY3JpYmUgdGhlIHBvc2l0aW9uIHRocmVlIGRpZmZlcmVudCB3YXlzIHRvIGdpdmUgdGhlIG9wdGltaXplclxuICAgICAgLy8gYSBjaGFuY2UgdG8gZGVjaWRlIHRoZSBiZXN0IHBvc3NpYmxlIHdheSB0byBwb3NpdGlvbiB0aGUgZWxlbWVudFxuICAgICAgLy8gd2l0aCB0aGUgZmV3ZXN0IHJlcGFpbnRzLlxuICAgICAgdmFyIG5leHQgPSB7XG4gICAgICAgIC8vIEl0J3MgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIHBhZ2UgKGFic29sdXRlIHBvc2l0aW9uaW5nIHdoZW5cbiAgICAgICAgLy8gdGhlIGVsZW1lbnQgaXMgYSBjaGlsZCBvZiB0aGUgYm9keSlcbiAgICAgICAgcGFnZToge1xuICAgICAgICAgIHRvcDogdG9wLFxuICAgICAgICAgIGxlZnQ6IGxlZnRcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBJdCdzIHBvc2l0aW9uIHJlbGF0aXZlIHRvIHRoZSB2aWV3cG9ydCAoZml4ZWQgcG9zaXRpb25pbmcpXG4gICAgICAgIHZpZXdwb3J0OiB7XG4gICAgICAgICAgdG9wOiB0b3AgLSBwYWdlWU9mZnNldCxcbiAgICAgICAgICBib3R0b206IHBhZ2VZT2Zmc2V0IC0gdG9wIC0gaGVpZ2h0ICsgaW5uZXJIZWlnaHQsXG4gICAgICAgICAgbGVmdDogbGVmdCAtIHBhZ2VYT2Zmc2V0LFxuICAgICAgICAgIHJpZ2h0OiBwYWdlWE9mZnNldCAtIGxlZnQgLSB3aWR0aCArIGlubmVyV2lkdGhcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdmFyIHNjcm9sbGJhclNpemUgPSB1bmRlZmluZWQ7XG4gICAgICBpZiAoZG9jdW1lbnQuYm9keS5zY3JvbGxXaWR0aCA+IHdpbmRvdy5pbm5lcldpZHRoKSB7XG4gICAgICAgIHNjcm9sbGJhclNpemUgPSB0aGlzLmNhY2hlKCdzY3JvbGxiYXItc2l6ZScsIGdldFNjcm9sbEJhclNpemUpO1xuICAgICAgICBuZXh0LnZpZXdwb3J0LmJvdHRvbSAtPSBzY3JvbGxiYXJTaXplLmhlaWdodDtcbiAgICAgIH1cblxuICAgICAgaWYgKGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0ID4gd2luZG93LmlubmVySGVpZ2h0KSB7XG4gICAgICAgIHNjcm9sbGJhclNpemUgPSB0aGlzLmNhY2hlKCdzY3JvbGxiYXItc2l6ZScsIGdldFNjcm9sbEJhclNpemUpO1xuICAgICAgICBuZXh0LnZpZXdwb3J0LnJpZ2h0IC09IHNjcm9sbGJhclNpemUud2lkdGg7XG4gICAgICB9XG5cbiAgICAgIGlmIChbJycsICdzdGF0aWMnXS5pbmRleE9mKGRvY3VtZW50LmJvZHkuc3R5bGUucG9zaXRpb24pID09PSAtMSB8fCBbJycsICdzdGF0aWMnXS5pbmRleE9mKGRvY3VtZW50LmJvZHkucGFyZW50RWxlbWVudC5zdHlsZS5wb3NpdGlvbikgPT09IC0xKSB7XG4gICAgICAgIC8vIEFic29sdXRlIHBvc2l0aW9uaW5nIGluIHRoZSBib2R5IHdpbGwgYmUgcmVsYXRpdmUgdG8gdGhlIHBhZ2UsIG5vdCB0aGUgJ2luaXRpYWwgY29udGFpbmluZyBibG9jaydcbiAgICAgICAgbmV4dC5wYWdlLmJvdHRvbSA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0IC0gdG9wIC0gaGVpZ2h0O1xuICAgICAgICBuZXh0LnBhZ2UucmlnaHQgPSBkb2N1bWVudC5ib2R5LnNjcm9sbFdpZHRoIC0gbGVmdCAtIHdpZHRoO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5vcHRpbWl6YXRpb25zICE9PSAndW5kZWZpbmVkJyAmJiB0aGlzLm9wdGlvbnMub3B0aW1pemF0aW9ucy5tb3ZlRWxlbWVudCAhPT0gZmFsc2UgJiYgISh0eXBlb2YgdGhpcy50YXJnZXRNb2RpZmllciAhPT0gJ3VuZGVmaW5lZCcpKSB7XG4gICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIG9mZnNldFBhcmVudCA9IF90aGlzNy5jYWNoZSgndGFyZ2V0LW9mZnNldHBhcmVudCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRPZmZzZXRQYXJlbnQoX3RoaXM3LnRhcmdldCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdmFyIG9mZnNldFBvc2l0aW9uID0gX3RoaXM3LmNhY2hlKCd0YXJnZXQtb2Zmc2V0cGFyZW50LWJvdW5kcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRCb3VuZHMob2Zmc2V0UGFyZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YXIgb2Zmc2V0UGFyZW50U3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG9mZnNldFBhcmVudCk7XG4gICAgICAgICAgdmFyIG9mZnNldFBhcmVudFNpemUgPSBvZmZzZXRQb3NpdGlvbjtcblxuICAgICAgICAgIHZhciBvZmZzZXRCb3JkZXIgPSB7fTtcbiAgICAgICAgICBbJ1RvcCcsICdMZWZ0JywgJ0JvdHRvbScsICdSaWdodCddLmZvckVhY2goZnVuY3Rpb24gKHNpZGUpIHtcbiAgICAgICAgICAgIG9mZnNldEJvcmRlcltzaWRlLnRvTG93ZXJDYXNlKCldID0gcGFyc2VGbG9hdChvZmZzZXRQYXJlbnRTdHlsZVsnYm9yZGVyJyArIHNpZGUgKyAnV2lkdGgnXSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBvZmZzZXRQb3NpdGlvbi5yaWdodCA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsV2lkdGggLSBvZmZzZXRQb3NpdGlvbi5sZWZ0IC0gb2Zmc2V0UGFyZW50U2l6ZS53aWR0aCArIG9mZnNldEJvcmRlci5yaWdodDtcbiAgICAgICAgICBvZmZzZXRQb3NpdGlvbi5ib3R0b20gPSBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCAtIG9mZnNldFBvc2l0aW9uLnRvcCAtIG9mZnNldFBhcmVudFNpemUuaGVpZ2h0ICsgb2Zmc2V0Qm9yZGVyLmJvdHRvbTtcblxuICAgICAgICAgIGlmIChuZXh0LnBhZ2UudG9wID49IG9mZnNldFBvc2l0aW9uLnRvcCArIG9mZnNldEJvcmRlci50b3AgJiYgbmV4dC5wYWdlLmJvdHRvbSA+PSBvZmZzZXRQb3NpdGlvbi5ib3R0b20pIHtcbiAgICAgICAgICAgIGlmIChuZXh0LnBhZ2UubGVmdCA+PSBvZmZzZXRQb3NpdGlvbi5sZWZ0ICsgb2Zmc2V0Qm9yZGVyLmxlZnQgJiYgbmV4dC5wYWdlLnJpZ2h0ID49IG9mZnNldFBvc2l0aW9uLnJpZ2h0KSB7XG4gICAgICAgICAgICAgIC8vIFdlJ3JlIHdpdGhpbiB0aGUgdmlzaWJsZSBwYXJ0IG9mIHRoZSB0YXJnZXQncyBzY3JvbGwgcGFyZW50XG4gICAgICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSBvZmZzZXRQYXJlbnQuc2Nyb2xsVG9wO1xuICAgICAgICAgICAgICB2YXIgc2Nyb2xsTGVmdCA9IG9mZnNldFBhcmVudC5zY3JvbGxMZWZ0O1xuXG4gICAgICAgICAgICAgIC8vIEl0J3MgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIHRhcmdldCdzIG9mZnNldCBwYXJlbnQgKGFic29sdXRlIHBvc2l0aW9uaW5nIHdoZW5cbiAgICAgICAgICAgICAgLy8gdGhlIGVsZW1lbnQgaXMgbW92ZWQgdG8gYmUgYSBjaGlsZCBvZiB0aGUgdGFyZ2V0J3Mgb2Zmc2V0IHBhcmVudCkuXG4gICAgICAgICAgICAgIG5leHQub2Zmc2V0ID0ge1xuICAgICAgICAgICAgICAgIHRvcDogbmV4dC5wYWdlLnRvcCAtIG9mZnNldFBvc2l0aW9uLnRvcCArIHNjcm9sbFRvcCAtIG9mZnNldEJvcmRlci50b3AsXG4gICAgICAgICAgICAgICAgbGVmdDogbmV4dC5wYWdlLmxlZnQgLSBvZmZzZXRQb3NpdGlvbi5sZWZ0ICsgc2Nyb2xsTGVmdCAtIG9mZnNldEJvcmRlci5sZWZ0XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KSgpO1xuICAgICAgfVxuXG4gICAgICAvLyBXZSBjb3VsZCBhbHNvIHRyYXZlbCB1cCB0aGUgRE9NIGFuZCB0cnkgZWFjaCBjb250YWluaW5nIGNvbnRleHQsIHJhdGhlciB0aGFuIG9ubHlcbiAgICAgIC8vIGxvb2tpbmcgYXQgdGhlIGJvZHksIGJ1dCB3ZSdyZSBnb25uYSBnZXQgZGltaW5pc2hpbmcgcmV0dXJucy5cblxuICAgICAgdGhpcy5tb3ZlKG5leHQpO1xuXG4gICAgICB0aGlzLmhpc3RvcnkudW5zaGlmdChuZXh0KTtcblxuICAgICAgaWYgKHRoaXMuaGlzdG9yeS5sZW5ndGggPiAzKSB7XG4gICAgICAgIHRoaXMuaGlzdG9yeS5wb3AoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGZsdXNoQ2hhbmdlcykge1xuICAgICAgICBmbHVzaCgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBUSEUgSVNTVUVcbiAgfSwge1xuICAgIGtleTogJ21vdmUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlKHBvcykge1xuICAgICAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgICAgIGlmICghKHR5cGVvZiB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSAhPT0gJ3VuZGVmaW5lZCcpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHNhbWUgPSB7fTtcblxuICAgICAgZm9yICh2YXIgdHlwZSBpbiBwb3MpIHtcbiAgICAgICAgc2FtZVt0eXBlXSA9IHt9O1xuXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBwb3NbdHlwZV0pIHtcbiAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcblxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5oaXN0b3J5Lmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgcG9pbnQgPSB0aGlzLmhpc3RvcnlbaV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIHBvaW50W3R5cGVdICE9PSAndW5kZWZpbmVkJyAmJiAhd2l0aGluKHBvaW50W3R5cGVdW2tleV0sIHBvc1t0eXBlXVtrZXldKSkge1xuICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghZm91bmQpIHtcbiAgICAgICAgICAgIHNhbWVbdHlwZV1ba2V5XSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBjc3MgPSB7IHRvcDogJycsIGxlZnQ6ICcnLCByaWdodDogJycsIGJvdHRvbTogJycgfTtcblxuICAgICAgdmFyIHRyYW5zY3JpYmUgPSBmdW5jdGlvbiB0cmFuc2NyaWJlKF9zYW1lLCBfcG9zKSB7XG4gICAgICAgIHZhciBoYXNPcHRpbWl6YXRpb25zID0gdHlwZW9mIF90aGlzOC5vcHRpb25zLm9wdGltaXphdGlvbnMgIT09ICd1bmRlZmluZWQnO1xuICAgICAgICB2YXIgZ3B1ID0gaGFzT3B0aW1pemF0aW9ucyA/IF90aGlzOC5vcHRpb25zLm9wdGltaXphdGlvbnMuZ3B1IDogbnVsbDtcbiAgICAgICAgaWYgKGdwdSAhPT0gZmFsc2UpIHtcbiAgICAgICAgICB2YXIgeVBvcyA9IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgeFBvcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICBpZiAoX3NhbWUudG9wKSB7XG4gICAgICAgICAgICBjc3MudG9wID0gMDtcbiAgICAgICAgICAgIHlQb3MgPSBfcG9zLnRvcDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3NzLmJvdHRvbSA9IDA7XG4gICAgICAgICAgICB5UG9zID0gLV9wb3MuYm90dG9tO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChfc2FtZS5sZWZ0KSB7XG4gICAgICAgICAgICBjc3MubGVmdCA9IDA7XG4gICAgICAgICAgICB4UG9zID0gX3Bvcy5sZWZ0O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjc3MucmlnaHQgPSAwO1xuICAgICAgICAgICAgeFBvcyA9IC1fcG9zLnJpZ2h0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNzc1t0cmFuc2Zvcm1LZXldID0gJ3RyYW5zbGF0ZVgoJyArIE1hdGgucm91bmQoeFBvcykgKyAncHgpIHRyYW5zbGF0ZVkoJyArIE1hdGgucm91bmQoeVBvcykgKyAncHgpJztcblxuICAgICAgICAgIGlmICh0cmFuc2Zvcm1LZXkgIT09ICdtc1RyYW5zZm9ybScpIHtcbiAgICAgICAgICAgIC8vIFRoZSBaIHRyYW5zZm9ybSB3aWxsIGtlZXAgdGhpcyBpbiB0aGUgR1BVIChmYXN0ZXIsIGFuZCBwcmV2ZW50cyBhcnRpZmFjdHMpLFxuICAgICAgICAgICAgLy8gYnV0IElFOSBkb2Vzbid0IHN1cHBvcnQgM2QgdHJhbnNmb3JtcyBhbmQgd2lsbCBjaG9rZS5cbiAgICAgICAgICAgIGNzc1t0cmFuc2Zvcm1LZXldICs9IFwiIHRyYW5zbGF0ZVooMClcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKF9zYW1lLnRvcCkge1xuICAgICAgICAgICAgY3NzLnRvcCA9IF9wb3MudG9wICsgJ3B4JztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3NzLmJvdHRvbSA9IF9wb3MuYm90dG9tICsgJ3B4JztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoX3NhbWUubGVmdCkge1xuICAgICAgICAgICAgY3NzLmxlZnQgPSBfcG9zLmxlZnQgKyAncHgnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjc3MucmlnaHQgPSBfcG9zLnJpZ2h0ICsgJ3B4JztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHZhciBtb3ZlZCA9IGZhbHNlO1xuICAgICAgaWYgKChzYW1lLnBhZ2UudG9wIHx8IHNhbWUucGFnZS5ib3R0b20pICYmIChzYW1lLnBhZ2UubGVmdCB8fCBzYW1lLnBhZ2UucmlnaHQpKSB7XG4gICAgICAgIGNzcy5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIHRyYW5zY3JpYmUoc2FtZS5wYWdlLCBwb3MucGFnZSk7XG4gICAgICB9IGVsc2UgaWYgKChzYW1lLnZpZXdwb3J0LnRvcCB8fCBzYW1lLnZpZXdwb3J0LmJvdHRvbSkgJiYgKHNhbWUudmlld3BvcnQubGVmdCB8fCBzYW1lLnZpZXdwb3J0LnJpZ2h0KSkge1xuICAgICAgICBjc3MucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgICB0cmFuc2NyaWJlKHNhbWUudmlld3BvcnQsIHBvcy52aWV3cG9ydCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBzYW1lLm9mZnNldCAhPT0gJ3VuZGVmaW5lZCcgJiYgc2FtZS5vZmZzZXQudG9wICYmIHNhbWUub2Zmc2V0LmxlZnQpIHtcbiAgICAgICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjc3MucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICAgIHZhciBvZmZzZXRQYXJlbnQgPSBfdGhpczguY2FjaGUoJ3RhcmdldC1vZmZzZXRwYXJlbnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0T2Zmc2V0UGFyZW50KF90aGlzOC50YXJnZXQpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYgKGdldE9mZnNldFBhcmVudChfdGhpczguZWxlbWVudCkgIT09IG9mZnNldFBhcmVudCkge1xuICAgICAgICAgICAgZGVmZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBfdGhpczguZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKF90aGlzOC5lbGVtZW50KTtcbiAgICAgICAgICAgICAgb2Zmc2V0UGFyZW50LmFwcGVuZENoaWxkKF90aGlzOC5lbGVtZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRyYW5zY3JpYmUoc2FtZS5vZmZzZXQsIHBvcy5vZmZzZXQpO1xuICAgICAgICAgIG1vdmVkID0gdHJ1ZTtcbiAgICAgICAgfSkoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNzcy5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIHRyYW5zY3JpYmUoeyB0b3A6IHRydWUsIGxlZnQ6IHRydWUgfSwgcG9zLnBhZ2UpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIW1vdmVkKSB7XG4gICAgICAgIHZhciBvZmZzZXRQYXJlbnRJc0JvZHkgPSB0cnVlO1xuICAgICAgICB2YXIgY3VycmVudE5vZGUgPSB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlICYmIGN1cnJlbnROb2RlLm5vZGVUeXBlID09PSAxICYmIGN1cnJlbnROb2RlLnRhZ05hbWUgIT09ICdCT0RZJykge1xuICAgICAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKGN1cnJlbnROb2RlKS5wb3NpdGlvbiAhPT0gJ3N0YXRpYycpIHtcbiAgICAgICAgICAgIG9mZnNldFBhcmVudElzQm9keSA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFvZmZzZXRQYXJlbnRJc0JvZHkpIHtcbiAgICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBBbnkgY3NzIGNoYW5nZSB3aWxsIHRyaWdnZXIgYSByZXBhaW50LCBzbyBsZXQncyBhdm9pZCBvbmUgaWYgbm90aGluZyBjaGFuZ2VkXG4gICAgICB2YXIgd3JpdGVDU1MgPSB7fTtcbiAgICAgIHZhciB3cml0ZSA9IGZhbHNlO1xuICAgICAgZm9yICh2YXIga2V5IGluIGNzcykge1xuICAgICAgICB2YXIgdmFsID0gY3NzW2tleV07XG4gICAgICAgIHZhciBlbFZhbCA9IHRoaXMuZWxlbWVudC5zdHlsZVtrZXldO1xuXG4gICAgICAgIGlmIChlbFZhbCAhPT0gdmFsKSB7XG4gICAgICAgICAgd3JpdGUgPSB0cnVlO1xuICAgICAgICAgIHdyaXRlQ1NTW2tleV0gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHdyaXRlKSB7XG4gICAgICAgIGRlZmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBleHRlbmQoX3RoaXM4LmVsZW1lbnQuc3R5bGUsIHdyaXRlQ1NTKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFRldGhlckNsYXNzO1xufSkoRXZlbnRlZCk7XG5cblRldGhlckNsYXNzLm1vZHVsZXMgPSBbXTtcblxuVGV0aGVyQmFzZS5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuXG52YXIgVGV0aGVyID0gZXh0ZW5kKFRldGhlckNsYXNzLCBUZXRoZXJCYXNlKTtcbi8qIGdsb2JhbHMgVGV0aGVyQmFzZSAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfc2xpY2VkVG9BcnJheSA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIHNsaWNlSXRlcmF0b3IoYXJyLCBpKSB7IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX2UgPSB1bmRlZmluZWQ7IHRyeSB7IGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsgX2Fyci5wdXNoKF9zLnZhbHVlKTsgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOyB9IH0gY2F0Y2ggKGVycikgeyBfZCA9IHRydWU7IF9lID0gZXJyOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIV9uICYmIF9pWydyZXR1cm4nXSkgX2lbJ3JldHVybiddKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfSByZXR1cm4gZnVuY3Rpb24gKGFyciwgaSkgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IHJldHVybiBhcnI7IH0gZWxzZSBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSB7IHJldHVybiBzbGljZUl0ZXJhdG9yKGFyciwgaSk7IH0gZWxzZSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UnKTsgfSB9OyB9KSgpO1xuXG52YXIgX1RldGhlckJhc2UkVXRpbHMgPSBUZXRoZXJCYXNlLlV0aWxzO1xudmFyIGdldEJvdW5kcyA9IF9UZXRoZXJCYXNlJFV0aWxzLmdldEJvdW5kcztcbnZhciBleHRlbmQgPSBfVGV0aGVyQmFzZSRVdGlscy5leHRlbmQ7XG52YXIgdXBkYXRlQ2xhc3NlcyA9IF9UZXRoZXJCYXNlJFV0aWxzLnVwZGF0ZUNsYXNzZXM7XG52YXIgZGVmZXIgPSBfVGV0aGVyQmFzZSRVdGlscy5kZWZlcjtcblxudmFyIEJPVU5EU19GT1JNQVQgPSBbJ2xlZnQnLCAndG9wJywgJ3JpZ2h0JywgJ2JvdHRvbSddO1xuXG5mdW5jdGlvbiBnZXRCb3VuZGluZ1JlY3QodGV0aGVyLCB0bykge1xuICBpZiAodG8gPT09ICdzY3JvbGxQYXJlbnQnKSB7XG4gICAgdG8gPSB0ZXRoZXIuc2Nyb2xsUGFyZW50c1swXTtcbiAgfSBlbHNlIGlmICh0byA9PT0gJ3dpbmRvdycpIHtcbiAgICB0byA9IFtwYWdlWE9mZnNldCwgcGFnZVlPZmZzZXQsIGlubmVyV2lkdGggKyBwYWdlWE9mZnNldCwgaW5uZXJIZWlnaHQgKyBwYWdlWU9mZnNldF07XG4gIH1cblxuICBpZiAodG8gPT09IGRvY3VtZW50KSB7XG4gICAgdG8gPSB0by5kb2N1bWVudEVsZW1lbnQ7XG4gIH1cblxuICBpZiAodHlwZW9mIHRvLm5vZGVUeXBlICE9PSAndW5kZWZpbmVkJykge1xuICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc2l6ZSA9IGdldEJvdW5kcyh0byk7XG4gICAgICB2YXIgcG9zID0gc2l6ZTtcbiAgICAgIHZhciBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUodG8pO1xuXG4gICAgICB0byA9IFtwb3MubGVmdCwgcG9zLnRvcCwgc2l6ZS53aWR0aCArIHBvcy5sZWZ0LCBzaXplLmhlaWdodCArIHBvcy50b3BdO1xuXG4gICAgICBCT1VORFNfRk9STUFULmZvckVhY2goZnVuY3Rpb24gKHNpZGUsIGkpIHtcbiAgICAgICAgc2lkZSA9IHNpZGVbMF0udG9VcHBlckNhc2UoKSArIHNpZGUuc3Vic3RyKDEpO1xuICAgICAgICBpZiAoc2lkZSA9PT0gJ1RvcCcgfHwgc2lkZSA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgdG9baV0gKz0gcGFyc2VGbG9hdChzdHlsZVsnYm9yZGVyJyArIHNpZGUgKyAnV2lkdGgnXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9baV0gLT0gcGFyc2VGbG9hdChzdHlsZVsnYm9yZGVyJyArIHNpZGUgKyAnV2lkdGgnXSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pKCk7XG4gIH1cblxuICByZXR1cm4gdG87XG59XG5cblRldGhlckJhc2UubW9kdWxlcy5wdXNoKHtcbiAgcG9zaXRpb246IGZ1bmN0aW9uIHBvc2l0aW9uKF9yZWYpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdmFyIHRvcCA9IF9yZWYudG9wO1xuICAgIHZhciBsZWZ0ID0gX3JlZi5sZWZ0O1xuICAgIHZhciB0YXJnZXRBdHRhY2htZW50ID0gX3JlZi50YXJnZXRBdHRhY2htZW50O1xuXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuY29uc3RyYWludHMpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHZhciBfY2FjaGUgPSB0aGlzLmNhY2hlKCdlbGVtZW50LWJvdW5kcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBnZXRCb3VuZHMoX3RoaXMuZWxlbWVudCk7XG4gICAgfSk7XG5cbiAgICB2YXIgaGVpZ2h0ID0gX2NhY2hlLmhlaWdodDtcbiAgICB2YXIgd2lkdGggPSBfY2FjaGUud2lkdGg7XG5cbiAgICBpZiAod2lkdGggPT09IDAgJiYgaGVpZ2h0ID09PSAwICYmIHR5cGVvZiB0aGlzLmxhc3RTaXplICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdmFyIF9sYXN0U2l6ZSA9IHRoaXMubGFzdFNpemU7XG5cbiAgICAgIC8vIEhhbmRsZSB0aGUgaXRlbSBnZXR0aW5nIGhpZGRlbiBhcyBhIHJlc3VsdCBvZiBvdXIgcG9zaXRpb25pbmcgd2l0aG91dCBnbGl0Y2hpbmdcbiAgICAgIC8vIHRoZSBjbGFzc2VzIGluIGFuZCBvdXRcbiAgICAgIHdpZHRoID0gX2xhc3RTaXplLndpZHRoO1xuICAgICAgaGVpZ2h0ID0gX2xhc3RTaXplLmhlaWdodDtcbiAgICB9XG5cbiAgICB2YXIgdGFyZ2V0U2l6ZSA9IHRoaXMuY2FjaGUoJ3RhcmdldC1ib3VuZHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMuZ2V0VGFyZ2V0Qm91bmRzKCk7XG4gICAgfSk7XG5cbiAgICB2YXIgdGFyZ2V0SGVpZ2h0ID0gdGFyZ2V0U2l6ZS5oZWlnaHQ7XG4gICAgdmFyIHRhcmdldFdpZHRoID0gdGFyZ2V0U2l6ZS53aWR0aDtcblxuICAgIHZhciBhbGxDbGFzc2VzID0gW3RoaXMuZ2V0Q2xhc3MoJ3Bpbm5lZCcpLCB0aGlzLmdldENsYXNzKCdvdXQtb2YtYm91bmRzJyldO1xuXG4gICAgdGhpcy5vcHRpb25zLmNvbnN0cmFpbnRzLmZvckVhY2goZnVuY3Rpb24gKGNvbnN0cmFpbnQpIHtcbiAgICAgIHZhciBvdXRPZkJvdW5kc0NsYXNzID0gY29uc3RyYWludC5vdXRPZkJvdW5kc0NsYXNzO1xuICAgICAgdmFyIHBpbm5lZENsYXNzID0gY29uc3RyYWludC5waW5uZWRDbGFzcztcblxuICAgICAgaWYgKG91dE9mQm91bmRzQ2xhc3MpIHtcbiAgICAgICAgYWxsQ2xhc3Nlcy5wdXNoKG91dE9mQm91bmRzQ2xhc3MpO1xuICAgICAgfVxuICAgICAgaWYgKHBpbm5lZENsYXNzKSB7XG4gICAgICAgIGFsbENsYXNzZXMucHVzaChwaW5uZWRDbGFzcyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBhbGxDbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gKGNscykge1xuICAgICAgWydsZWZ0JywgJ3RvcCcsICdyaWdodCcsICdib3R0b20nXS5mb3JFYWNoKGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgICAgIGFsbENsYXNzZXMucHVzaChjbHMgKyAnLScgKyBzaWRlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdmFyIGFkZENsYXNzZXMgPSBbXTtcblxuICAgIHZhciB0QXR0YWNobWVudCA9IGV4dGVuZCh7fSwgdGFyZ2V0QXR0YWNobWVudCk7XG4gICAgdmFyIGVBdHRhY2htZW50ID0gZXh0ZW5kKHt9LCB0aGlzLmF0dGFjaG1lbnQpO1xuXG4gICAgdGhpcy5vcHRpb25zLmNvbnN0cmFpbnRzLmZvckVhY2goZnVuY3Rpb24gKGNvbnN0cmFpbnQpIHtcbiAgICAgIHZhciB0byA9IGNvbnN0cmFpbnQudG87XG4gICAgICB2YXIgYXR0YWNobWVudCA9IGNvbnN0cmFpbnQuYXR0YWNobWVudDtcbiAgICAgIHZhciBwaW4gPSBjb25zdHJhaW50LnBpbjtcblxuICAgICAgaWYgKHR5cGVvZiBhdHRhY2htZW50ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBhdHRhY2htZW50ID0gJyc7XG4gICAgICB9XG5cbiAgICAgIHZhciBjaGFuZ2VBdHRhY2hYID0gdW5kZWZpbmVkLFxuICAgICAgICAgIGNoYW5nZUF0dGFjaFkgPSB1bmRlZmluZWQ7XG4gICAgICBpZiAoYXR0YWNobWVudC5pbmRleE9mKCcgJykgPj0gMCkge1xuICAgICAgICB2YXIgX2F0dGFjaG1lbnQkc3BsaXQgPSBhdHRhY2htZW50LnNwbGl0KCcgJyk7XG5cbiAgICAgICAgdmFyIF9hdHRhY2htZW50JHNwbGl0MiA9IF9zbGljZWRUb0FycmF5KF9hdHRhY2htZW50JHNwbGl0LCAyKTtcblxuICAgICAgICBjaGFuZ2VBdHRhY2hZID0gX2F0dGFjaG1lbnQkc3BsaXQyWzBdO1xuICAgICAgICBjaGFuZ2VBdHRhY2hYID0gX2F0dGFjaG1lbnQkc3BsaXQyWzFdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhbmdlQXR0YWNoWCA9IGNoYW5nZUF0dGFjaFkgPSBhdHRhY2htZW50O1xuICAgICAgfVxuXG4gICAgICB2YXIgYm91bmRzID0gZ2V0Qm91bmRpbmdSZWN0KF90aGlzLCB0byk7XG5cbiAgICAgIGlmIChjaGFuZ2VBdHRhY2hZID09PSAndGFyZ2V0JyB8fCBjaGFuZ2VBdHRhY2hZID09PSAnYm90aCcpIHtcbiAgICAgICAgaWYgKHRvcCA8IGJvdW5kc1sxXSAmJiB0QXR0YWNobWVudC50b3AgPT09ICd0b3AnKSB7XG4gICAgICAgICAgdG9wICs9IHRhcmdldEhlaWdodDtcbiAgICAgICAgICB0QXR0YWNobWVudC50b3AgPSAnYm90dG9tJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0b3AgKyBoZWlnaHQgPiBib3VuZHNbM10gJiYgdEF0dGFjaG1lbnQudG9wID09PSAnYm90dG9tJykge1xuICAgICAgICAgIHRvcCAtPSB0YXJnZXRIZWlnaHQ7XG4gICAgICAgICAgdEF0dGFjaG1lbnQudG9wID0gJ3RvcCc7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNoYW5nZUF0dGFjaFkgPT09ICd0b2dldGhlcicpIHtcbiAgICAgICAgaWYgKHRBdHRhY2htZW50LnRvcCA9PT0gJ3RvcCcpIHtcbiAgICAgICAgICBpZiAoZUF0dGFjaG1lbnQudG9wID09PSAnYm90dG9tJyAmJiB0b3AgPCBib3VuZHNbMV0pIHtcbiAgICAgICAgICAgIHRvcCArPSB0YXJnZXRIZWlnaHQ7XG4gICAgICAgICAgICB0QXR0YWNobWVudC50b3AgPSAnYm90dG9tJztcblxuICAgICAgICAgICAgdG9wICs9IGhlaWdodDtcbiAgICAgICAgICAgIGVBdHRhY2htZW50LnRvcCA9ICd0b3AnO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZUF0dGFjaG1lbnQudG9wID09PSAndG9wJyAmJiB0b3AgKyBoZWlnaHQgPiBib3VuZHNbM10gJiYgdG9wIC0gKGhlaWdodCAtIHRhcmdldEhlaWdodCkgPj0gYm91bmRzWzFdKSB7XG4gICAgICAgICAgICB0b3AgLT0gaGVpZ2h0IC0gdGFyZ2V0SGVpZ2h0O1xuICAgICAgICAgICAgdEF0dGFjaG1lbnQudG9wID0gJ2JvdHRvbSc7XG5cbiAgICAgICAgICAgIGVBdHRhY2htZW50LnRvcCA9ICdib3R0b20nO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0QXR0YWNobWVudC50b3AgPT09ICdib3R0b20nKSB7XG4gICAgICAgICAgaWYgKGVBdHRhY2htZW50LnRvcCA9PT0gJ3RvcCcgJiYgdG9wICsgaGVpZ2h0ID4gYm91bmRzWzNdKSB7XG4gICAgICAgICAgICB0b3AgLT0gdGFyZ2V0SGVpZ2h0O1xuICAgICAgICAgICAgdEF0dGFjaG1lbnQudG9wID0gJ3RvcCc7XG5cbiAgICAgICAgICAgIHRvcCAtPSBoZWlnaHQ7XG4gICAgICAgICAgICBlQXR0YWNobWVudC50b3AgPSAnYm90dG9tJztcbiAgICAgICAgICB9IGVsc2UgaWYgKGVBdHRhY2htZW50LnRvcCA9PT0gJ2JvdHRvbScgJiYgdG9wIDwgYm91bmRzWzFdICYmIHRvcCArIChoZWlnaHQgKiAyIC0gdGFyZ2V0SGVpZ2h0KSA8PSBib3VuZHNbM10pIHtcbiAgICAgICAgICAgIHRvcCArPSBoZWlnaHQgLSB0YXJnZXRIZWlnaHQ7XG4gICAgICAgICAgICB0QXR0YWNobWVudC50b3AgPSAndG9wJztcblxuICAgICAgICAgICAgZUF0dGFjaG1lbnQudG9wID0gJ3RvcCc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRBdHRhY2htZW50LnRvcCA9PT0gJ21pZGRsZScpIHtcbiAgICAgICAgICBpZiAodG9wICsgaGVpZ2h0ID4gYm91bmRzWzNdICYmIGVBdHRhY2htZW50LnRvcCA9PT0gJ3RvcCcpIHtcbiAgICAgICAgICAgIHRvcCAtPSBoZWlnaHQ7XG4gICAgICAgICAgICBlQXR0YWNobWVudC50b3AgPSAnYm90dG9tJztcbiAgICAgICAgICB9IGVsc2UgaWYgKHRvcCA8IGJvdW5kc1sxXSAmJiBlQXR0YWNobWVudC50b3AgPT09ICdib3R0b20nKSB7XG4gICAgICAgICAgICB0b3AgKz0gaGVpZ2h0O1xuICAgICAgICAgICAgZUF0dGFjaG1lbnQudG9wID0gJ3RvcCc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChjaGFuZ2VBdHRhY2hYID09PSAndGFyZ2V0JyB8fCBjaGFuZ2VBdHRhY2hYID09PSAnYm90aCcpIHtcbiAgICAgICAgaWYgKGxlZnQgPCBib3VuZHNbMF0gJiYgdEF0dGFjaG1lbnQubGVmdCA9PT0gJ2xlZnQnKSB7XG4gICAgICAgICAgbGVmdCArPSB0YXJnZXRXaWR0aDtcbiAgICAgICAgICB0QXR0YWNobWVudC5sZWZ0ID0gJ3JpZ2h0JztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsZWZ0ICsgd2lkdGggPiBib3VuZHNbMl0gJiYgdEF0dGFjaG1lbnQubGVmdCA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgIGxlZnQgLT0gdGFyZ2V0V2lkdGg7XG4gICAgICAgICAgdEF0dGFjaG1lbnQubGVmdCA9ICdsZWZ0JztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoY2hhbmdlQXR0YWNoWCA9PT0gJ3RvZ2V0aGVyJykge1xuICAgICAgICBpZiAobGVmdCA8IGJvdW5kc1swXSAmJiB0QXR0YWNobWVudC5sZWZ0ID09PSAnbGVmdCcpIHtcbiAgICAgICAgICBpZiAoZUF0dGFjaG1lbnQubGVmdCA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgICAgbGVmdCArPSB0YXJnZXRXaWR0aDtcbiAgICAgICAgICAgIHRBdHRhY2htZW50LmxlZnQgPSAncmlnaHQnO1xuXG4gICAgICAgICAgICBsZWZ0ICs9IHdpZHRoO1xuICAgICAgICAgICAgZUF0dGFjaG1lbnQubGVmdCA9ICdsZWZ0JztcbiAgICAgICAgICB9IGVsc2UgaWYgKGVBdHRhY2htZW50LmxlZnQgPT09ICdsZWZ0Jykge1xuICAgICAgICAgICAgbGVmdCArPSB0YXJnZXRXaWR0aDtcbiAgICAgICAgICAgIHRBdHRhY2htZW50LmxlZnQgPSAncmlnaHQnO1xuXG4gICAgICAgICAgICBsZWZ0IC09IHdpZHRoO1xuICAgICAgICAgICAgZUF0dGFjaG1lbnQubGVmdCA9ICdyaWdodCc7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGxlZnQgKyB3aWR0aCA+IGJvdW5kc1syXSAmJiB0QXR0YWNobWVudC5sZWZ0ID09PSAncmlnaHQnKSB7XG4gICAgICAgICAgaWYgKGVBdHRhY2htZW50LmxlZnQgPT09ICdsZWZ0Jykge1xuICAgICAgICAgICAgbGVmdCAtPSB0YXJnZXRXaWR0aDtcbiAgICAgICAgICAgIHRBdHRhY2htZW50LmxlZnQgPSAnbGVmdCc7XG5cbiAgICAgICAgICAgIGxlZnQgLT0gd2lkdGg7XG4gICAgICAgICAgICBlQXR0YWNobWVudC5sZWZ0ID0gJ3JpZ2h0JztcbiAgICAgICAgICB9IGVsc2UgaWYgKGVBdHRhY2htZW50LmxlZnQgPT09ICdyaWdodCcpIHtcbiAgICAgICAgICAgIGxlZnQgLT0gdGFyZ2V0V2lkdGg7XG4gICAgICAgICAgICB0QXR0YWNobWVudC5sZWZ0ID0gJ2xlZnQnO1xuXG4gICAgICAgICAgICBsZWZ0ICs9IHdpZHRoO1xuICAgICAgICAgICAgZUF0dGFjaG1lbnQubGVmdCA9ICdsZWZ0JztcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodEF0dGFjaG1lbnQubGVmdCA9PT0gJ2NlbnRlcicpIHtcbiAgICAgICAgICBpZiAobGVmdCArIHdpZHRoID4gYm91bmRzWzJdICYmIGVBdHRhY2htZW50LmxlZnQgPT09ICdsZWZ0Jykge1xuICAgICAgICAgICAgbGVmdCAtPSB3aWR0aDtcbiAgICAgICAgICAgIGVBdHRhY2htZW50LmxlZnQgPSAncmlnaHQnO1xuICAgICAgICAgIH0gZWxzZSBpZiAobGVmdCA8IGJvdW5kc1swXSAmJiBlQXR0YWNobWVudC5sZWZ0ID09PSAncmlnaHQnKSB7XG4gICAgICAgICAgICBsZWZ0ICs9IHdpZHRoO1xuICAgICAgICAgICAgZUF0dGFjaG1lbnQubGVmdCA9ICdsZWZ0JztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNoYW5nZUF0dGFjaFkgPT09ICdlbGVtZW50JyB8fCBjaGFuZ2VBdHRhY2hZID09PSAnYm90aCcpIHtcbiAgICAgICAgaWYgKHRvcCA8IGJvdW5kc1sxXSAmJiBlQXR0YWNobWVudC50b3AgPT09ICdib3R0b20nKSB7XG4gICAgICAgICAgdG9wICs9IGhlaWdodDtcbiAgICAgICAgICBlQXR0YWNobWVudC50b3AgPSAndG9wJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0b3AgKyBoZWlnaHQgPiBib3VuZHNbM10gJiYgZUF0dGFjaG1lbnQudG9wID09PSAndG9wJykge1xuICAgICAgICAgIHRvcCAtPSBoZWlnaHQ7XG4gICAgICAgICAgZUF0dGFjaG1lbnQudG9wID0gJ2JvdHRvbSc7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNoYW5nZUF0dGFjaFggPT09ICdlbGVtZW50JyB8fCBjaGFuZ2VBdHRhY2hYID09PSAnYm90aCcpIHtcbiAgICAgICAgaWYgKGxlZnQgPCBib3VuZHNbMF0pIHtcbiAgICAgICAgICBpZiAoZUF0dGFjaG1lbnQubGVmdCA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgICAgbGVmdCArPSB3aWR0aDtcbiAgICAgICAgICAgIGVBdHRhY2htZW50LmxlZnQgPSAnbGVmdCc7XG4gICAgICAgICAgfSBlbHNlIGlmIChlQXR0YWNobWVudC5sZWZ0ID09PSAnY2VudGVyJykge1xuICAgICAgICAgICAgbGVmdCArPSB3aWR0aCAvIDI7XG4gICAgICAgICAgICBlQXR0YWNobWVudC5sZWZ0ID0gJ2xlZnQnO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsZWZ0ICsgd2lkdGggPiBib3VuZHNbMl0pIHtcbiAgICAgICAgICBpZiAoZUF0dGFjaG1lbnQubGVmdCA9PT0gJ2xlZnQnKSB7XG4gICAgICAgICAgICBsZWZ0IC09IHdpZHRoO1xuICAgICAgICAgICAgZUF0dGFjaG1lbnQubGVmdCA9ICdyaWdodCc7XG4gICAgICAgICAgfSBlbHNlIGlmIChlQXR0YWNobWVudC5sZWZ0ID09PSAnY2VudGVyJykge1xuICAgICAgICAgICAgbGVmdCAtPSB3aWR0aCAvIDI7XG4gICAgICAgICAgICBlQXR0YWNobWVudC5sZWZ0ID0gJ3JpZ2h0JztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBwaW4gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHBpbiA9IHBpbi5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbiAocCkge1xuICAgICAgICAgIHJldHVybiBwLnRyaW0oKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKHBpbiA9PT0gdHJ1ZSkge1xuICAgICAgICBwaW4gPSBbJ3RvcCcsICdsZWZ0JywgJ3JpZ2h0JywgJ2JvdHRvbSddO1xuICAgICAgfVxuXG4gICAgICBwaW4gPSBwaW4gfHwgW107XG5cbiAgICAgIHZhciBwaW5uZWQgPSBbXTtcbiAgICAgIHZhciBvb2IgPSBbXTtcblxuICAgICAgaWYgKHRvcCA8IGJvdW5kc1sxXSkge1xuICAgICAgICBpZiAocGluLmluZGV4T2YoJ3RvcCcpID49IDApIHtcbiAgICAgICAgICB0b3AgPSBib3VuZHNbMV07XG4gICAgICAgICAgcGlubmVkLnB1c2goJ3RvcCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9vYi5wdXNoKCd0b3AnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAodG9wICsgaGVpZ2h0ID4gYm91bmRzWzNdKSB7XG4gICAgICAgIGlmIChwaW4uaW5kZXhPZignYm90dG9tJykgPj0gMCkge1xuICAgICAgICAgIHRvcCA9IGJvdW5kc1szXSAtIGhlaWdodDtcbiAgICAgICAgICBwaW5uZWQucHVzaCgnYm90dG9tJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb29iLnB1c2goJ2JvdHRvbScpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChsZWZ0IDwgYm91bmRzWzBdKSB7XG4gICAgICAgIGlmIChwaW4uaW5kZXhPZignbGVmdCcpID49IDApIHtcbiAgICAgICAgICBsZWZ0ID0gYm91bmRzWzBdO1xuICAgICAgICAgIHBpbm5lZC5wdXNoKCdsZWZ0Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb29iLnB1c2goJ2xlZnQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAobGVmdCArIHdpZHRoID4gYm91bmRzWzJdKSB7XG4gICAgICAgIGlmIChwaW4uaW5kZXhPZigncmlnaHQnKSA+PSAwKSB7XG4gICAgICAgICAgbGVmdCA9IGJvdW5kc1syXSAtIHdpZHRoO1xuICAgICAgICAgIHBpbm5lZC5wdXNoKCdyaWdodCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9vYi5wdXNoKCdyaWdodCcpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChwaW5uZWQubGVuZ3RoKSB7XG4gICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHBpbm5lZENsYXNzID0gdW5kZWZpbmVkO1xuICAgICAgICAgIGlmICh0eXBlb2YgX3RoaXMub3B0aW9ucy5waW5uZWRDbGFzcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHBpbm5lZENsYXNzID0gX3RoaXMub3B0aW9ucy5waW5uZWRDbGFzcztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGlubmVkQ2xhc3MgPSBfdGhpcy5nZXRDbGFzcygncGlubmVkJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYWRkQ2xhc3Nlcy5wdXNoKHBpbm5lZENsYXNzKTtcbiAgICAgICAgICBwaW5uZWQuZm9yRWFjaChmdW5jdGlvbiAoc2lkZSkge1xuICAgICAgICAgICAgYWRkQ2xhc3Nlcy5wdXNoKHBpbm5lZENsYXNzICsgJy0nICsgc2lkZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pKCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvb2IubGVuZ3RoKSB7XG4gICAgICAgIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIG9vYkNsYXNzID0gdW5kZWZpbmVkO1xuICAgICAgICAgIGlmICh0eXBlb2YgX3RoaXMub3B0aW9ucy5vdXRPZkJvdW5kc0NsYXNzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgb29iQ2xhc3MgPSBfdGhpcy5vcHRpb25zLm91dE9mQm91bmRzQ2xhc3M7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9vYkNsYXNzID0gX3RoaXMuZ2V0Q2xhc3MoJ291dC1vZi1ib3VuZHMnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhZGRDbGFzc2VzLnB1c2gob29iQ2xhc3MpO1xuICAgICAgICAgIG9vYi5mb3JFYWNoKGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgICAgICAgICBhZGRDbGFzc2VzLnB1c2gob29iQ2xhc3MgKyAnLScgKyBzaWRlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSkoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHBpbm5lZC5pbmRleE9mKCdsZWZ0JykgPj0gMCB8fCBwaW5uZWQuaW5kZXhPZigncmlnaHQnKSA+PSAwKSB7XG4gICAgICAgIGVBdHRhY2htZW50LmxlZnQgPSB0QXR0YWNobWVudC5sZWZ0ID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAocGlubmVkLmluZGV4T2YoJ3RvcCcpID49IDAgfHwgcGlubmVkLmluZGV4T2YoJ2JvdHRvbScpID49IDApIHtcbiAgICAgICAgZUF0dGFjaG1lbnQudG9wID0gdEF0dGFjaG1lbnQudG9wID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmICh0QXR0YWNobWVudC50b3AgIT09IHRhcmdldEF0dGFjaG1lbnQudG9wIHx8IHRBdHRhY2htZW50LmxlZnQgIT09IHRhcmdldEF0dGFjaG1lbnQubGVmdCB8fCBlQXR0YWNobWVudC50b3AgIT09IF90aGlzLmF0dGFjaG1lbnQudG9wIHx8IGVBdHRhY2htZW50LmxlZnQgIT09IF90aGlzLmF0dGFjaG1lbnQubGVmdCkge1xuICAgICAgICBfdGhpcy51cGRhdGVBdHRhY2hDbGFzc2VzKGVBdHRhY2htZW50LCB0QXR0YWNobWVudCk7XG4gICAgICAgIF90aGlzLnRyaWdnZXIoJ3VwZGF0ZScsIHtcbiAgICAgICAgICBhdHRhY2htZW50OiBlQXR0YWNobWVudCxcbiAgICAgICAgICB0YXJnZXRBdHRhY2htZW50OiB0QXR0YWNobWVudFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGRlZmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghKF90aGlzLm9wdGlvbnMuYWRkVGFyZ2V0Q2xhc3NlcyA9PT0gZmFsc2UpKSB7XG4gICAgICAgIHVwZGF0ZUNsYXNzZXMoX3RoaXMudGFyZ2V0LCBhZGRDbGFzc2VzLCBhbGxDbGFzc2VzKTtcbiAgICAgIH1cbiAgICAgIHVwZGF0ZUNsYXNzZXMoX3RoaXMuZWxlbWVudCwgYWRkQ2xhc3NlcywgYWxsQ2xhc3Nlcyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4geyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9O1xuICB9XG59KTtcbi8qIGdsb2JhbHMgVGV0aGVyQmFzZSAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfVGV0aGVyQmFzZSRVdGlscyA9IFRldGhlckJhc2UuVXRpbHM7XG52YXIgZ2V0Qm91bmRzID0gX1RldGhlckJhc2UkVXRpbHMuZ2V0Qm91bmRzO1xudmFyIHVwZGF0ZUNsYXNzZXMgPSBfVGV0aGVyQmFzZSRVdGlscy51cGRhdGVDbGFzc2VzO1xudmFyIGRlZmVyID0gX1RldGhlckJhc2UkVXRpbHMuZGVmZXI7XG5cblRldGhlckJhc2UubW9kdWxlcy5wdXNoKHtcbiAgcG9zaXRpb246IGZ1bmN0aW9uIHBvc2l0aW9uKF9yZWYpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdmFyIHRvcCA9IF9yZWYudG9wO1xuICAgIHZhciBsZWZ0ID0gX3JlZi5sZWZ0O1xuXG4gICAgdmFyIF9jYWNoZSA9IHRoaXMuY2FjaGUoJ2VsZW1lbnQtYm91bmRzJywgZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGdldEJvdW5kcyhfdGhpcy5lbGVtZW50KTtcbiAgICB9KTtcblxuICAgIHZhciBoZWlnaHQgPSBfY2FjaGUuaGVpZ2h0O1xuICAgIHZhciB3aWR0aCA9IF9jYWNoZS53aWR0aDtcblxuICAgIHZhciB0YXJnZXRQb3MgPSB0aGlzLmdldFRhcmdldEJvdW5kcygpO1xuXG4gICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDtcbiAgICB2YXIgcmlnaHQgPSBsZWZ0ICsgd2lkdGg7XG5cbiAgICB2YXIgYWJ1dHRlZCA9IFtdO1xuICAgIGlmICh0b3AgPD0gdGFyZ2V0UG9zLmJvdHRvbSAmJiBib3R0b20gPj0gdGFyZ2V0UG9zLnRvcCkge1xuICAgICAgWydsZWZ0JywgJ3JpZ2h0J10uZm9yRWFjaChmdW5jdGlvbiAoc2lkZSkge1xuICAgICAgICB2YXIgdGFyZ2V0UG9zU2lkZSA9IHRhcmdldFBvc1tzaWRlXTtcbiAgICAgICAgaWYgKHRhcmdldFBvc1NpZGUgPT09IGxlZnQgfHwgdGFyZ2V0UG9zU2lkZSA9PT0gcmlnaHQpIHtcbiAgICAgICAgICBhYnV0dGVkLnB1c2goc2lkZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChsZWZ0IDw9IHRhcmdldFBvcy5yaWdodCAmJiByaWdodCA+PSB0YXJnZXRQb3MubGVmdCkge1xuICAgICAgWyd0b3AnLCAnYm90dG9tJ10uZm9yRWFjaChmdW5jdGlvbiAoc2lkZSkge1xuICAgICAgICB2YXIgdGFyZ2V0UG9zU2lkZSA9IHRhcmdldFBvc1tzaWRlXTtcbiAgICAgICAgaWYgKHRhcmdldFBvc1NpZGUgPT09IHRvcCB8fCB0YXJnZXRQb3NTaWRlID09PSBib3R0b20pIHtcbiAgICAgICAgICBhYnV0dGVkLnB1c2goc2lkZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciBhbGxDbGFzc2VzID0gW107XG4gICAgdmFyIGFkZENsYXNzZXMgPSBbXTtcblxuICAgIHZhciBzaWRlcyA9IFsnbGVmdCcsICd0b3AnLCAncmlnaHQnLCAnYm90dG9tJ107XG4gICAgYWxsQ2xhc3Nlcy5wdXNoKHRoaXMuZ2V0Q2xhc3MoJ2FidXR0ZWQnKSk7XG4gICAgc2lkZXMuZm9yRWFjaChmdW5jdGlvbiAoc2lkZSkge1xuICAgICAgYWxsQ2xhc3Nlcy5wdXNoKF90aGlzLmdldENsYXNzKCdhYnV0dGVkJykgKyAnLScgKyBzaWRlKTtcbiAgICB9KTtcblxuICAgIGlmIChhYnV0dGVkLmxlbmd0aCkge1xuICAgICAgYWRkQ2xhc3Nlcy5wdXNoKHRoaXMuZ2V0Q2xhc3MoJ2FidXR0ZWQnKSk7XG4gICAgfVxuXG4gICAgYWJ1dHRlZC5mb3JFYWNoKGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgICBhZGRDbGFzc2VzLnB1c2goX3RoaXMuZ2V0Q2xhc3MoJ2FidXR0ZWQnKSArICctJyArIHNpZGUpO1xuICAgIH0pO1xuXG4gICAgZGVmZXIoZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCEoX3RoaXMub3B0aW9ucy5hZGRUYXJnZXRDbGFzc2VzID09PSBmYWxzZSkpIHtcbiAgICAgICAgdXBkYXRlQ2xhc3NlcyhfdGhpcy50YXJnZXQsIGFkZENsYXNzZXMsIGFsbENsYXNzZXMpO1xuICAgICAgfVxuICAgICAgdXBkYXRlQ2xhc3NlcyhfdGhpcy5lbGVtZW50LCBhZGRDbGFzc2VzLCBhbGxDbGFzc2VzKTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0cnVlO1xuICB9XG59KTtcbi8qIGdsb2JhbHMgVGV0aGVyQmFzZSAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfc2xpY2VkVG9BcnJheSA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIHNsaWNlSXRlcmF0b3IoYXJyLCBpKSB7IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX2UgPSB1bmRlZmluZWQ7IHRyeSB7IGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsgX2Fyci5wdXNoKF9zLnZhbHVlKTsgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrOyB9IH0gY2F0Y2ggKGVycikgeyBfZCA9IHRydWU7IF9lID0gZXJyOyB9IGZpbmFsbHkgeyB0cnkgeyBpZiAoIV9uICYmIF9pWydyZXR1cm4nXSkgX2lbJ3JldHVybiddKCk7IH0gZmluYWxseSB7IGlmIChfZCkgdGhyb3cgX2U7IH0gfSByZXR1cm4gX2FycjsgfSByZXR1cm4gZnVuY3Rpb24gKGFyciwgaSkgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IHJldHVybiBhcnI7IH0gZWxzZSBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSB7IHJldHVybiBzbGljZUl0ZXJhdG9yKGFyciwgaSk7IH0gZWxzZSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UnKTsgfSB9OyB9KSgpO1xuXG5UZXRoZXJCYXNlLm1vZHVsZXMucHVzaCh7XG4gIHBvc2l0aW9uOiBmdW5jdGlvbiBwb3NpdGlvbihfcmVmKSB7XG4gICAgdmFyIHRvcCA9IF9yZWYudG9wO1xuICAgIHZhciBsZWZ0ID0gX3JlZi5sZWZ0O1xuXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuc2hpZnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgc2hpZnQgPSB0aGlzLm9wdGlvbnMuc2hpZnQ7XG4gICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMuc2hpZnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHNoaWZ0ID0gdGhpcy5vcHRpb25zLnNoaWZ0LmNhbGwodGhpcywgeyB0b3A6IHRvcCwgbGVmdDogbGVmdCB9KTtcbiAgICB9XG5cbiAgICB2YXIgc2hpZnRUb3AgPSB1bmRlZmluZWQsXG4gICAgICAgIHNoaWZ0TGVmdCA9IHVuZGVmaW5lZDtcbiAgICBpZiAodHlwZW9mIHNoaWZ0ID09PSAnc3RyaW5nJykge1xuICAgICAgc2hpZnQgPSBzaGlmdC5zcGxpdCgnICcpO1xuICAgICAgc2hpZnRbMV0gPSBzaGlmdFsxXSB8fCBzaGlmdFswXTtcblxuICAgICAgdmFyIF9zaGlmdCA9IHNoaWZ0O1xuXG4gICAgICB2YXIgX3NoaWZ0MiA9IF9zbGljZWRUb0FycmF5KF9zaGlmdCwgMik7XG5cbiAgICAgIHNoaWZ0VG9wID0gX3NoaWZ0MlswXTtcbiAgICAgIHNoaWZ0TGVmdCA9IF9zaGlmdDJbMV07XG5cbiAgICAgIHNoaWZ0VG9wID0gcGFyc2VGbG9hdChzaGlmdFRvcCwgMTApO1xuICAgICAgc2hpZnRMZWZ0ID0gcGFyc2VGbG9hdChzaGlmdExlZnQsIDEwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hpZnRUb3AgPSBzaGlmdC50b3A7XG4gICAgICBzaGlmdExlZnQgPSBzaGlmdC5sZWZ0O1xuICAgIH1cblxuICAgIHRvcCArPSBzaGlmdFRvcDtcbiAgICBsZWZ0ICs9IHNoaWZ0TGVmdDtcblxuICAgIHJldHVybiB7IHRvcDogdG9wLCBsZWZ0OiBsZWZ0IH07XG4gIH1cbn0pO1xucmV0dXJuIFRldGhlcjtcblxufSkpO1xuIl19\n"],"sourceRoot":"/source/"}